Running quick scan configuration 3
Features: 256, Iterations: 4, Max Degree: 0
Running: co2_quick_f256_i4_d0
======================================================================
PhysNetJax Training - CO2 Data
======================================================================

ğŸ“ Data Files:
  Train: ../preclassified_data/energies_forces_dipoles_train.npz
  Valid: ../preclassified_data/energies_forces_dipoles_valid.npz
  Checkpoints: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/ckpts/co2_quick_f256_i4_d0

######################################################################
# Loading Data
######################################################################

Targets: ['energy', 'forces', 'dipole']

Energy preprocessing:
  Input unit: eV
  Subtracting atomic energies: default

Loading training data...
Loaded NPZ file: ../preclassified_data/energies_forces_dipoles_train.npz
  Structures: 8000
  Keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'metadata']

  Atomic energies computed from training data:
    H (Z=1): -13.6131 eV
    C (Z=6): -1029.8631 eV
    N (Z=7): -1485.3025 eV
    O (Z=8): -2042.6113 eV
    Z9 (Z=9): -2713.4849 eV

Loading validation data...
Loaded NPZ file: ../preclassified_data/energies_forces_dipoles_valid.npz
  Structures: 1000
  Keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'metadata']

ğŸ“ Resizing arrays from 60 to 3 atoms...
  R: (8000, 60, 3) â†’ (8000, 3, 3)
  F: (8000, 60, 3) â†’ (8000, 3, 3)
  Z: (8000, 60) â†’ (8000, 3)

ğŸ“ Resizing arrays from 60 to 3 atoms...
  R: (1000, 60, 3) â†’ (1000, 3, 3)
  F: (1000, 60, 3) â†’ (1000, 3, 3)
  Z: (1000, 60) â†’ (1000, 3)

âœ… Data loaded:
  Training samples: 8000
  Validation samples: 1000
  Data keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'D']
  Array shapes:
    R: (8000, 3, 3)
    Z: (8000, 3)
    E: (8000,)
    F: (8000, 3, 3)
    D: (8000, 3)
  Max atoms in data: 3

  Energy std: 1.7739 eV
  Force std: 8.3630 eV/Ã…

######################################################################
# Building Model
######################################################################

Model hyperparameters:
  Features: 256
  Max degree: 0
  Message passing iterations: 4
  Basis functions: 64
  Cutoff: 6.0 Ã…
  Residual blocks: 3
  Max atoms: 3
  ZBL repulsion: False
  Predict charges: False
  Use energy bias: False

âœ… Model created: PhysNetJax EF

######################################################################
# Training Setup
######################################################################

Training hyperparameters:
  Batch size: 16
  Max epochs: 100
  Learning rate: 0.001
  Optimizer: amsgrad
  Schedule: constant
  Transform: reduce_on_plateau
  Objective: valid_forces_mae
  Random seed: 42

Loss weights:
  Energy: 1.0
  Forces: 50.0
  Dipole: 25.0

Data keys: ['R', 'Z', 'F', 'E', 'N', 'D', 'dst_idx', 'src_idx', 'batch_segments']

======================================================================
STARTING TRAINING
======================================================================

                                   Train Data                                   
â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ R         â”ƒ Z         â”ƒ N       â”ƒ E       â”ƒ F         â”ƒ Dxyz      â”ƒ D        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ (8000, 3, â”‚ (8000, 3) â”‚ (8000,) â”‚ (8000,) â”‚ (8000, 3, â”‚ (8000, 3) â”‚ (8000,   â”‚
â”‚ 3)        â”‚           â”‚         â”‚         â”‚ 3)        â”‚           â”‚ 3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                Validation Data                                 
â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ R         â”ƒ Z         â”ƒ N       â”ƒ E       â”ƒ F         â”ƒ Dxyz      â”ƒ D        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ (1000, 3, â”‚ (1000, 3) â”‚ (1000,) â”‚ (1000,) â”‚ (1000, 3, â”‚ (1000, 3) â”‚ (1000,   â”‚
â”‚ 3)        â”‚           â”‚         â”‚         â”‚ 3)        â”‚           â”‚ 3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Using default (fat) batching method
Training Routine
                       .,,uod8B8bou,,.
              ..,uod8BBBBBBBBBBBBBBBBRPFT?l!i:.
         ,=m8BBBBBBBBBBBBBBBRPFT?!||||||||||||||
         !...:!TVBBBRPFT||||||||||!!^^""'   ||||
         !.......:!?|||||!!^^""'            ||||
         !.........||||                     ||||
         !.........||||  ##                 ||||
         !.........||||      PhysNet        ||||
         !.........||||      JAX            ||||
         !.........||||                     ||||
         !.........||||                     ||||
         `.........||||                    ,||||
          .;.......||||               _.-!!|||||
   .,uodWBBBBb.....||||       _.-!!|||||||||!:'
!YBBBBBBBBBBBBBBb..!|||:..-!!|||||||!iof68BBBBBb....
!..YBBBBBBBBBBBBBBb!!||||||||!iof68BBBBBBRPFT?!::   `.
!....YBBBBBBBBBBBBBBbaaitf68BBBBBBRPFT?!:::::::::     `.
!......YBBBBBBBBBBBBBBBBBBBRPFT?!::::::;:!^"`;:::       `.
!........YBBBBBBBBBBRPFT?!::::::::::^''...::::::;         iBBbo.
`..........YBRPFT?!::::::::::::::::::::::::;iof68bo.      WBBBBbo.
  `..........:::::::::::::::::::::::;iof688888888888b.     `YBBBP^'
    `........::::::::::::::::;iof688888888888888888888b.     `
      `......:::::::::;iof688888888888888888888888888888b.
        `....:::;iof688888888888888888888888888888888899fT!
          `..::!8888888888888888888888888888888899fT|!^"'
            `' !!988888888888888888888888899fT|!^"'
                `!!8888888888888888899fT|!^"'
                  `!988888888899fT|!^"'
                    `!9899fT|!^"'
                      `!^"'
DATA_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/data
LOGS_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/logs
ANALYSIS_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/analysis
MAIN_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax
PYCHARMM_DIR: None
Start Time:  11:15:17
                              Optimizer Arguments                               
â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ optiâ€¦ â”ƒ optiâ€¦ â”ƒ scheâ€¦ â”ƒ scheâ€¦ â”ƒ transâ€¦ â”ƒ reduâ€¦ â”ƒ clip_â€¦ â”ƒ b1  â”ƒ b2   â”ƒ eps   â”ƒ
â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ amsgâ€¦ â”‚ Gradâ€¦ â”‚ consâ€¦ â”‚ <funâ€¦ â”‚ reducâ€¦ â”‚ Gradâ€¦ â”‚ 10.0   â”‚ 0.9 â”‚ 0.99 â”‚ 0.001 â”‚
â”‚       â”‚ chaiâ€¦ â”‚       â”‚ consâ€¦ â”‚        â”‚ reduâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ at    â”‚       â”‚ at    â”‚        â”‚ at    â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ 0x14â€¦ â”‚       â”‚ 0x14â€¦ â”‚        â”‚ 0x14â€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ updaâ€¦ â”‚       â”‚       â”‚        â”‚ updaâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ chaiâ€¦ â”‚       â”‚       â”‚        â”‚ reduâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ at    â”‚       â”‚       â”‚        â”‚ at    â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ 0x14â€¦ â”‚       â”‚       â”‚        â”‚ 0x14â€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                              Training Parameters                               
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ energy_weiâ€¦ â”ƒ forces_weâ€¦ â”ƒ dipole_weiâ€¦ â”ƒ charges_wâ€¦ â”ƒ batch_size â”ƒ num_atoms â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ 1.0         â”‚ 50.0       â”‚ 25.0        â”‚ 0.0        â”‚ 16         â”‚ 3         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 Training Style                                 
â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ restart â”ƒ best â”ƒ data_keys                                â”ƒ objective        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ False   â”‚ True â”‚ ('R', 'Z', 'F', 'E', 'N', 'D',           â”‚ valid_forces_mae â”‚
â”‚         â”‚      â”‚ 'dst_idx', 'src_idx', 'batch_segments')  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              Validation Batch[0]                               
â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”“
â”ƒ R    â”ƒ Z    â”ƒ F    â”ƒ E    â”ƒ N    â”ƒ D    â”ƒ dstâ€¦ â”ƒ src_â€¦ â”ƒ batâ€¦ â”ƒ batcâ€¦ â”ƒ atoâ€¦ â”ƒ
â”¡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”©
â”‚ (48, â”‚ (48â€¦ â”‚ (48, â”‚ (16, â”‚ (16â€¦ â”‚ (16, â”‚ (96â€¦ â”‚ (96,) â”‚ (96â€¦ â”‚ (48,) â”‚ (48â€¦ â”‚
â”‚ 3)   â”‚      â”‚ 3)   â”‚ 1)   â”‚      â”‚ 3)   â”‚      â”‚       â”‚      â”‚       â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
Extra Validation Info:
Z: Array[1000, 3] i32 n=3000 (12Kb) xâˆˆ[6, 8] Î¼=7.333 Ïƒ=0.943 cpu:0
R: Array[1000, 3, 3] n=9000 (35Kb) xâˆˆ[-1.500, 1.500] Î¼=0.091 Ïƒ=0.586 cpu:0
E: Array[1000] 3.9Kb xâˆˆ[7.188, 16.129] Î¼=10.665 Ïƒ=1.777 cpu:0
N: Array[1000] i32 3.9Kb xâˆˆ[3, 3] Î¼=3.000 Ïƒ=0. cpu:0
F: Array[1000, 3, 3] n=9000 (35Kb) xâˆˆ[-38.830, 39.798] Î¼=5.298e-10 Ïƒ=8.276 cpu:0
                                                                                Model Attributes                                                                                 
â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ features â”ƒ max_degree â”ƒ num_iterations â”ƒ num_basis_functions â”ƒ cutoff â”ƒ max_atomic_number â”ƒ charges â”ƒ natoms â”ƒ total_charge â”ƒ n_res â”ƒ zbl   â”ƒ debug â”ƒ efa   â”ƒ use_energy_bias â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ 256      â”‚ 0          â”‚ 4              â”‚ 64                  â”‚ 6.0    â”‚ 118               â”‚ False   â”‚ 3      â”‚ 0.0          â”‚ 3     â”‚ False â”‚ False â”‚ False â”‚ False           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
