=== GPU Check ===
Sat Nov  1 13:28:07 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.82.07              Driver Version: 580.82.07      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA TITAN X (Pascal)        On  |   00000000:04:00.0 Off |                  N/A |
| 23%   23C    P8              8W /  250W |      10MiB /  12288MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A            5514      G   /usr/lib/xorg/Xorg                        6MiB |
+-----------------------------------------------------------------------------------------+
CUDA_VISIBLE_DEVICES: 0
=================
Running configuration 11
Configuration:
  Features: 128
  Iterations: 5
  Basis functions: 64
  Residual blocks: 3
  Batch size: 16
  Max degree: 1
Experiment: co2_scan_f128_i5_b64_r3_bs16_d1
Starting training...
======================================================================
PhysNetJax Training - CO2 Data
======================================================================

ğŸ“ Data Files:
  Train: ../preclassified_data/energies_forces_dipoles_train.npz
  Valid: ../preclassified_data/energies_forces_dipoles_valid.npz
  Checkpoints: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/ckpts/co2_scan_f128_i5_b64_r3_bs16_d1

######################################################################
# Loading Data
######################################################################

Targets: ['energy', 'forces', 'dipole']

Energy preprocessing:
  Input unit: eV
  Subtracting atomic energies: default

Loading training data...
Loaded NPZ file: ../preclassified_data/energies_forces_dipoles_train.npz
  Structures: 8000
  Keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'metadata']

  Atomic energies computed from training data:
    H (Z=1): -13.6131 eV
    C (Z=6): -1029.8631 eV
    N (Z=7): -1485.3025 eV
    O (Z=8): -2042.6113 eV
    Z9 (Z=9): -2713.4849 eV

Loading validation data...
Loaded NPZ file: ../preclassified_data/energies_forces_dipoles_valid.npz
  Structures: 1000
  Keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'metadata']

ğŸ“ Resizing arrays from 60 to 3 atoms...
  R: (8000, 60, 3) â†’ (8000, 3, 3)
  F: (8000, 60, 3) â†’ (8000, 3, 3)
  Z: (8000, 60) â†’ (8000, 3)

ğŸ“ Resizing arrays from 60 to 3 atoms...
  R: (1000, 60, 3) â†’ (1000, 3, 3)
  F: (1000, 60, 3) â†’ (1000, 3, 3)
  Z: (1000, 60) â†’ (1000, 3)

âœ… Data loaded:
  Training samples: 8000
  Validation samples: 1000
  Data keys: ['R', 'Z', 'N', 'E', 'F', 'Dxyz', 'D']
  Array shapes:
    R: (8000, 3, 3)
    Z: (8000, 3)
    E: (8000,)
    F: (8000, 3, 3)
    D: (8000, 3)
  Max atoms in data: 3

  Energy std: 1.7739 eV
  Force std: 8.3630 eV/Ã…

######################################################################
# Building Model
######################################################################

Model hyperparameters:
  Features: 128
  Max degree: 1
  Message passing iterations: 5
  Basis functions: 64
  Cutoff: 6.0 Ã…
  Residual blocks: 3
  Max atoms: 3
  ZBL repulsion: False
  Predict charges: False
  Use energy bias: False

âœ… Model created: PhysNetJax EF

######################################################################
# Training Setup
######################################################################

Training hyperparameters:
  Batch size: 16
  Max epochs: 500
  Learning rate: 0.005
  Optimizer: amsgrad
  Schedule: constant
  Transform: reduce_on_plateau
  Objective: valid_forces_mae
  Random seed: 42

Loss weights:
  Energy: 1.0
  Forces: 50.0
  Dipole: 25.0

Data keys: ['R', 'Z', 'F', 'E', 'N', 'D', 'dst_idx', 'src_idx', 'batch_segments']

======================================================================
STARTING TRAINING
======================================================================

                                   Train Data                                   
â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ R         â”ƒ Z         â”ƒ N       â”ƒ E       â”ƒ F         â”ƒ Dxyz      â”ƒ D        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ (8000, 3, â”‚ (8000, 3) â”‚ (8000,) â”‚ (8000,) â”‚ (8000, 3, â”‚ (8000, 3) â”‚ (8000,   â”‚
â”‚ 3)        â”‚           â”‚         â”‚         â”‚ 3)        â”‚           â”‚ 3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                Validation Data                                 
â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ R         â”ƒ Z         â”ƒ N       â”ƒ E       â”ƒ F         â”ƒ Dxyz      â”ƒ D        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ (1000, 3, â”‚ (1000, 3) â”‚ (1000,) â”‚ (1000,) â”‚ (1000, 3, â”‚ (1000, 3) â”‚ (1000,   â”‚
â”‚ 3)        â”‚           â”‚         â”‚         â”‚ 3)        â”‚           â”‚ 3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Using default (fat) batching method
Training Routine
                       .,,uod8B8bou,,.
              ..,uod8BBBBBBBBBBBBBBBBRPFT?l!i:.
         ,=m8BBBBBBBBBBBBBBBRPFT?!||||||||||||||
         ![33m...[0m:!TVBBBRPFT||||||||||!!^^[32m""[0m'   ||||
         ![33m...[0m[33m...[0m.:!?|||||!!^^[32m""[0m'            ||||
         ![33m...[0m[33m...[0m[33m...[0m||||                     ||||
         ![33m...[0m[33m...[0m[33m...[0m||||  ##                 ||||
         ![33m...[0m[33m...[0m[33m...[0m||||      PhysNet        ||||
         ![33m...[0m[33m...[0m[33m...[0m||||      JAX            ||||
         ![33m...[0m[33m...[0m[33m...[0m||||                     ||||
         ![33m...[0m[33m...[0m[33m...[0m||||                     ||||
         `[33m...[0m[33m...[0m[33m...[0m||||                    ,||||
          .;[33m...[0m[33m...[0m.||||               _.-!!|||||
   .,uodWBBBBb[33m...[0m..||||       _.-!!|||||||||!:'
!YBBBBBBBBBBBBBBb..!|||:..-!!|||||||!iof68BBBBBb[33m...[0m.
!..YBBBBBBBBBBBBBBb!!||||||||!iof68BBBBBBRPFT?!::   `.
![33m...[0m.YBBBBBBBBBBBBBBbaaitf68BBBBBBRPFT?!:::::::::     `.
![33m...[0m[33m...[0mYBBBBBBBBBBBBBBBBBBBRPFT?!::::::;:!^"`;:::       `.
![33m...[0m[33m...[0m..YBBBBBBBBBBRPFT?!::::::::::^[32m''[0m[33m...[0m::::::;         iBBbo.
`[33m...[0m[33m...[0m[33m...[0m.YBRPFT?!::::::::::::::::::::::::;iof68bo.      WBBBBbo.
  `[33m...[0m[33m...[0m[33m...[0m.:::::::::::::::::::::::;iof688888888888b.     `YBBBP^'
    `[33m...[0m[33m...[0m..::::::::::::::::;iof688888888888888888888b.     `
      `[33m...[0m[33m...[0m:::::::::;iof688888888888888888888888888888b.
        `[33m...[0m.:::;iof688888888888888888888888888888888899fT!
          `..::!8888888888888888888888888888888899fT|!^"'
            `[32m' !!988888888888888888888888899fT|!^"'[0m
                `!!8888888888888888899fT|!^"'
                  `!988888888899fT|!^"'
                    `!9899fT|!^"'
                      `!^"'
DATA_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/data
LOGS_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/logs
ANALYSIS_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax/analysis
MAIN_PATH: /scicore/home/meuwly/boitti0000/mmml/mmml/physnetjax
PYCHARMM_DIR: None
Start Time:  [1;92m12:28:45[0m
                              Optimizer Arguments                               
â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ optiâ€¦ â”ƒ optiâ€¦ â”ƒ scheâ€¦ â”ƒ scheâ€¦ â”ƒ transâ€¦ â”ƒ reduâ€¦ â”ƒ clip_â€¦ â”ƒ b1  â”ƒ b2   â”ƒ eps   â”ƒ
â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ amsgâ€¦ â”‚ Gradâ€¦ â”‚ consâ€¦ â”‚ <funâ€¦ â”‚ reducâ€¦ â”‚ Gradâ€¦ â”‚ 10.0   â”‚ 0.9 â”‚ 0.99 â”‚ 0.001 â”‚
â”‚       â”‚ chaiâ€¦ â”‚       â”‚ consâ€¦ â”‚        â”‚ reduâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ at    â”‚       â”‚ at    â”‚        â”‚ at    â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ 0x15â€¦ â”‚       â”‚ 0x15â€¦ â”‚        â”‚ 0x15â€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ updaâ€¦ â”‚       â”‚       â”‚        â”‚ updaâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ chaiâ€¦ â”‚       â”‚       â”‚        â”‚ reduâ€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ at    â”‚       â”‚       â”‚        â”‚ at    â”‚        â”‚     â”‚      â”‚       â”‚
â”‚       â”‚ 0x15â€¦ â”‚       â”‚       â”‚        â”‚ 0x15â€¦ â”‚        â”‚     â”‚      â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                              Training Parameters                               
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ energy_weiâ€¦ â”ƒ forces_weâ€¦ â”ƒ dipole_weiâ€¦ â”ƒ charges_wâ€¦ â”ƒ batch_size â”ƒ num_atoms â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ 1.0         â”‚ 50.0       â”‚ 25.0        â”‚ 0.0        â”‚ 16         â”‚ 3         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 Training Style                                 
â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ restart â”ƒ best â”ƒ data_keys                                â”ƒ objective        â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ False   â”‚ True â”‚ ('R', 'Z', 'F', 'E', 'N', 'D',           â”‚ valid_forces_mae â”‚
â”‚         â”‚      â”‚ 'dst_idx', 'src_idx', 'batch_segments')  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              Validation Batch[0]                               
â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”“
â”ƒ R    â”ƒ Z    â”ƒ F    â”ƒ E    â”ƒ N    â”ƒ D    â”ƒ dstâ€¦ â”ƒ src_â€¦ â”ƒ batâ€¦ â”ƒ batcâ€¦ â”ƒ atoâ€¦ â”ƒ
â”¡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”©
â”‚ (48, â”‚ (48â€¦ â”‚ (48, â”‚ (16, â”‚ (16â€¦ â”‚ (16, â”‚ (96â€¦ â”‚ (96,) â”‚ (96â€¦ â”‚ (48,) â”‚ (48â€¦ â”‚
â”‚ 3)   â”‚      â”‚ 3)   â”‚ 1)   â”‚      â”‚ 3)   â”‚      â”‚       â”‚      â”‚       â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
Extra Validation Info:
Z: Array[1000, 3] i32 n=3000 (12Kb) xâˆˆ[6, 8] Î¼=7.333 Ïƒ=0.943 cpu:0
R: Array[1000, 3, 3] n=9000 (35Kb) xâˆˆ[-1.500, 1.500] Î¼=0.091 Ïƒ=0.586 cpu:0
E: Array[1000] 3.9Kb xâˆˆ[7.188, 16.129] Î¼=10.665 Ïƒ=1.777 cpu:0
N: Array[1000] i32 3.9Kb xâˆˆ[3, 3] Î¼=3.000 Ïƒ=0. cpu:0
F: Array[1000, 3, 3] n=9000 (35Kb) xâˆˆ[-38.830, 39.798] Î¼=5.298e-10 Ïƒ=8.276 cpu:0


âŒ Training failed with error:
  INTERNAL: the function failed to launch on the GPU
Training complete for co2_scan_f128_i5_b64_r3_bs16_d1
