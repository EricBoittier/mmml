==========================================
GPU Test Script
==========================================
Date: Wed Nov  5 11:56:09 CET 2025
Hostname: sgd03
Job ID: 60808588

no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/condabin/conda
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/bin/conda
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/bin/conda-env
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/bin/activate
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/bin/deactivate
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/etc/profile.d/conda.sh
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/etc/fish/conf.d/conda.fish
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/shell/condabin/Conda.psm1
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/shell/condabin/conda-hook.ps1
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/lib/python3.12/site-packages/xontrib/conda.xsh
no change     /scicore/soft/easybuild/apps/Miniconda3/24.7.1-0/etc/profile.d/conda.csh
no change     /scicore/home/meuwly/boitti0000/.bashrc
No action taken.
60808588
======================================================================
HEAD-TO-HEAD MODEL COMPARISON
======================================================================

Comparison: dcm1test60808588
Output directory: comparisons/dcm1test60808588

######################################################################
# Loading Data
######################################################################

  Loading EFD: energies_forces_dipoles_train.npz
  Loading ESP: grids_esp_train.npz
  âœ… Subtracted atomic energies (now relative to isolated atoms)
  Aligning ESP grids to molecular reference frames...
  âœ… Aligned ESP grids to molecular reference frames
     Sample 0 - Atom COM: [0.         0.14525378 0.11470596]
     Sample 0 - Grid COM before: [3.25342429 3.24367862 3.3973045 ]
     Sample 0 - Grid COM after: [2.56091444e-16 1.45253775e-01 1.14705956e-01]
     Sample 0 - Offset corrected: [3.25342429 3.09842484 3.28259855] Ã…
  Combined data shapes:
    R: (8000, 60, 3)
    Z: (8000, 60)
    N: (8000,)
    E: (8000,)
    F: (8000, 60, 3)
    Dxyz: (8000, 3)
    esp: (8000, 3000)
    vdw_surface: (8000, 3000, 3)
  Data padding: 60 atoms
  Max actual atoms: 3
  Loading EFD: energies_forces_dipoles_valid.npz
  Loading ESP: grids_esp_valid.npz
  âœ… Subtracted atomic energies (now relative to isolated atoms)
  Aligning ESP grids to molecular reference frames...
  âœ… Aligned ESP grids to molecular reference frames
     Sample 0 - Atom COM: [0.         0.25326187 0.02194556]
     Sample 0 - Grid COM before: [3.22872937 3.4025402  3.33670261]
     Sample 0 - Grid COM after: [2.56683563e-15 2.53261870e-01 2.19455598e-02]
     Sample 0 - Offset corrected: [3.22872937 3.14927833 3.31475705] Ã…
  Combined data shapes:
    R: (1000, 60, 3)
    Z: (1000, 60)
    N: (1000,)
    E: (1000,)
    F: (1000, 60, 3)
    Dxyz: (1000, 3)
    esp: (1000, 3000)
    vdw_surface: (1000, 3000, 3)
  Data padding: 60 atoms
  Max actual atoms: 3

âœ… Data loaded:
  Training samples: 8000
  Validation samples: 1000

######################################################################
# DCMNet (Equivariant) Model
######################################################################

ğŸ‹ï¸  Training DCMNet...

Pre-computing edge lists...
  Pre-computing edge lists (cutoff=10.0 Ã…)...
    Processed 1000/8000 samples...
    Processed 2000/8000 samples...
    Processed 3000/8000 samples...
    Processed 4000/8000 samples...
    Processed 5000/8000 samples...
    Processed 6000/8000 samples...
    Processed 7000/8000 samples...
    Processed 8000/8000 samples...
  âœ… Pre-computed edge lists: avg 6.0 edges/sample
  Pre-computing edge lists (cutoff=10.0 Ã…)...
    Processed 1000/1000 samples...
  âœ… Pre-computed edge lists: avg 6.0 edges/sample

Initializing model parameters...
âœ… Model initialized with 322,420 parameters

Training samples: 8000
Validation samples: 1000
Batch size: 100

Dipole loss terms:
  - physnet: source=physnet, metric=l2, weight=25.0
ESP loss terms:
  - dcmnet: source=dcmnet, metric=l2, weight=10000.0

ğŸ“Š Using EMA with decay=0.999 for validation
  ğŸ’¾ Saved best model (valid_loss: 599.058160)
  ğŸ’¾ Saved best model (valid_loss: 597.396930)
  ğŸ’¾ Saved best model (valid_loss: 594.739319)
  ğŸ’¾ Saved best model (valid_loss: 590.730670)

Epoch 5/10 (4.5s)
  Train Loss: 11.017750
    Energy: 0.181209
    Forces: 0.133473
    Dipole: 1.738449
    ESP: 0.462609
    Monopole: 0.003109
    Total Charge: 0.000201
  Valid Loss: 584.979669
    MAE Energy: 9.823167 eV  (226.527135 kcal/mol) [Î¼=8.834, Ïƒ=1.777 eV]
    MAE Forces: 0.237860 eV/Ã…  (5.485167 kcal/mol/Ã…) [Î¼=-0.000, Ïƒ=8.427 eV/Ã…]
    MAE Dipole (PhysNet): 0.255507 eÂ·Ã…  (1.227255 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    MAE Dipole (DCMNet): 0.250437 eÂ·Ã…  (1.202904 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    RMSE ESP (PhysNet): 0.017528 Ha/e  (10.999115 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    RMSE ESP (DCMNet): 0.015273 Ha/e  (9.583896 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    Total Charge Violation: 0.000063
  ğŸ’¾ Saved best model (valid_loss: 584.979669)
  ğŸ’¾ Saved best model (valid_loss: 577.186652)
  ğŸ’¾ Saved best model (valid_loss: 566.986841)
  ğŸ’¾ Saved best model (valid_loss: 554.206384)
  ğŸ’¾ Saved best model (valid_loss: 538.724829)

Epoch 10/10 (4.5s)
  Train Loss: 6.432939
    Energy: 0.112939
    Forces: 0.058352
    Dipole: 1.686207
    ESP: 0.392057
    Monopole: 0.002890
    Total Charge: 0.000187
  Valid Loss: 520.607120
    MAE Energy: 9.261696 eV  (213.579344 kcal/mol) [Î¼=8.834, Ïƒ=1.777 eV]
    MAE Forces: 0.223222 eV/Ã…  (5.147611 kcal/mol/Ã…) [Î¼=-0.000, Ïƒ=8.427 eV/Ã…]
    MAE Dipole (PhysNet): 0.254102 eÂ·Ã…  (1.220505 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    MAE Dipole (DCMNet): 0.236283 eÂ·Ã…  (1.134917 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    RMSE ESP (PhysNet): 0.018051 Ha/e  (11.327192 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    RMSE ESP (DCMNet): 0.013750 Ha/e  (8.628401 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    Total Charge Violation: 0.000135
  ğŸ’¾ Saved best model (valid_loss: 520.607120)

ğŸ’¾ Saved training history to: comparisons/dcm1test60808588/dcmnet_equivariant/history.json

âœ… DCMNet training completed in 0.05 hours

######################################################################
# Non-Equivariant Model
######################################################################

ğŸ‹ï¸  Training Non-Equivariant model...

Pre-computing edge lists...
  Pre-computing edge lists (cutoff=10.0 Ã…)...
    Processed 1000/8000 samples...
    Processed 2000/8000 samples...
    Processed 3000/8000 samples...
    Processed 4000/8000 samples...
    Processed 5000/8000 samples...
    Processed 6000/8000 samples...
    Processed 7000/8000 samples...
    Processed 8000/8000 samples...
  âœ… Pre-computed edge lists: avg 6.0 edges/sample
  Pre-computing edge lists (cutoff=10.0 Ã…)...
    Processed 1000/1000 samples...
  âœ… Pre-computed edge lists: avg 6.0 edges/sample

Initializing model parameters...
âœ… Model initialized with 120,922 parameters

Training samples: 8000
Validation samples: 1000
Batch size: 100

Dipole loss terms:
  - physnet: source=physnet, metric=l2, weight=25.0
ESP loss terms:
  - dcmnet: source=dcmnet, metric=l2, weight=10000.0

ğŸ“Š Using EMA with decay=0.999 for validation
  ğŸ’¾ Saved best model (valid_loss: 600.644116)
  ğŸ’¾ Saved best model (valid_loss: 598.896747)
  ğŸ’¾ Saved best model (valid_loss: 596.122894)
  ğŸ’¾ Saved best model (valid_loss: 591.996423)

Epoch 5/10 (3.6s)
  Train Loss: 11.698074
    Energy: 0.168592
    Forces: 0.144649
    Dipole: 1.707485
    ESP: 0.709990
    Monopole: 0.003271
    Total Charge: 0.000351
  Valid Loss: 586.164001
    MAE Energy: 9.824914 eV  (226.567429 kcal/mol) [Î¼=8.834, Ïƒ=1.777 eV]
    MAE Forces: 0.237841 eV/Ã…  (5.484730 kcal/mol/Ã…) [Î¼=-0.000, Ïƒ=8.427 eV/Ã…]
    MAE Dipole (PhysNet): 0.255505 eÂ·Ã…  (1.227244 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    MAE Dipole (DCMNet): 0.243717 eÂ·Ã…  (1.170625 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    RMSE ESP (PhysNet): 0.017373 Ha/e  (10.901466 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    RMSE ESP (DCMNet): 0.018402 Ha/e  (11.547352 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    Total Charge Violation: 0.000052
  ğŸ’¾ Saved best model (valid_loss: 586.164001)
  ğŸ’¾ Saved best model (valid_loss: 578.242743)
  ğŸ’¾ Saved best model (valid_loss: 567.952350)
  ğŸ’¾ Saved best model (valid_loss: 555.206970)
  ğŸ’¾ Saved best model (valid_loss: 539.811627)

Epoch 10/10 (3.7s)
  Train Loss: 6.581823
    Energy: 0.103807
    Forces: 0.057289
    Dipole: 1.632493
    ESP: 0.698540
    Monopole: 0.003073
    Total Charge: 0.000410
  Valid Loss: 521.899951
    MAE Energy: 9.267625 eV  (213.716072 kcal/mol) [Î¼=8.834, Ïƒ=1.777 eV]
    MAE Forces: 0.223210 eV/Ã…  (5.147343 kcal/mol/Ã…) [Î¼=-0.000, Ïƒ=8.427 eV/Ã…]
    MAE Dipole (PhysNet): 0.253888 eÂ·Ã…  (1.219480 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    MAE Dipole (DCMNet): 0.229823 eÂ·Ã…  (1.103890 D) [Î¼=-0.163, Ïƒ=0.343 eÂ·Ã…]
    RMSE ESP (PhysNet): 0.017650 Ha/e  (11.075695 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    RMSE ESP (DCMNet): 0.015511 Ha/e  (9.733565 (kcal/mol)/e) [Î¼=0.002800, Ïƒ=0.016157 Ha/e]
    Total Charge Violation: 0.000104
  ğŸ’¾ Saved best model (valid_loss: 521.899951)

ğŸ’¾ Saved training history to: comparisons/dcm1test60808588/noneq_model/history.json

âœ… Non-Equivariant training completed in 0.02 hours

######################################################################
# Equivariance Testing
######################################################################

--- DCMNet (Equivariant) ---

======================================================================
Testing Equivariance on 20 samples
======================================================================

Rotation Equivariance:
  Dipole error: 0.000006 Â± 0.000013 eÂ·Ã…
  ESP error:    0.000001 Â± 0.000002 Ha/e

Translation Invariance:
  Dipole error: 0.000000 Â± 0.000000 eÂ·Ã…
  ESP error:    0.000000 Â± 0.000000 Ha/e

--- Non-Equivariant ---

======================================================================
Testing Equivariance on 20 samples
======================================================================

Rotation Equivariance:
  Dipole error: 0.006790 Â± 0.002166 eÂ·Ã…
  ESP error:    0.000506 Â± 0.000154 Ha/e

Translation Invariance:
  Dipole error: 0.000000 Â± 0.000001 eÂ·Ã…
  ESP error:    0.000000 Â± 0.000000 Ha/e

######################################################################
# Performance Benchmarking
######################################################################

Measuring inference times...
  DCMNet:        1474.20 ms/sample
  Non-Eq:        785.13 ms/sample
  Speedup:       1.88Ã—

Parameter counts:
  DCMNet:        322,420 parameters
  Non-Eq:        120,922 parameters
  Reduction:     62.5%

######################################################################
# Final Comparison Report
######################################################################

VALIDATION PERFORMANCE:
  Energy MAE:  DCMNet=9.2617, Non-Eq=9.2676
  Forces MAE:  DCMNet=0.2232, Non-Eq=0.2232
  Dipole MAE:  DCMNet=0.2541, Non-Eq=0.2539
  ESP MAE:     DCMNet=0.0138, Non-Eq=0.0155

EQUIVARIANCE (Rotation):
  Dipole:      DCMNet=0.000006, Non-Eq=0.006790
  ESP:         DCMNet=0.000001, Non-Eq=0.000506
  âš ï¸  DCMNet should have near-zero rotation error (equivariant)
  âš ï¸  Non-Eq will have larger error (not equivariant)

INVARIANCE (Translation):
  Dipole:      DCMNet=0.000000, Non-Eq=0.000000
  ESP:         DCMNet=0.000000, Non-Eq=0.000000
  âœ… Both should have near-zero translation error

COMPUTATIONAL EFFICIENCY:
  Training:    DCMNet=0.05h, Non-Eq=0.02h (2.73Ã— speedup)
  Inference:   DCMNet=1474.20ms, Non-Eq=785.13ms (1.88Ã— speedup)
  Parameters:  DCMNet=322,420, Non-Eq=120,922 (62.5% reduction)

âœ… Results saved to: comparisons/dcm1test60808588/comparison_results.json

######################################################################
# Generating Comparison Plots
######################################################################

  âœ… Saved: comparisons/dcm1test60808588/performance_comparison.png
  âœ… Saved: comparisons/dcm1test60808588/efficiency_comparison.png
  âœ… Saved: comparisons/dcm1test60808588/equivariance_comparison.png

======================================================================
âœ… COMPARISON COMPLETE!
======================================================================

All results saved to: comparisons/dcm1test60808588

Generated files:
  - comparison_results.json
  - performance_comparison.png
  - efficiency_comparison.png
  - equivariance_comparison.png
  - dcmnet_equivariant/ (checkpoint)
  - noneq_model/ (checkpoint)
