═══════════════════════════════════════════════════════════════
  CUDA 13 Environment - Quick Start Guide
═══════════════════════════════════════════════════════════════

🎯 GOAL: Create a fresh environment with JAX + CUDA for GPU training

📋 PREREQUISITES: None! Script handles everything.

═══════════════════════════════════════════════════════════════
  3-STEP SETUP
═══════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────┐
│ STEP 1: Create Environment (5-10 minutes)                   │
└─────────────────────────────────────────────────────────────┘

  $ cd ~/mmml/examples/co2/physnet_train
  $ bash setup_cuda13_env.sh

  This creates: ~/mmml/.venv_cuda13
  With: JAX (CUDA), numpy, scipy, optax, flax, ase, mmml

┌─────────────────────────────────────────────────────────────┐
│ STEP 2: Test GPU (5 minutes)                                │
└─────────────────────────────────────────────────────────────┘

  $ cd ~/mmml/examples/co2/physnet_train
  $ sbatch test_gpu_cuda13.sh
  
  Wait for job, then:
  $ cat logs/test_gpu_cuda13_*.out
  
  ✅ Should see: "ALL TESTS PASSED"

┌─────────────────────────────────────────────────────────────┐
│ STEP 3: Run Training                                         │
└─────────────────────────────────────────────────────────────┘

  $ sbatch slurm_cuda13_quick_scan.sh      # 6 jobs
  $ sbatch slurm_cuda13_full_scan.sh       # 24 jobs

═══════════════════════════════════════════════════════════════
  VERIFY IT'S WORKING
═══════════════════════════════════════════════════════════════

Check training log:

  $ cat logs/cuda13_quick_*_0.out | grep "JAX devices"

✅ GOOD: JAX devices: [CudaDevice(id=0)]
❌ BAD:  JAX devices: [CpuDevice(id=0)]

Check speed:

  $ grep "Epoch" logs/cuda13_quick_*_0.out | head -5

✅ GOOD: Epoch times 1-5 seconds
❌ BAD:  Epoch times 30+ seconds (means CPU)

═══════════════════════════════════════════════════════════════
  COMMON COMMANDS
═══════════════════════════════════════════════════════════════

Activate environment (interactive):
  $ source ~/mmml/activate_cuda13.sh

Check job status:
  $ squeue -u $USER

View live training:
  $ tail -f logs/cuda13_quick_JOBID_0.out

List environment packages:
  $ source ~/mmml/.venv_cuda13/bin/activate
  $ pip list | grep jax

Cancel jobs:
  $ scancel JOBID

═══════════════════════════════════════════════════════════════
  FILES CREATED
═══════════════════════════════════════════════════════════════

Setup:
  setup_cuda13_env.sh           Create the environment
  ~/mmml/activate_cuda13.sh     Quick activation script

Testing:
  test_gpu_cuda13.sh            Test GPU access

Training:
  slurm_cuda13_quick_scan.sh    Quick scan (6 jobs)
  slurm_cuda13_full_scan.sh     Full scan (24 jobs)

Docs:
  CUDA13_SETUP.md               Full guide
  CUDA13_QUICK_START.txt        This file
  CUDA_TROUBLESHOOTING.md       If problems occur

═══════════════════════════════════════════════════════════════
  TROUBLESHOOTING
═══════════════════════════════════════════════════════════════

Test fails?
  → Check nvidia-smi output in log
  → If GPU missing: contact admin
  → If JAX CPU only: rerun setup_cuda13_env.sh

Training slow?
  → Check "JAX devices" in log
  → Should be CudaDevice, not CpuDevice
  → If CPU: environment issue, rerun setup

Module errors?
  → Check "module avail CUDA"
  → Script tries: 13.0 → 12.6 → 12.3 → 12.2.0
  → Edit scripts if you need different version

═══════════════════════════════════════════════════════════════
  PERFORMANCE EXPECTATIONS (with GPU)
═══════════════════════════════════════════════════════════════

Small models (32-64 features):   1-2 sec/epoch
Medium models (128 features):    2-3 sec/epoch  
Large models (256-512 features): 3-5 sec/epoch

If you see 30+ sec/epoch → Running on CPU (broken!)

═══════════════════════════════════════════════════════════════
  FULL DOCUMENTATION
═══════════════════════════════════════════════════════════════

  CUDA13_SETUP.md              Complete setup guide
  CUDA_TROUBLESHOOTING.md      Detailed troubleshooting
  GPU_ERROR_SUMMARY.md         What went wrong & why

═══════════════════════════════════════════════════════════════
  ONE-LINER
═══════════════════════════════════════════════════════════════

  bash setup_cuda13_env.sh && sbatch test_gpu_cuda13.sh

═══════════════════════════════════════════════════════════════

