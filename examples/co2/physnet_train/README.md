# Training Data (Unit-Corrected)

This directory contains molecular data with **corrected units** ready for DCMnet/PhysnetJax training.

## Data Corrections Applied

### 1. Atomic Coordinates (R)
- **Original**: Angstroms (verified)
- **Status**: ✓ Correct
- **Units**: Angstrom (ASE standard)

### 2. Energies (E)
- **Original**: Hartree
- **Converted**: eV (ASE standard)
- **Factor**: ×27.211386

### 3. Forces (F)
- **Original**: Hartree/Bohr
- **Converted**: eV/Angstrom (ASE standard)
- **Factor**: ×51.42208

### 4. ESP Grid Coordinates (vdw_surface)
- **Original**: Grid index space
- **Fixed**: Physical Angstroms
- **Conversion**: Applied proper grid spacing (0.25 Bohr = 0.132294 Å)

## Data Splits

- **Train**: 8000 samples (80%)
- **Valid**: 1000 samples (10%)
- **Test**: 1000 samples (10%)
- **Seed**: 42 (reproducible)

## Files

### Energy, Forces, and Dipoles
- `energies_forces_dipoles_train.npz`
- `energies_forces_dipoles_valid.npz`
- `energies_forces_dipoles_test.npz`

Each contains:
- `R`: Atomic coordinates [Angstrom]
- `Z`: Atomic numbers [int]
- `N`: Number of atoms [int]
- `E`: Energies [eV] ← CONVERTED from Hartree
- `F`: Forces [eV/Angstrom] ← CONVERTED from Hartree/Bohr
- `Dxyz`: Dipole moments [Debye]

### ESP Grids
- `grids_esp_train.npz`
- `grids_esp_valid.npz`
- `grids_esp_test.npz`

Each contains:
- `R`: Atomic coordinates [Angstrom]
- `Z`: Atomic numbers [int]
- `N`: Number of atoms [int]
- `esp`: ESP values [Hartree/e]
- `vdw_surface`: Grid coordinates [Angstrom] ← FIXED
- `vdw_grid`: Same as vdw_surface (backward compatibility)
- `grid_dims`: Original cube dimensions
- `grid_origin`: Original cube origins [Bohr]
- `grid_axes`: Original cube axes
- `Dxyz`: Dipole moments [Debye]

## Units Summary (ASE Standard)

| Property | Unit | Status |
|----------|------|--------|
| R (coordinates) | Angstrom | ✓ Correct |
| E (energy) | eV | ✓ Converted |
| F (forces) | eV/Angstrom | ✓ Converted |
| Dxyz (dipoles) | Debye | ✓ Correct |
| esp (values) | Hartree/e | ✓ Correct |
| vdw_surface | Angstrom | ✓ Fixed |

## Usage with DCMnet

```python
import numpy as np

# Load training data
train_props = np.load('energies_forces_dipoles_train.npz')
train_grids = np.load('grids_esp_train.npz')

# All units are ASE-standard - ready to use!
R = train_props['R']  # Angstroms
E = train_props['E']  # eV
F = train_props['F']  # eV/Angstrom
Dxyz = train_props['Dxyz']  # Debye
esp = train_grids['esp']  # Hartree/e
vdw_surface = train_grids['vdw_surface']  # Angstroms
```

Generated by: fix_and_split_cli.py
