JAX devices: [CudaDevice(id=0)]
JAX backend: gpu
JAX devices: [CudaDevice(id=0)]
/pchem-data/meuwly/boittier/home/mmml/mmml/data/top_all36_cgenff.rtf
/pchem-data/meuwly/boittier/home/mmml/mmml/data/par_all36_cgenff.prm
CHARMM_HOME /pchem-data/meuwly/boittier/home/mmml/setup/charmm
CHARMM_LIB_DIR /pchem-data/meuwly/boittier/home/mmml/setup/charmm
/pchem-data/meuwly/boittier/home/mmml/setup/charmm
/pchem-data/meuwly/boittier/home/mmml/setup/charmm
['O', 'H', 'H']
['O', 'H', 'H']
[8, 1, 1]
['C', 'H', 'H', 'O', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'H']
['C', 'H', 'H', 'O', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'C', 'H', 'H', 'H']
[6, 1, 1, 8, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 1]
CHARMM_HOME:  /pchem-data/meuwly/boittier/home/mmml/setup/charmm
CHARMM_LIB_DIR:  /pchem-data/meuwly/boittier/home/mmml/setup/charmm
Mock args created:
  n_monomers: 2
  n_atoms_monomer: 10
  ml_cutoff: 1.0
  mm_switch_on: 6.0
  mm_cutoff: 1.0

Loading data from: /pchem-data/meuwly/boittier/home/mmml/mmml/data/fixed-acetone-only_MP2_21000.npz
dataR (21000, 20, 3)
dataE [-81.79712432 -81.48244884 -81.38548297 -81.44645775 -81.74704898
 -81.67295344 -81.32876002 -81.82201676 -81.8124061  -81.80508929]
dataE [-81.79712432 -81.48244884 -81.38548297 -81.44645775 -81.74704898
 -81.67295344 -81.32876002 -81.82201676 -81.8124061  -81.80508929]
D (21000, 3)
Q 1 (21000,) 21000
Q (21000,)
Loaded 10500 validation samples
Prepared 10500 validation batches
Each batch contains 20 atoms

Checkpoint base dir: /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94
Checkpoint epoch dir: /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595
JSON/pickle-based loading failed: Could not find parameters in /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595.
Tried JSON: ['/pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595/params.json', '/pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595/best_params.json', '/pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595/checkpoint.json', '/pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b12c-f55e6c9a2f94/epoch-6595/final_params.json']
Tried pickle: []
Please ensure checkpoint files exist.
Trying orbax-based loading (requires GPU environment)...
dict_keys(['opt_state', 'params', 'step'])
                                                         Model Attributes                                                          
┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┓
┃ charges ┃ cutoff ┃ debug ┃ efa   ┃ featur… ┃ max_at… ┃ max_de… ┃ n_res ┃ natoms ┃ num_ba… ┃ num_it… ┃ total_… ┃ use_en… ┃ zbl   ┃
┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━┩
│ True    │ 8.0    │ False │ False │ 32      │ 40      │ 1       │ 4     │ 20     │ 32      │ 2       │ 0       │ True    │ False │
└─────────┴────────┴───────┴───────┴─────────┴─────────┴─────────┴───────┴────────┴─────────┴─────────┴─────────┴─────────┴───────┘
                                                          Last Checkpoint                                                          
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Checkpoint                                                        ┃ name       ┃ epoch ┃ best_loss ┃ Save Time                  ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-b… │ epoch-6595 │ 6595  │ 313.62808 │ 2025-12-02 16:51:20.645025 │
└───────────────────────────────────────────────────────────────────┴────────────┴───────┴───────────┴────────────────────────────┘
Model loaded using orbax: EF(
    # attributes
    features = 32
    max_degree = 1
    num_iterations = 2
    num_basis_functions = 32
    cutoff = 8.0
    max_atomic_number = 40
    charges = True
    natoms = 20
    total_charge = 0
    n_res = 4
    zbl = False
    debug = False
    efa = False
    use_energy_bias = True
)
[setup_calculator] Cutoff inputs -> ml_cutoff_distance=1.0000, mm_switch_on=6.0000, mm_cutoff=1.0000
[setup_calculator] CutoffParameters stored -> ml_cutoff=1.0000, mm_switch_on=6.0000, mm_cutoff=1.0000
0 1
unique_res_ids [0, 1]
len(dimer_perms) 1
dict_keys(['opt_state', 'params', 'step'])
                                                         Model Attributes                                                          
┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┓
┃ charges ┃ cutoff ┃ debug ┃ efa   ┃ featur… ┃ max_at… ┃ max_de… ┃ n_res ┃ natoms ┃ num_ba… ┃ num_it… ┃ total_… ┃ use_en… ┃ zbl   ┃
┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━┩
│ True    │ 8.0    │ False │ False │ 32      │ 40      │ 1       │ 4     │ 20     │ 32      │ 2       │ 0       │ True    │ False │
└─────────┴────────┴───────┴───────┴─────────┴─────────┴─────────┴───────┴────────┴─────────┴─────────┴─────────┴─────────┴───────┘
                                                          Last Checkpoint                                                          
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Checkpoint                                                       ┃ name        ┃ epoch ┃ best_loss ┃ Save Time                  ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-… │ epoch-10074 │ 10074 │ 238.19751 │ 2025-12-03 17:11:40.755566 │
└──────────────────────────────────────────────────────────────────┴─────────────┴───────┴───────────┴────────────────────────────┘
  
 CHARMM>     BLOCK
 WARNING from DECODI -- Zero length string being converted to 0
 Block structure initialized with   3 blocks.
 All atoms have been assigned to block 1.
 All interaction coefficients have been set to unity.
  Setting number of block exclusions nblock_excldPairs=0
  
  BLOCK>            CALL 1 SELE ALL END
 SELRPN>      0 atoms have been selected out of      0
 The selected atoms have been reassigned to block   1
  
  BLOCK>              COEFF 1 1 1.0
  
  BLOCK>            END
 Matrix of Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of BOND Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ANGLE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of DIHE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of CROSS Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ELEC Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of VDW Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
  
 CHARMM>     
  
  
 CHARMM>     DELETE ATOM SELE ALL END
  
  
 CHARMM>     read rtf card -
 CHARMM>     name /pchem-data/meuwly/boittier/home/mmml/mmml/data/top_all36_cgenff.rtf
 VOPEN> Attempting to open::/pchem-data/meuwly/boittier/home/mmml/mmml/data/top_all36_cgenff.rtf::
 MAINIO> Residue topology file being read from unit  91.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
 VCLOSE: Closing unit   91 with status "KEEP"
  
 CHARMM>     
  
  
 CHARMM>     read param card -
 CHARMM>     name /pchem-data/meuwly/boittier/home/mmml/mmml/data/par_all36_cgenff.prm
 VOPEN> Attempting to open::/pchem-data/meuwly/boittier/home/mmml/mmml/data/par_all36_cgenff.prm::

          PARAMETER FILE BEING READ FROM UNIT 91
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
 VCLOSE: Closing unit   91 with status "KEEP"
  
 CHARMM>     
  
  
 CHARMM>     bomlev 0
  

          RESIDUE SEQUENCE --     2 RESIDUES
          ACO ACO 
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   1 has been generated. Its identifier is ACO ACO.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =        2
         Number of atoms         =       20   Number of groups     =        2
         Number of bonds         =       18   Number of angles     =       30
         Number of dihedrals     =       24   Number of impropers  =        2
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        2   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   -0.00000
 QXFORM> Expanded format used.
         More than 4 character SEGID used.

      ***** LEVEL  1 WARNING FROM <BUILDC> *****
      ***** SOME COORDINATES NOT BUILT
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 ****  WARNING  ****   20 COORDINATES ARE STILL UNDEFINED

          COORDINATE FILE MODULE
 TITLE>  * EXECUTING CHARMM SCRIPT FROM PYTHON
 TITLE>  *
        20  EXT
         1         1  ACO       O1           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         2         1  ACO       C1           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         3         1  ACO       C2           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         4         1  ACO       C3           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         5         1  ACO       H21          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         6         1  ACO       H22          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         7         1  ACO       H23          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         8         1  ACO       H31          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
         9         1  ACO       H32          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
        10         1  ACO       H33          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   1               0.0000000000
        11         2  ACO       O1           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        12         2  ACO       C1           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        13         2  ACO       C2           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        14         2  ACO       C3           9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        15         2  ACO       H21          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        16         2  ACO       H22          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        17         2  ACO       H23          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        18         2  ACO       H31          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        19         2  ACO       H32          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
        20         2  ACO       H33          9999.0000000000     9999.0000000000     9999.0000000000  ACO ACO   2               0.0000000000
  
 CHARMM>     BLOCK
  
  BLOCK>            CALL 1 SELE ALL END
 SELRPN>     20 atoms have been selected out of     20
WARNING: Atom number     1 has been reassigned from block   0 to block   1.
WARNING: Atom number     2 has been reassigned from block   0 to block   1.
WARNING: Atom number     3 has been reassigned from block   0 to block   1.
WARNING: Atom number     4 has been reassigned from block   0 to block   1.
WARNING: Atom number     5 has been reassigned from block   0 to block   1.
WARNING: Atom number     6 has been reassigned from block   0 to block   1.
WARNING: Atom number     7 has been reassigned from block   0 to block   1.
WARNING: Atom number     8 has been reassigned from block   0 to block   1.
WARNING: Atom number     9 has been reassigned from block   0 to block   1.
WARNING: Atom number    10 has been reassigned from block   0 to block   1.
WARNING: Atom number    11 has been reassigned from block   0 to block   1.
WARNING: Atom number    12 has been reassigned from block   0 to block   1.
WARNING: Atom number    13 has been reassigned from block   0 to block   1.
WARNING: Atom number    14 has been reassigned from block   0 to block   1.
WARNING: Atom number    15 has been reassigned from block   0 to block   1.
WARNING: Atom number    16 has been reassigned from block   0 to block   1.
WARNING: Atom number    17 has been reassigned from block   0 to block   1.
WARNING: Atom number    18 has been reassigned from block   0 to block   1.
WARNING: Atom number    19 has been reassigned from block   0 to block   1.
WARNING: Atom number    20 has been reassigned from block   0 to block   1.
 The selected atoms have been reassigned to block   1
  
  BLOCK>              COEFF 1 1 1.0
  
  BLOCK>            END
 Matrix of Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of BOND Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ANGLE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of DIHE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of CROSS Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ELEC Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of VDW Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
  
 CHARMM>     
  
  
 CHARMM>     BLOCK
  
  BLOCK>            CALL 1 SELE ALL END
 SELRPN>     20 atoms have been selected out of     20
 The selected atoms have been reassigned to block   1
  
  BLOCK>              COEFF 1 1 1.0
  
  BLOCK>            END
 Matrix of Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of BOND Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ANGLE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of DIHE Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of CROSS Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of ELEC Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
 Matrix of VDW Interaction Coefficients
 
    1.00000
    1.00000   1.00000
    1.00000   1.00000   1.00000
  
 CHARMM>     
  
  
 CHARMM>     !#########################################
  
 CHARMM>    ! Bonded/Non-bonded Options & Constraints
 CHARMM>    !#########################################
 CHARMM>     
  
 CHARMM>    ! Non-bonding parameters
 CHARMM>    nbonds atom cutnb 14.0  ctofnb 12.0 ctonnb 10.0 -
 CHARMM>    vswitch NBXMOD 3 -
 CHARMM>    inbfrq -1 imgfrq -1

 NONBOND OPTION FLAGS: 
     ELEC     VDW      ATOMs    CDIElec  FSHIft   VATOm    VSWItch 
     BYGRoup  NOEXtnd  NOEWald 
 CUTNB  = 14.000 CTEXNB =999.000 CTONNB = 10.000 CTOFNB = 12.000
 CGONNB =  0.000 CGOFNB = 10.000
 WMIN   =  1.500 WRNMXD =  0.500 E14FAC =  1.000 EPS    =  1.000
 NBXMOD =      3
 There are        0 atom  pairs and        0 atom  exclusions.
 There are        0 group pairs and        0 group exclusions.
 <MAKINB> with mode   3 found     48 exclusions and      0 interactions(1-4)
 <MAKGRP> found      0 group exclusions.
 Generating nonbond list with Exclusion mode = 3
 == PRIMARY == SPACE FOR      181 ATOM PAIRS AND        0 GROUP PAIRS

 General atom nonbond list generation found:
      142 ATOM PAIRS WERE FOUND FOR ATOM LIST
        0 GROUP PAIRS REQUIRED ATOM SEARCHES

Cutoff parameters: CutoffParameters(ml_cutoff=1.0, mm_switch_on=6.0, mm_cutoff=1.0)

Generating 2 residues: ACO ACO
***** Generating residue *****
Residues generated successfully
Structure built using internal coordinates
PyCHARMM atom types: ['O1' 'C1' 'C2' 'C3' 'H21' 'H22' 'H23' 'H31' 'H32' 'H33' 'O1' 'C1' 'C2'
 'C3' 'H21' 'H22' 'H23' 'H31' 'H32' 'H33']
PyCHARMM residue IDs: ['ACO' 'ACO']
PyCHARMM has 20 atoms

Applied atom reordering to 10500 batches

============================================================
Extracting LJ parameters
============================================================
LJ parameters extracted: ['atc_epsilons', 'atc_rmins', 'atc_qs', 'at_codes', 'pair_idx_atom_atom', 'atc', 'iac_to_param_idx', 'unique_iac_codes']

============================================================
ITERATIVE OPTIMIZATION: Alternating LJ and Cutoff Optimization
============================================================
This will alternate between:
  1. Optimizing LJ parameters (using current cutoffs)
  2. Optimizing cutoff parameters (using current LJ parameters)
This iterative approach leads to better overall optimization.
================================================================================
ITERATIVE OPTIMIZATION: Alternating LJ and Cutoff Optimization
================================================================================
Number of iterations: 100
Convergence threshold: 0.001
Initial cutoff parameters: CutoffParameters(ml_cutoff=1.0, mm_switch_on=6.0, mm_cutoff=1.0)
================================================================================

================================================================================
ITERATION 1/100
================================================================================

[Iteration 1] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=1.0, mm_switch_on=6.0, mm_cutoff=1.0)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [1. 1. 1. 1.]
  Initial sig_scale: [1. 1. 1. 1.]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6501.283203
    ep_scale: [0.99490005 0.99490005 0.99490005 0.99490005]
    sig_scale: [0.99490005 0.99490005 0.99490005 1.0051    ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.124348 eV²/Å²
Max force error: 6.021727 eV²/Å²
Mean predicted force magnitude: 0.219919 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6496.677734
    ep_scale: [0.94921273 0.94931614 0.9491334  0.9489268 ]
    sig_scale: [0.9483356  0.94908786 0.95189923 1.0509757 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.120307 eV²/Å²
Max force error: 6.062571 eV²/Å²
Mean predicted force magnitude: 0.214728 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6496.677734
  Optimized ep_scale: [0.94921273 0.94931614 0.9491334  0.9489268 ]
  Optimized sig_scale: [0.9483356  0.94908786 0.95189923 1.0509757 ]

[Iteration 1] LJ optimization complete
  Final loss: 6496.677734
  ep_scale: [0.94921273 0.94931614 0.9491334  0.9489268 ]
  sig_scale: [0.9483356  0.94908786 0.95189923 1.0509757 ]

[Iteration 1] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 1.0
  Initial mm_switch_on: 6.0
  Initial mm_cutoff: 1.0
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4881.445312
    ml_cutoff: 0.9949 (grad: 3.236435e+02)
    mm_switch_on: 6.0051 (grad: -6.504640e+02)
    mm_cutoff: 0.9949 (grad: 1.537862e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.864049 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.229586 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4836.911133
    ml_cutoff: 0.9490 (grad: 3.213070e+02)
    mm_switch_on: 6.0510 (grad: -6.430474e+02)
    mm_cutoff: 0.9491 (grad: 1.481357e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.859847 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.235259 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4836.911133
  Optimized ml_cutoff: 0.9490
  Optimized mm_switch_on: 6.0510
  Optimized mm_cutoff: 0.9491

[Iteration 1] Cutoff optimization complete
  Final loss: 4836.911133
  Cutoff parameters: CutoffParameters(ml_cutoff=0.9490146636962891, mm_switch_on=6.0509772300720215, mm_cutoff=0.9490699768066406)

================================================================================
ITERATION 2/100
================================================================================

[Iteration 2] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.9490146636962891, mm_switch_on=6.0509772300720215, mm_cutoff=0.9490699768066406)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.94921273 0.94931614 0.9491334  0.9489268 ]
  Initial sig_scale: [0.9483356  0.94908786 0.95189923 1.0509757 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6496.153320
    ep_scale: [0.9441128  0.9442162  0.94403344 0.94382685]
    sig_scale: [0.94323564 0.9439879  0.9467993  1.0560757 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.120140 eV²/Å²
Max force error: 6.067382 eV²/Å²
Mean predicted force magnitude: 0.214481 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6490.919434
    ep_scale: [0.8985551  0.89869064 0.89840734 0.8978452 ]
    sig_scale: [0.89730257 0.8983351  0.900457   1.1019324 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.119544 eV²/Å²
Max force error: 6.105850 eV²/Å²
Mean predicted force magnitude: 0.213777 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6490.919434
  Optimized ep_scale: [0.8985551  0.89869064 0.89840734 0.8978452 ]
  Optimized sig_scale: [0.89730257 0.8983351  0.900457   1.1019324 ]

[Iteration 2] LJ optimization complete
  Final loss: 6490.919434
  ep_scale: [0.8985551  0.89869064 0.89840734 0.8978452 ]
  sig_scale: [0.89730257 0.8983351  0.900457   1.1019324 ]

[Iteration 2] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.9490146636962891
  Initial mm_switch_on: 6.0509772300720215
  Initial mm_cutoff: 0.9490699768066406
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4833.811523
    ml_cutoff: 0.9439 (grad: 3.212663e+02)
    mm_switch_on: 6.0561 (grad: -6.432316e+02)
    mm_cutoff: 0.9440 (grad: 1.171023e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.859976 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.236047 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4789.836914
    ml_cutoff: 0.8980 (grad: 3.149676e+02)
    mm_switch_on: 6.1019 (grad: -6.328367e+02)
    mm_cutoff: 0.8981 (grad: 1.127189e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.855994 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.241974 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4789.836914
  Optimized ml_cutoff: 0.8980
  Optimized mm_switch_on: 6.1019
  Optimized mm_cutoff: 0.8981

[Iteration 2] Cutoff optimization complete
  Final loss: 4789.836914
  Cutoff parameters: CutoffParameters(ml_cutoff=0.8980458974838257, mm_switch_on=6.101949214935303, mm_cutoff=0.8981417417526245)

[Iteration 2] Loss improvement: 0.009732

================================================================================
ITERATION 3/100
================================================================================

[Iteration 3] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.8980458974838257, mm_switch_on=6.101949214935303, mm_cutoff=0.8981417417526245)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.8985551  0.89869064 0.89840734 0.8978452 ]
  Initial sig_scale: [0.89730257 0.8983351  0.900457   1.1019324 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6490.329590
    ep_scale: [0.89345515 0.8935907  0.8933074  0.89274526]
    sig_scale: [0.8922026  0.89323515 0.8953571  1.1070324 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.119542 eV²/Å²
Max force error: 6.110297 eV²/Å²
Mean predicted force magnitude: 0.213784 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6485.507324
    ep_scale: [0.8479913 0.8480929 0.8477678 0.8467727]
    sig_scale: [0.8471147 0.8476852 0.8495261 1.1529754]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.120023 eV²/Å²
Max force error: 6.171248 eV²/Å²
Mean predicted force magnitude: 0.214035 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6485.507324
  Optimized ep_scale: [0.8479913 0.8480929 0.8477678 0.8467727]
  Optimized sig_scale: [0.8471147 0.8476852 0.8495261 1.1529754]

[Iteration 3] LJ optimization complete
  Final loss: 6485.507324
  ep_scale: [0.8479913 0.8480929 0.8477678 0.8467727]
  sig_scale: [0.8471147 0.8476852 0.8495261 1.1529754]

[Iteration 3] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.8980458974838257
  Initial mm_switch_on: 6.101949214935303
  Initial mm_cutoff: 0.8981417417526245
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4786.504883
    ml_cutoff: 0.8929 (grad: 3.136467e+02)
    mm_switch_on: 6.1070 (grad: -6.318409e+02)
    mm_cutoff: 0.8930 (grad: 8.730932e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.855844 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.242636 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4743.608398
    ml_cutoff: 0.8471 (grad: 3.030706e+02)
    mm_switch_on: 6.1529 (grad: -6.224645e+02)
    mm_cutoff: 0.8472 (grad: 8.409001e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.852060 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.248468 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4743.608398
  Optimized ml_cutoff: 0.8471
  Optimized mm_switch_on: 6.1529
  Optimized mm_cutoff: 0.8472

[Iteration 3] Cutoff optimization complete
  Final loss: 4743.608398
  Cutoff parameters: CutoffParameters(ml_cutoff=0.8471122980117798, mm_switch_on=6.152919292449951, mm_cutoff=0.8472119569778442)

[Iteration 3] Loss improvement: 0.009651

================================================================================
ITERATION 4/100
================================================================================

[Iteration 4] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.8471122980117798, mm_switch_on=6.152919292449951, mm_cutoff=0.8472119569778442)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.8479913 0.8480929 0.8477678 0.8467727]
  Initial sig_scale: [0.8471147 0.8476852 0.8495261 1.1529754]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6485.009766
    ep_scale: [0.84289134 0.84299296 0.8426678  0.8416727 ]
    sig_scale: [0.84201473 0.84258527 0.84442616 1.1580755 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.120023 eV²/Å²
Max force error: 6.174953 eV²/Å²
Mean predicted force magnitude: 0.214051 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6480.947754
    ep_scale: [0.79750323 0.7975011  0.7971765  0.7957215 ]
    sig_scale: [0.7988841  0.79710037 0.79886854 1.2041223 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.121377 eV²/Å²
Max force error: 6.285908 eV²/Å²
Mean predicted force magnitude: 0.214443 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6480.947754
  Optimized ep_scale: [0.79750323 0.7975011  0.7971765  0.7957215 ]
  Optimized sig_scale: [0.7988841  0.79710037 0.79886854 1.2041223 ]

[Iteration 4] LJ optimization complete
  Final loss: 6480.947754
  ep_scale: [0.79750323 0.7975011  0.7971765  0.7957215 ]
  sig_scale: [0.7988841  0.79710037 0.79886854 1.2041223 ]

[Iteration 4] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.8471122980117798
  Initial mm_switch_on: 6.152919292449951
  Initial mm_cutoff: 0.8472119569778442
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4740.050781
    ml_cutoff: 0.8420 (grad: 3.020124e+02)
    mm_switch_on: 6.1580 (grad: -6.221277e+02)
    mm_cutoff: 0.8421 (grad: 6.444309e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.851630 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.249212 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4697.869629
    ml_cutoff: 0.7961 (grad: 2.965171e+02)
    mm_switch_on: 6.2039 (grad: -6.187217e+02)
    mm_cutoff: 0.7963 (grad: 6.207125e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.847990 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.254949 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4697.869629
  Optimized ml_cutoff: 0.7961
  Optimized mm_switch_on: 6.2039
  Optimized mm_cutoff: 0.7963

[Iteration 4] Cutoff optimization complete
  Final loss: 4697.869629
  Cutoff parameters: CutoffParameters(ml_cutoff=0.7961499691009521, mm_switch_on=6.203909397125244, mm_cutoff=0.7962821125984192)

[Iteration 4] Loss improvement: 0.009642

================================================================================
ITERATION 5/100
================================================================================

[Iteration 5] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.7961499691009521, mm_switch_on=6.203909397125244, mm_cutoff=0.7962821125984192)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.79750323 0.7975011  0.7971765  0.7957215 ]
  Initial sig_scale: [0.7988841  0.79710037 0.79886854 1.2041223 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6480.570312
    ep_scale: [0.7924033  0.79240113 0.7920765  0.7906215 ]
    sig_scale: [0.79378414 0.7920004  0.7937686  1.2092223 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.121342 eV²/Å²
Max force error: 6.288471 eV²/Å²
Mean predicted force magnitude: 0.214442 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6476.939453
    ep_scale: [0.747023   0.7468445  0.746547   0.74483097]
    sig_scale: [0.8032847  0.74650425 0.7483023  1.255671  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.156620 eV²/Å²
Max force error: 8.282651 eV²/Å²
Mean predicted force magnitude: 0.221585 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6476.939453
  Optimized ep_scale: [0.747023   0.7468445  0.746547   0.74483097]
  Optimized sig_scale: [0.8032847  0.74650425 0.7483023  1.255671  ]

[Iteration 5] LJ optimization complete
  Final loss: 6476.939453
  ep_scale: [0.747023   0.7468445  0.746547   0.74483097]
  sig_scale: [0.8032847  0.74650425 0.7483023  1.255671  ]

[Iteration 5] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.7961499691009521
  Initial mm_switch_on: 6.203909397125244
  Initial mm_cutoff: 0.7962821125984192
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4694.090332
    ml_cutoff: 0.7911 (grad: 2.962976e+02)
    mm_switch_on: 6.2090 (grad: -6.190186e+02)
    mm_cutoff: 0.7912 (grad: 4.548688e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.847651 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.256145 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4652.043945
    ml_cutoff: 0.7452 (grad: 2.956658e+02)
    mm_switch_on: 6.2549 (grad: -6.198239e+02)
    mm_cutoff: 0.7453 (grad: 4.434394e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.844127 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.262078 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4652.043945
  Optimized ml_cutoff: 0.7452
  Optimized mm_switch_on: 6.2549
  Optimized mm_cutoff: 0.7453

[Iteration 5] Cutoff optimization complete
  Final loss: 4652.043945
  Cutoff parameters: CutoffParameters(ml_cutoff=0.7451519966125488, mm_switch_on=6.254912376403809, mm_cutoff=0.7453303933143616)

[Iteration 5] Loss improvement: 0.009755

================================================================================
ITERATION 6/100
================================================================================

[Iteration 6] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.7451519966125488, mm_switch_on=6.254912376403809, mm_cutoff=0.7453303933143616)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.747023   0.7468445  0.746547   0.74483097]
  Initial sig_scale: [0.8032847  0.74650425 0.7483023  1.255671  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6476.462891
    ep_scale: [0.74192303 0.7417445  0.74144703 0.739731  ]
    sig_scale: [0.80838466 0.7414043  0.7432023  1.260771  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.165080 eV²/Å²
Max force error: 8.753032 eV²/Å²
Mean predicted force magnitude: 0.223132 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6471.322266
    ep_scale: [0.69709766 0.6960696  0.69580156 0.69477415]
    sig_scale: [0.85510004 0.69582605 0.6976355  1.3074044 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.289328 eV²/Å²
Max force error: 15.565215 eV²/Å²
Mean predicted force magnitude: 0.241776 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6471.322266
  Optimized ep_scale: [0.69709766 0.6960696  0.69580156 0.69477415]
  Optimized sig_scale: [0.85510004 0.69582605 0.6976355  1.3074044 ]

[Iteration 6] LJ optimization complete
  Final loss: 6471.322266
  ep_scale: [0.69709766 0.6960696  0.69580156 0.69477415]
  sig_scale: [0.85510004 0.69582605 0.6976355  1.3074044 ]

[Iteration 6] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.7451519966125488
  Initial mm_switch_on: 6.254912376403809
  Initial mm_cutoff: 0.7453303933143616
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4648.187988
    ml_cutoff: 0.7401 (grad: 2.956407e+02)
    mm_switch_on: 6.2600 (grad: -6.205568e+02)
    mm_cutoff: 0.7402 (grad: 2.057899e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.843668 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.262469 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4605.875000
    ml_cutoff: 0.6941 (grad: 3.015881e+02)
    mm_switch_on: 6.3059 (grad: -6.264760e+02)
    mm_cutoff: 0.6942 (grad: 2.180297e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.840091 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.268515 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4605.875000
  Optimized ml_cutoff: 0.6941
  Optimized mm_switch_on: 6.3059
  Optimized mm_cutoff: 0.6942

[Iteration 6] Cutoff optimization complete
  Final loss: 4605.875000
  Cutoff parameters: CutoffParameters(ml_cutoff=0.6941159963607788, mm_switch_on=6.305928707122803, mm_cutoff=0.6942335367202759)

[Iteration 6] Loss improvement: 0.009924

================================================================================
ITERATION 7/100
================================================================================

[Iteration 7] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.6941159963607788, mm_switch_on=6.305928707122803, mm_cutoff=0.6942335367202759)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.69709766 0.6960696  0.69580156 0.69477415]
  Initial sig_scale: [0.85510004 0.69582605 0.6976355  1.3074044 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6470.609375
    ep_scale: [0.6919977  0.69096965 0.6907016  0.6896742 ]
    sig_scale: [0.8602    0.6907261 0.6925355 1.3125044]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.309695 eV²/Å²
Max force error: 16.671402 eV²/Å²
Mean predicted force magnitude: 0.244364 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6463.325684
    ep_scale: [0.65291595 0.6452621  0.645023   0.64953536]
    sig_scale: [0.9067811  0.6451422  0.64695245 1.3589752 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.610371 eV²/Å²
Max force error: 32.841052 eV²/Å²
Mean predicted force magnitude: 0.275268 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6463.325684
  Optimized ep_scale: [0.65291595 0.6452621  0.645023   0.64953536]
  Optimized sig_scale: [0.9067811  0.6451422  0.64695245 1.3589752 ]

[Iteration 7] LJ optimization complete
  Final loss: 6463.325684
  ep_scale: [0.65291595 0.6452621  0.645023   0.64953536]
  sig_scale: [0.9067811  0.6451422  0.64695245 1.3589752 ]

[Iteration 7] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.6941159963607788
  Initial mm_switch_on: 6.305928707122803
  Initial mm_cutoff: 0.6942335367202759
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4602.070801
    ml_cutoff: 0.6890 (grad: 3.025929e+02)
    mm_switch_on: 6.3110 (grad: -6.288287e+02)
    mm_cutoff: 0.6993 (grad: -1.551213e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.839678 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.268701 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4558.990234
    ml_cutoff: 0.6431 (grad: 3.073428e+02)
    mm_switch_on: 6.3569 (grad: -6.348933e+02)
    mm_cutoff: 0.7432 (grad: -6.308252e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.835757 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.274265 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4558.990234
  Optimized ml_cutoff: 0.6431
  Optimized mm_switch_on: 6.3569
  Optimized mm_cutoff: 0.7432

[Iteration 7] Cutoff optimization complete
  Final loss: 4558.990234
  Cutoff parameters: CutoffParameters(ml_cutoff=0.6430845856666565, mm_switch_on=6.356947898864746, mm_cutoff=0.7431733012199402)

[Iteration 7] Loss improvement: 0.010179

================================================================================
ITERATION 8/100
================================================================================

[Iteration 8] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.6430845856666565, mm_switch_on=6.356947898864746, mm_cutoff=0.7431733012199402)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.65291595 0.6452621  0.645023   0.64953536]
  Initial sig_scale: [0.9067811  0.6451422  0.64695245 1.3589752 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6462.390625
    ep_scale: [0.6580159  0.64016217 0.63992304 0.6546353 ]
    sig_scale: [0.911881   0.64004225 0.6418525  1.3640752 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 1.675241 eV²/Å²
Max force error: 36.315487 eV²/Å²
Mean predicted force magnitude: 0.280757 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6452.942383
    ep_scale: [0.70122665 0.5943163  0.59409183 0.7007795 ]
    sig_scale: [0.9580598 0.5943379 0.5960985 1.4102999]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 2.742589 eV²/Å²
Max force error: 93.009543 eV²/Å²
Mean predicted force magnitude: 0.348524 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6452.942383
  Optimized ep_scale: [0.70122665 0.5943163  0.59409183 0.7007795 ]
  Optimized sig_scale: [0.9580598 0.5943379 0.5960985 1.4102999]

[Iteration 8] LJ optimization complete
  Final loss: 6452.942383
  ep_scale: [0.70122665 0.5943163  0.59409183 0.7007795 ]
  sig_scale: [0.9580598 0.5943379 0.5960985 1.4102999]

[Iteration 8] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.6430845856666565
  Initial mm_switch_on: 6.356947898864746
  Initial mm_cutoff: 0.7431733012199402
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4555.499512
    ml_cutoff: 0.6380 (grad: 3.080796e+02)
    mm_switch_on: 6.3620 (grad: -6.379616e+02)
    mm_cutoff: 0.7483 (grad: -7.483314e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.835388 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.275075 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4511.779785
    ml_cutoff: 0.5921 (grad: 3.135625e+02)
    mm_switch_on: 6.4080 (grad: -6.465603e+02)
    mm_cutoff: 0.7936 (grad: -5.650108e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.831500 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.280737 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4511.779785
  Optimized ml_cutoff: 0.5921
  Optimized mm_switch_on: 6.4080
  Optimized mm_cutoff: 0.7936

[Iteration 8] Cutoff optimization complete
  Final loss: 4511.779785
  Cutoff parameters: CutoffParameters(ml_cutoff=0.592058002948761, mm_switch_on=6.407970905303955, mm_cutoff=0.7935590744018555)

[Iteration 8] Loss improvement: 0.010355

================================================================================
ITERATION 9/100
================================================================================

[Iteration 9] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.592058002948761, mm_switch_on=6.407970905303955, mm_cutoff=0.7935590744018555)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.70122665 0.5943163  0.59409183 0.7007795 ]
  Initial sig_scale: [0.9580598 0.5943379 0.5960985 1.4102999]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6451.860840
    ep_scale: [0.6961267  0.58921635 0.5889919  0.70587945]
    sig_scale: [0.96315974 0.5892379  0.59099853 1.4153999 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 2.915321 eV²/Å²
Max force error: 102.116204 eV²/Å²
Mean predicted force magnitude: 0.357267 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6444.594238
    ep_scale: [0.6510075 0.5434206 0.5431958 0.6865939]
    sig_scale: [1.0057614  0.543607   0.54525703 1.4599508 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.945891 eV²/Å²
Max force error: 208.569932 eV²/Å²
Mean predicted force magnitude: 0.441107 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6444.594238
  Optimized ep_scale: [0.6510075 0.5434206 0.5431958 0.6865939]
  Optimized sig_scale: [1.0057614  0.543607   0.54525703 1.4599508 ]

[Iteration 9] LJ optimization complete
  Final loss: 6444.594238
  ep_scale: [0.6510075 0.5434206 0.5431958 0.6865939]
  sig_scale: [1.0057614  0.543607   0.54525703 1.4599508 ]

[Iteration 9] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.592058002948761
  Initial mm_switch_on: 6.407970905303955
  Initial mm_cutoff: 0.7935590744018555
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4509.003906
    ml_cutoff: 0.5870 (grad: 3.147141e+02)
    mm_switch_on: 6.4131 (grad: -6.509650e+02)
    mm_cutoff: 0.7987 (grad: -1.609560e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.831312 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.281829 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4464.429199
    ml_cutoff: 0.5410 (grad: 3.160927e+02)
    mm_switch_on: 6.4590 (grad: -6.539171e+02)
    mm_cutoff: 0.8443 (grad: -1.390725e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 0.827535 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.287694 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4464.429199
  Optimized ml_cutoff: 0.5410
  Optimized mm_switch_on: 6.4590
  Optimized mm_cutoff: 0.8443

[Iteration 9] Cutoff optimization complete
  Final loss: 4464.429199
  Cutoff parameters: CutoffParameters(ml_cutoff=0.5410450100898743, mm_switch_on=6.458978176116943, mm_cutoff=0.8442778587341309)

[Iteration 9] Loss improvement: 0.010495

================================================================================
ITERATION 10/100
================================================================================

[Iteration 10] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.5410450100898743, mm_switch_on=6.458978176116943, mm_cutoff=0.8442778587341309)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.6510075 0.5434206 0.5431958 0.6865939]
  Initial sig_scale: [1.0057614  0.543607   0.54525703 1.4599508 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6444.173340
    ep_scale: [0.6459075  0.53832066 0.53809583 0.68149394]
    sig_scale: [1.0006614  0.53850704 0.5401571  1.4650508 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.935710 eV²/Å²
Max force error: 207.896939 eV²/Å²
Mean predicted force magnitude: 0.440708 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6439.660645
    ep_scale: [0.6002123  0.49265462 0.4924806  0.6365367 ]
    sig_scale: [0.95583165 0.49305692 0.49482843 1.5115747 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.897109 eV²/Å²
Max force error: 204.232467 eV²/Å²
Mean predicted force magnitude: 0.440798 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6439.660645
  Optimized ep_scale: [0.6002123  0.49265462 0.4924806  0.6365367 ]
  Optimized sig_scale: [0.95583165 0.49305692 0.49482843 1.5115747 ]

[Iteration 10] LJ optimization complete
  Final loss: 6439.660645
  ep_scale: [0.6002123  0.49265462 0.4924806  0.6365367 ]
  sig_scale: [0.95583165 0.49305692 0.49482843 1.5115747 ]

[Iteration 10] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.5410450100898743
  Initial mm_switch_on: 6.458978176116943
  Initial mm_cutoff: 0.8442778587341309
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4460.195801
    ml_cutoff: 0.5359 (grad: 3.157737e+02)
    mm_switch_on: 6.4641 (grad: -6.545944e+02)
    mm_cutoff: 0.8494 (grad: -1.518682e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.827161 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.288310 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4415.654297
    ml_cutoff: 0.4901 (grad: 3.144725e+02)
    mm_switch_on: 6.5100 (grad: -6.571662e+02)
    mm_cutoff: 0.8949 (grad: -1.238980e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.823399 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.294147 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4415.654297
  Optimized ml_cutoff: 0.4901
  Optimized mm_switch_on: 6.5100
  Optimized mm_cutoff: 0.8949

[Iteration 10] Cutoff optimization complete
  Final loss: 4415.654297
  Cutoff parameters: CutoffParameters(ml_cutoff=0.4900602400302887, mm_switch_on=6.509979724884033, mm_cutoff=0.8948794007301331)

[Iteration 10] Loss improvement: 0.010925

================================================================================
ITERATION 11/100
================================================================================

[Iteration 11] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.4900602400302887, mm_switch_on=6.509979724884033, mm_cutoff=0.8948794007301331)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.6002123  0.49265462 0.4924806  0.6365367 ]
  Initial sig_scale: [0.95583165 0.49305692 0.49482843 1.5115747 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6439.122070
    ep_scale: [0.5951123  0.48755467 0.48738065 0.63143677]
    sig_scale: [0.9507317  0.48795697 0.48972848 1.5166748 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.884155 eV²/Å²
Max force error: 203.327459 eV²/Å²
Mean predicted force magnitude: 0.440627 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6434.010254
    ep_scale: [0.5493866  0.44182828 0.44170114 0.5893087 ]
    sig_scale: [0.9090468  0.44248307 0.44437215 1.5630559 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.928915 eV²/Å²
Max force error: 203.005875 eV²/Å²
Mean predicted force magnitude: 0.445167 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6434.010254
  Optimized ep_scale: [0.5493866  0.44182828 0.44170114 0.5893087 ]
  Optimized sig_scale: [0.9090468  0.44248307 0.44437215 1.5630559 ]

[Iteration 11] LJ optimization complete
  Final loss: 6434.010254
  ep_scale: [0.5493866  0.44182828 0.44170114 0.5893087 ]
  sig_scale: [0.9090468  0.44248307 0.44437215 1.5630559 ]

[Iteration 11] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.4900602400302887
  Initial mm_switch_on: 6.509979724884033
  Initial mm_cutoff: 0.8948794007301331
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4411.437012
    ml_cutoff: 0.4850 (grad: 3.146191e+02)
    mm_switch_on: 6.5151 (grad: -6.589662e+02)
    mm_cutoff: 0.9000 (grad: -1.402040e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.823496 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.295280 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4366.315918
    ml_cutoff: 0.4390 (grad: 3.195224e+02)
    mm_switch_on: 6.5610 (grad: -6.712382e+02)
    mm_cutoff: 0.9454 (grad: -1.125944e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.819706 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.301245 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4366.315918
  Optimized ml_cutoff: 0.4390
  Optimized mm_switch_on: 6.5610
  Optimized mm_cutoff: 0.9454

[Iteration 11] Cutoff optimization complete
  Final loss: 4366.315918
  Cutoff parameters: CutoffParameters(ml_cutoff=0.4390379786491394, mm_switch_on=6.561012268066406, mm_cutoff=0.9454095959663391)

[Iteration 11] Loss improvement: 0.011174

================================================================================
ITERATION 12/100
================================================================================

[Iteration 12] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.4390379786491394, mm_switch_on=6.561012268066406, mm_cutoff=0.9454095959663391)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.5493866  0.44182828 0.44170114 0.5893087 ]
  Initial sig_scale: [0.9090468  0.44248307 0.44437215 1.5630559 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6433.423340
    ep_scale: [0.54428667 0.43672833 0.4366012  0.5842087 ]
    sig_scale: [0.9039469  0.43738312 0.4392722  1.5681559 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 4.913225 eV²/Å²
Max force error: 201.824933 eV²/Å²
Mean predicted force magnitude: 0.444970 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6427.221680
    ep_scale: [0.49801424 0.3908623  0.39076683 0.620908  ]
    sig_scale: [0.85943365 0.39179927 0.3937619  1.6143247 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 5.392688 eV²/Å²
Max force error: 219.994501 eV²/Å²
Mean predicted force magnitude: 0.468040 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6427.221680
  Optimized ep_scale: [0.49801424 0.3908623  0.39076683 0.620908  ]
  Optimized sig_scale: [0.85943365 0.39179927 0.3937619  1.6143247 ]

[Iteration 12] LJ optimization complete
  Final loss: 6427.221680
  ep_scale: [0.49801424 0.3908623  0.39076683 0.620908  ]
  sig_scale: [0.85943365 0.39179927 0.3937619  1.6143247 ]

[Iteration 12] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.4390379786491394
  Initial mm_switch_on: 6.561012268066406
  Initial mm_cutoff: 0.9454095959663391
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4362.114258
    ml_cutoff: 0.4339 (grad: 3.229329e+02)
    mm_switch_on: 6.5661 (grad: -6.757225e+02)
    mm_cutoff: 0.9505 (grad: -1.444430e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.819672 eV²/Å²
Max force error: 1.962903 eV²/Å²
Mean predicted force magnitude: 0.301638 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4314.896484
    ml_cutoff: 0.3879 (grad: 3.438227e+02)
    mm_switch_on: 6.6121 (grad: -6.977845e+02)
    mm_cutoff: 0.9960 (grad: -1.189361e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.815661 eV²/Å²
Max force error: 1.962908 eV²/Å²
Mean predicted force magnitude: 0.307891 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4314.896484
  Optimized ml_cutoff: 0.3879
  Optimized mm_switch_on: 6.6121
  Optimized mm_cutoff: 0.9960

[Iteration 12] Cutoff optimization complete
  Final loss: 4314.896484
  Cutoff parameters: CutoffParameters(ml_cutoff=0.3879055976867676, mm_switch_on=6.6120805740356445, mm_cutoff=0.9960089921951294)

[Iteration 12] Loss improvement: 0.011776

================================================================================
ITERATION 13/100
================================================================================

[Iteration 13] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.3879055976867676, mm_switch_on=6.6120805740356445, mm_cutoff=0.9960089921951294)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.49801424 0.3908623  0.39076683 0.620908  ]
  Initial sig_scale: [0.85943365 0.39179927 0.3937619  1.6143247 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6426.389648
    ep_scale: [0.4929143  0.38576233 0.38566688 0.626008  ]
    sig_scale: [0.8543337  0.38669932 0.38866195 1.6194247 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 5.452817 eV²/Å²
Max force error: 221.981920 eV²/Å²
Mean predicted force magnitude: 0.470965 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6418.101074
    ep_scale: [0.44653597 0.33981383 0.33973336 0.67268896]
    sig_scale: [0.80763423 0.34104556 0.34299573 1.6655606 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 6.069184 eV²/Å²
Max force error: 238.056664 eV²/Å²
Mean predicted force magnitude: 0.500442 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6418.101074
  Optimized ep_scale: [0.44653597 0.33981383 0.33973336 0.67268896]
  Optimized sig_scale: [0.80763423 0.34104556 0.34299573 1.6655606 ]

[Iteration 13] LJ optimization complete
  Final loss: 6418.101074
  ep_scale: [0.44653597 0.33981383 0.33973336 0.67268896]
  sig_scale: [0.80763423 0.34104556 0.34299573 1.6655606 ]

[Iteration 13] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.3879055976867676
  Initial mm_switch_on: 6.6120805740356445
  Initial mm_cutoff: 0.9960089921951294
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4310.613281
    ml_cutoff: 0.3828 (grad: 3.446263e+02)
    mm_switch_on: 6.6172 (grad: -6.995327e+02)
    mm_cutoff: 1.0011 (grad: -1.630611e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.815257 eV²/Å²
Max force error: 1.962909 eV²/Å²
Mean predicted force magnitude: 0.308372 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4263.039062
    ml_cutoff: 0.3369 (grad: 3.381893e+02)
    mm_switch_on: 6.6630 (grad: -6.859648e+02)
    mm_cutoff: 1.0467 (grad: -1.376615e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.811273 eV²/Å²
Max force error: 1.962920 eV²/Å²
Mean predicted force magnitude: 0.314695 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4263.039062
  Optimized ml_cutoff: 0.3369
  Optimized mm_switch_on: 6.6630
  Optimized mm_cutoff: 1.0467

[Iteration 13] Cutoff optimization complete
  Final loss: 4263.039062
  Cutoff parameters: CutoffParameters(ml_cutoff=0.33694708347320557, mm_switch_on=6.663041591644287, mm_cutoff=1.0466678142547607)

[Iteration 13] Loss improvement: 0.012018

================================================================================
ITERATION 14/100
================================================================================

[Iteration 14] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.33694708347320557, mm_switch_on=6.663041591644287, mm_cutoff=1.0466678142547607)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.44653597 0.33981383 0.33973336 0.67268896]
  Initial sig_scale: [0.80763423 0.34104556 0.34299573 1.6655606 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6417.051270
    ep_scale: [0.44143602 0.33471388 0.3346334  0.6777889 ]
    sig_scale: [0.8025343  0.3359456  0.33789578 1.6706606 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 6.152914 eV²/Å²
Max force error: 239.813694 eV²/Å²
Mean predicted force magnitude: 0.504236 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6406.841309
    ep_scale: [0.39506227 0.28872517 0.28864524 0.72383094]
    sig_scale: [0.756019   0.29026532 0.29211777 1.7165821 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 7.087229 eV²/Å²
Max force error: 252.790115 eV²/Å²
Mean predicted force magnitude: 0.543456 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6406.841309
  Optimized ep_scale: [0.39506227 0.28872517 0.28864524 0.72383094]
  Optimized sig_scale: [0.756019   0.29026532 0.29211777 1.7165821 ]

[Iteration 14] LJ optimization complete
  Final loss: 6406.841309
  ep_scale: [0.39506227 0.28872517 0.28864524 0.72383094]
  sig_scale: [0.756019   0.29026532 0.29211777 1.7165821 ]

[Iteration 14] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.33694708347320557
  Initial mm_switch_on: 6.663041591644287
  Initial mm_cutoff: 1.0466678142547607
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4259.287109
    ml_cutoff: 0.3318 (grad: 3.376661e+02)
    mm_switch_on: 6.6681 (grad: -6.860412e+02)
    mm_cutoff: 1.0518 (grad: -2.004378e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.811142 eV²/Å²
Max force error: 1.962922 eV²/Å²
Mean predicted force magnitude: 0.315274 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4212.709473
    ml_cutoff: 0.2860 (grad: 3.366113e+02)
    mm_switch_on: 6.7140 (grad: -6.671262e+02)
    mm_cutoff: 1.0974 (grad: -1.744098e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.807309 eV²/Å²
Max force error: 1.962941 eV²/Å²
Mean predicted force magnitude: 0.321632 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4212.709473
  Optimized ml_cutoff: 0.2860
  Optimized mm_switch_on: 6.7140
  Optimized mm_cutoff: 1.0974

[Iteration 14] Cutoff optimization complete
  Final loss: 4212.709473
  Cutoff parameters: CutoffParameters(ml_cutoff=0.28595224022865295, mm_switch_on=6.71399450302124, mm_cutoff=1.0974047183990479)

[Iteration 14] Loss improvement: 0.011806

================================================================================
ITERATION 15/100
================================================================================

[Iteration 15] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.28595224022865295, mm_switch_on=6.71399450302124, mm_cutoff=1.0974047183990479)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.39506227 0.28872517 0.28864524 0.72383094]
  Initial sig_scale: [0.756019   0.29026532 0.29211777 1.7165821 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6405.607910
    ep_scale: [0.38996232 0.28362522 0.2835453  0.7289309 ]
    sig_scale: [0.75091904 0.28516537 0.28701782 1.7216821 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 7.225007 eV²/Å²
Max force error: 254.194320 eV²/Å²
Mean predicted force magnitude: 0.548746 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6395.532227
    ep_scale: [0.34361252 0.23761153 0.2375191  0.7663881 ]
    sig_scale: [0.7045557  0.23948811 0.24117939 1.7663647 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.681438 eV²/Å²
Max force error: 257.604660 eV²/Å²
Mean predicted force magnitude: 0.599313 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6395.532227
  Optimized ep_scale: [0.34361252 0.23761153 0.2375191  0.7663881 ]
  Optimized sig_scale: [0.7045557  0.23948811 0.24117939 1.7663647 ]

[Iteration 15] LJ optimization complete
  Final loss: 6395.532227
  ep_scale: [0.34361252 0.23761153 0.2375191  0.7663881 ]
  sig_scale: [0.7045557  0.23948811 0.24117939 1.7663647 ]

[Iteration 15] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.28595224022865295
  Initial mm_switch_on: 6.71399450302124
  Initial mm_cutoff: 1.0974047183990479
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4209.891602
    ml_cutoff: 0.2809 (grad: 3.348234e+02)
    mm_switch_on: 6.7191 (grad: -6.658924e+02)
    mm_cutoff: 1.1025 (grad: -2.645525e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.807532 eV²/Å²
Max force error: 1.962943 eV²/Å²
Mean predicted force magnitude: 0.322754 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4164.931152
    ml_cutoff: 0.2350 (grad: 3.174942e+02)
    mm_switch_on: 6.7649 (grad: -6.359662e+02)
    mm_cutoff: 1.1482 (grad: -2.330765e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.804180 eV²/Å²
Max force error: 1.962969 eV²/Å²
Mean predicted force magnitude: 0.329188 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4164.931152
  Optimized ml_cutoff: 0.2350
  Optimized mm_switch_on: 6.7649
  Optimized mm_cutoff: 1.1482

[Iteration 15] Cutoff optimization complete
  Final loss: 4164.931152
  Cutoff parameters: CutoffParameters(ml_cutoff=0.23504556715488434, mm_switch_on=6.764912128448486, mm_cutoff=1.1481590270996094)

[Iteration 15] Loss improvement: 0.011341

================================================================================
ITERATION 16/100
================================================================================

[Iteration 16] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.23504556715488434, mm_switch_on=6.764912128448486, mm_cutoff=1.1481590270996094)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.34361252 0.23761153 0.2375191  0.7663881 ]
  Initial sig_scale: [0.7045557  0.23948811 0.24117939 1.7663647 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6394.612793
    ep_scale: [0.33851257 0.23251157 0.23241913 0.76128817]
    sig_scale: [0.69945574 0.23438814 0.23607942 1.7714647 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.791141 eV²/Å²
Max force error: 255.275094 eV²/Å²
Mean predicted force magnitude: 0.602816 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6387.301270
    ep_scale: [0.2926839  0.18655102 0.186457   0.71474755]
    sig_scale: [0.6540122  0.18884285 0.19041742 1.810541  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.421323 eV²/Å²
Max force error: 274.336213 eV²/Å²
Mean predicted force magnitude: 0.619481 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6387.301270
  Optimized ep_scale: [0.2926839  0.18655102 0.186457   0.71474755]
  Optimized sig_scale: [0.6540122  0.18884285 0.19041742 1.810541  ]

[Iteration 16] LJ optimization complete
  Final loss: 6387.301270
  ep_scale: [0.2926839  0.18655102 0.186457   0.71474755]
  sig_scale: [0.6540122  0.18884285 0.19041742 1.810541  ]

[Iteration 16] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.23504556715488434
  Initial mm_switch_on: 6.764912128448486
  Initial mm_cutoff: 1.1481590270996094
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4161.749512
    ml_cutoff: 0.2299 (grad: 3.162810e+02)
    mm_switch_on: 6.7700 (grad: -6.345276e+02)
    mm_cutoff: 1.1533 (grad: -2.991125e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.803211 eV²/Å²
Max force error: 1.962972 eV²/Å²
Mean predicted force magnitude: 0.329455 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4119.528320
    ml_cutoff: 0.1842 (grad: 3.023882e+02)
    mm_switch_on: 6.8158 (grad: -6.218636e+02)
    mm_cutoff: 1.1990 (grad: -2.705354e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.800181 eV²/Å²
Max force error: 1.963001 eV²/Å²
Mean predicted force magnitude: 0.335950 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4119.528320
  Optimized ml_cutoff: 0.1842
  Optimized mm_switch_on: 6.8158
  Optimized mm_cutoff: 1.1990

[Iteration 16] Cutoff optimization complete
  Final loss: 4119.528320
  Cutoff parameters: CutoffParameters(ml_cutoff=0.18421699106693268, mm_switch_on=6.815820217132568, mm_cutoff=1.1989589929580688)

[Iteration 16] Loss improvement: 0.010901

================================================================================
ITERATION 17/100
================================================================================

[Iteration 17] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.18421699106693268, mm_switch_on=6.815820217132568, mm_cutoff=1.1989589929580688)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.2926839  0.18655102 0.186457   0.71474755]
  Initial sig_scale: [0.6540122  0.18884285 0.19041742 1.810541  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6386.693359
    ep_scale: [0.28758395 0.18145105 0.18135703 0.7096476 ]
    sig_scale: [0.64891225 0.18374288 0.18531746 1.815641  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.599818 eV²/Å²
Max force error: 286.490574 eV²/Å²
Mean predicted force magnitude: 0.623842 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6382.711426
    ep_scale: [0.24339168 0.13549563 0.13540246 0.6648147 ]
    sig_scale: [0.60844517 0.13831252 0.13978985 1.8396049 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.358680 eV²/Å²
Max force error: 321.973269 eV²/Å²
Mean predicted force magnitude: 0.609147 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6382.711426
  Optimized ep_scale: [0.24339168 0.13549563 0.13540246 0.6648147 ]
  Optimized sig_scale: [0.60844517 0.13831252 0.13978985 1.8396049 ]

[Iteration 17] LJ optimization complete
  Final loss: 6382.711426
  ep_scale: [0.24339168 0.13549563 0.13540246 0.6648147 ]
  sig_scale: [0.60844517 0.13831252 0.13978985 1.8396049 ]

[Iteration 17] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.18421699106693268
  Initial mm_switch_on: 6.815820217132568
  Initial mm_cutoff: 1.1989589929580688
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4115.645996
    ml_cutoff: 0.1791 (grad: 3.057156e+02)
    mm_switch_on: 6.8209 (grad: -6.267297e+02)
    mm_cutoff: 1.2041 (grad: -3.050856e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.799783 eV²/Å²
Max force error: 1.963004 eV²/Å²
Mean predicted force magnitude: 0.336591 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4071.761475
    ml_cutoff: 0.1332 (grad: 3.107347e+02)
    mm_switch_on: 6.8669 (grad: -6.570256e+02)
    mm_cutoff: 1.2498 (grad: -2.803475e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.796267 eV²/Å²
Max force error: 1.963033 eV²/Å²
Mean predicted force magnitude: 0.342867 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4071.761475
  Optimized ml_cutoff: 0.1332
  Optimized mm_switch_on: 6.8669
  Optimized mm_cutoff: 1.2498

[Iteration 17] Cutoff optimization complete
  Final loss: 4071.761475
  Cutoff parameters: CutoffParameters(ml_cutoff=0.1331726312637329, mm_switch_on=6.866916179656982, mm_cutoff=1.2498066425323486)

[Iteration 17] Loss improvement: 0.011595

================================================================================
ITERATION 18/100
================================================================================

[Iteration 18] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.1331726312637329, mm_switch_on=6.866916179656982, mm_cutoff=1.2498066425323486)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.24339168 0.13549563 0.13540246 0.6648147 ]
  Initial sig_scale: [0.60844517 0.13831252 0.13978985 1.8396049 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6382.411133
    ep_scale: [0.23829171 0.13039567 0.13030249 0.65971476]
    sig_scale: [0.6033452  0.13321255 0.13468988 1.8345048 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.564038 eV²/Å²
Max force error: 294.151196 eV²/Å²
Mean predicted force magnitude: 0.585652 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6380.215820
    ep_scale: [0.19332097 0.1        0.1        0.614581  ]
    sig_scale: [0.6103276 0.1       0.1       1.8522943]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.958644 eV²/Å²
Max force error: 319.165740 eV²/Å²
Mean predicted force magnitude: 0.594944 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6380.215820
  Optimized ep_scale: [0.19332097 0.1        0.1        0.614581  ]
  Optimized sig_scale: [0.6103276 0.1       0.1       1.8522943]

[Iteration 18] LJ optimization complete
  Final loss: 6380.215820
  ep_scale: [0.19332097 0.1        0.1        0.614581  ]
  sig_scale: [0.6103276 0.1       0.1       1.8522943]

[Iteration 18] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.1331726312637329
  Initial mm_switch_on: 6.866916179656982
  Initial mm_cutoff: 1.2498066425323486
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4066.893311
    ml_cutoff: 0.1281 (grad: 3.197673e+02)
    mm_switch_on: 6.8720 (grad: -6.632870e+02)
    mm_cutoff: 1.2549 (grad: -2.782014e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.795821 eV²/Å²
Max force error: 1.963037 eV²/Å²
Mean predicted force magnitude: 0.343680 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4028.333984
    ml_cutoff: 0.1000 (grad: 6.816814e+01)
    mm_switch_on: 6.9174 (grad: -5.217726e+02)
    mm_cutoff: 1.3006 (grad: -2.513912e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.793315 eV²/Å²
Max force error: 1.963065 eV²/Å²
Mean predicted force magnitude: 0.348518 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4028.333984
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 6.9174
  Optimized mm_cutoff: 1.3006

[Iteration 18] Cutoff optimization complete
  Final loss: 4028.333984
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=6.917408466339111, mm_cutoff=1.3005938529968262)

[Iteration 18] Loss improvement: 0.010666

================================================================================
ITERATION 19/100
================================================================================

[Iteration 19] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=6.917408466339111, mm_cutoff=1.3005938529968262)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.19332097 0.1        0.1        0.614581  ]
  Initial sig_scale: [0.6103276 0.1       0.1       1.8522943]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6380.035645
    ep_scale: [0.18822101 0.1        0.1        0.60948104]
    sig_scale: [0.61542755 0.1        0.1        1.8573943 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.407196 eV²/Å²
Max force error: 336.510927 eV²/Å²
Mean predicted force magnitude: 0.607819 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6377.948730
    ep_scale: [0.14195743 0.1        0.1        0.56391275]
    sig_scale: [0.65112746 0.1        0.1        1.865046  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.169204 eV²/Å²
Max force error: 321.462440 eV²/Å²
Mean predicted force magnitude: 0.603713 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6377.948730
  Optimized ep_scale: [0.14195743 0.1        0.1        0.56391275]
  Optimized sig_scale: [0.65112746 0.1        0.1        1.865046  ]

[Iteration 19] LJ optimization complete
  Final loss: 6377.948730
  ep_scale: [0.14195743 0.1        0.1        0.56391275]
  sig_scale: [0.65112746 0.1        0.1        1.865046  ]

[Iteration 19] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 6.917408466339111
  Initial mm_cutoff: 1.3005938529968262
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 4025.971191
    ml_cutoff: 0.1000 (grad: 6.435339e+01)
    mm_switch_on: 6.9225 (grad: -5.084101e+02)
    mm_cutoff: 1.3057 (grad: -2.563236e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.793130 eV²/Å²
Max force error: 1.963068 eV²/Å²
Mean predicted force magnitude: 0.348910 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 4001.452393
    ml_cutoff: 0.1000 (grad: 7.042599e+01)
    mm_switch_on: 6.9686 (grad: -5.846501e+02)
    mm_cutoff: 1.3515 (grad: -2.428490e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.791354 eV²/Å²
Max force error: 1.963096 eV²/Å²
Mean predicted force magnitude: 0.352133 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 4001.452393
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 6.9686
  Optimized mm_cutoff: 1.3515

[Iteration 19] Cutoff optimization complete
  Final loss: 4001.452393
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=6.968623161315918, mm_cutoff=1.3514831066131592)

[Iteration 19] Loss improvement: 0.006673

================================================================================
ITERATION 20/100
================================================================================

[Iteration 20] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=6.968623161315918, mm_cutoff=1.3514831066131592)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.14195743 0.1        0.1        0.56391275]
  Initial sig_scale: [0.65112746 0.1        0.1        1.865046  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6377.688477
    ep_scale: [0.13685746 0.1        0.1        0.5588128 ]
    sig_scale: [0.6562274 0.1       0.1       1.870146 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.579586 eV²/Å²
Max force error: 337.797588 eV²/Å²
Mean predicted force magnitude: 0.615211 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6375.512207
    ep_scale: [0.1       0.1       0.1       0.5135937]
    sig_scale: [0.6890751 0.1       0.1       1.881833 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.460996 eV²/Å²
Max force error: 332.786524 eV²/Å²
Mean predicted force magnitude: 0.612866 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6375.512207
  Optimized ep_scale: [0.1       0.1       0.1       0.5135937]
  Optimized sig_scale: [0.6890751 0.1       0.1       1.881833 ]

[Iteration 20] LJ optimization complete
  Final loss: 6375.512207
  ep_scale: [0.1       0.1       0.1       0.5135937]
  sig_scale: [0.6890751 0.1       0.1       1.881833 ]

[Iteration 20] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 6.968623161315918
  Initial mm_cutoff: 1.3514831066131592
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3998.659912
    ml_cutoff: 0.1000 (grad: 7.195415e+01)
    mm_switch_on: 6.9737 (grad: -5.981568e+02)
    mm_cutoff: 1.3566 (grad: -2.534736e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.791119 eV²/Å²
Max force error: 1.963099 eV²/Å²
Mean predicted force magnitude: 0.352355 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3970.048584
    ml_cutoff: 0.1000 (grad: 7.756702e+01)
    mm_switch_on: 7.0197 (grad: -6.489798e+02)
    mm_cutoff: 1.4024 (grad: -2.456741e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.788743 eV²/Å²
Max force error: 1.963123 eV²/Å²
Mean predicted force magnitude: 0.356238 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3970.048584
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.0197
  Optimized mm_cutoff: 1.4024

[Iteration 20] Cutoff optimization complete
  Final loss: 3970.048584
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.019728660583496, mm_cutoff=1.4024267196655273)

[Iteration 20] Loss improvement: 0.007848

================================================================================
ITERATION 21/100
================================================================================

[Iteration 21] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.019728660583496, mm_cutoff=1.4024267196655273)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1       0.1       0.1       0.5135937]
  Initial sig_scale: [0.6890751 0.1       0.1       1.881833 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6375.348145
    ep_scale: [0.1       0.1       0.1       0.5084937]
    sig_scale: [0.69417506 0.1        0.1        1.876733  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.950546 eV²/Å²
Max force error: 307.473298 eV²/Å²
Mean predicted force magnitude: 0.600037 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6374.181152
    ep_scale: [0.1        0.1        0.1        0.46344388]
    sig_scale: [0.68724924 0.1        0.1        1.8946594 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.300570 eV²/Å²
Max force error: 322.185674 eV²/Å²
Mean predicted force magnitude: 0.609950 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6374.181152
  Optimized ep_scale: [0.1        0.1        0.1        0.46344388]
  Optimized sig_scale: [0.68724924 0.1        0.1        1.8946594 ]

[Iteration 21] LJ optimization complete
  Final loss: 6374.181152
  ep_scale: [0.1        0.1        0.1        0.46344388]
  sig_scale: [0.68724924 0.1        0.1        1.8946594 ]

[Iteration 21] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.019728660583496
  Initial mm_cutoff: 1.4024267196655273
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3967.677246
    ml_cutoff: 0.1000 (grad: 7.823220e+01)
    mm_switch_on: 7.0248 (grad: -6.669850e+02)
    mm_cutoff: 1.4075 (grad: -2.411842e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.789091 eV²/Å²
Max force error: 1.963126 eV²/Å²
Mean predicted force magnitude: 0.359900 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3936.908691
    ml_cutoff: 0.1000 (grad: 8.108860e+01)
    mm_switch_on: 7.0707 (grad: -6.228848e+02)
    mm_cutoff: 1.4534 (grad: -2.322389e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.786389 eV²/Å²
Max force error: 1.963148 eV²/Å²
Mean predicted force magnitude: 0.364063 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3936.908691
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.0707
  Optimized mm_cutoff: 1.4534

[Iteration 21] Cutoff optimization complete
  Final loss: 3936.908691
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.070651531219482, mm_cutoff=1.4533668756484985)

[Iteration 21] Loss improvement: 0.008347

================================================================================
ITERATION 22/100
================================================================================

[Iteration 22] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.070651531219482, mm_cutoff=1.4533668756484985)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.46344388]
  Initial sig_scale: [0.68724924 0.1        0.1        1.8946594 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6374.043457
    ep_scale: [0.1        0.1        0.1        0.45834392]
    sig_scale: [0.6923492 0.1       0.1       1.8997594]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.794072 eV²/Å²
Max force error: 338.416168 eV²/Å²
Mean predicted force magnitude: 0.624483 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6372.837402
    ep_scale: [0.1        0.1        0.1        0.41396856]
    sig_scale: [0.6838582 0.1       0.1       1.912817 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.484502 eV²/Å²
Max force error: 326.398761 eV²/Å²
Mean predicted force magnitude: 0.616246 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6372.837402
  Optimized ep_scale: [0.1        0.1        0.1        0.41396856]
  Optimized sig_scale: [0.6838582 0.1       0.1       1.912817 ]

[Iteration 22] LJ optimization complete
  Final loss: 6372.837402
  ep_scale: [0.1        0.1        0.1        0.41396856]
  sig_scale: [0.6838582 0.1       0.1       1.912817 ]

[Iteration 22] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.070651531219482
  Initial mm_cutoff: 1.4533668756484985
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3933.928955
    ml_cutoff: 0.1000 (grad: 8.066977e+01)
    mm_switch_on: 7.0758 (grad: -6.159600e+02)
    mm_cutoff: 1.4585 (grad: -2.358786e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.785874 eV²/Å²
Max force error: 1.963150 eV²/Å²
Mean predicted force magnitude: 0.363439 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3907.976074
    ml_cutoff: 0.1000 (grad: 6.521619e+01)
    mm_switch_on: 7.1213 (grad: -5.550726e+02)
    mm_cutoff: 1.5042 (grad: -2.154750e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.784199 eV²/Å²
Max force error: 1.963170 eV²/Å²
Mean predicted force magnitude: 0.367171 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3907.976074
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.1213
  Optimized mm_cutoff: 1.5042

[Iteration 22] Cutoff optimization complete
  Final loss: 3907.976074
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.121338367462158, mm_cutoff=1.5041974782943726)

[Iteration 22] Loss improvement: 0.007349

================================================================================
ITERATION 23/100
================================================================================

[Iteration 23] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.121338367462158, mm_cutoff=1.5041974782943726)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.41396856]
  Initial sig_scale: [0.6838582 0.1       0.1       1.912817 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6372.634277
    ep_scale: [0.1       0.1       0.1       0.4088686]
    sig_scale: [0.67875826 0.1        0.1        1.907717  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.714046 eV²/Å²
Max force error: 297.421526 eV²/Å²
Mean predicted force magnitude: 0.594075 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6371.375000
    ep_scale: [0.1        0.1        0.1        0.36505216]
    sig_scale: [0.67359024 0.1        0.1        1.9294719 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.162851 eV²/Å²
Max force error: 313.784221 eV²/Å²
Mean predicted force magnitude: 0.607595 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6371.375000
  Optimized ep_scale: [0.1        0.1        0.1        0.36505216]
  Optimized sig_scale: [0.67359024 0.1        0.1        1.9294719 ]

[Iteration 23] LJ optimization complete
  Final loss: 6371.375000
  ep_scale: [0.1        0.1        0.1        0.36505216]
  sig_scale: [0.67359024 0.1        0.1        1.9294719 ]

[Iteration 23] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.121338367462158
  Initial mm_cutoff: 1.5041974782943726
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3905.822266
    ml_cutoff: 0.1000 (grad: 6.766915e+01)
    mm_switch_on: 7.1264 (grad: -5.685702e+02)
    mm_cutoff: 1.5093 (grad: -2.087951e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.785012 eV²/Å²
Max force error: 1.963172 eV²/Å²
Mean predicted force magnitude: 0.370044 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3877.923096
    ml_cutoff: 0.1000 (grad: 7.670368e+01)
    mm_switch_on: 7.1725 (grad: -6.302698e+02)
    mm_cutoff: 1.5550 (grad: -1.865325e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.782987 eV²/Å²
Max force error: 1.963197 eV²/Å²
Mean predicted force magnitude: 0.373858 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3877.923096
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.1725
  Optimized mm_cutoff: 1.5550

[Iteration 23] Cutoff optimization complete
  Final loss: 3877.923096
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.1725077629089355, mm_cutoff=1.5549819469451904)

[Iteration 23] Loss improvement: 0.007690

================================================================================
ITERATION 24/100
================================================================================

[Iteration 24] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.1725077629089355, mm_cutoff=1.5549819469451904)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.36505216]
  Initial sig_scale: [0.67359024 0.1        0.1        1.9294719 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6371.310059
    ep_scale: [0.1       0.1       0.1       0.3599522]
    sig_scale: [0.6786902 0.1       0.1       1.9345719]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.597925 eV²/Å²
Max force error: 327.333910 eV²/Å²
Mean predicted force magnitude: 0.620712 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6369.819824
    ep_scale: [0.1       0.1       0.1       0.3142593]
    sig_scale: [0.6587519 0.1       0.1       1.9580773]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.541911 eV²/Å²
Max force error: 331.786285 eV²/Å²
Mean predicted force magnitude: 0.617708 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6369.819824
  Optimized ep_scale: [0.1       0.1       0.1       0.3142593]
  Optimized sig_scale: [0.6587519 0.1       0.1       1.9580773]

[Iteration 24] LJ optimization complete
  Final loss: 6369.819824
  ep_scale: [0.1       0.1       0.1       0.3142593]
  sig_scale: [0.6587519 0.1       0.1       1.9580773]

[Iteration 24] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.1725077629089355
  Initial mm_cutoff: 1.5549819469451904
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3874.892334
    ml_cutoff: 0.1000 (grad: 7.751973e+01)
    mm_switch_on: 7.1776 (grad: -6.344481e+02)
    mm_cutoff: 1.5601 (grad: -1.955311e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 2
Mean force error (MSE): 0.782562 eV²/Å²
Max force error: 1.963200 eV²/Å²
Mean predicted force magnitude: 0.374191 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3844.966797
    ml_cutoff: 0.1000 (grad: 8.167175e+01)
    mm_switch_on: 7.2236 (grad: -6.747734e+02)
    mm_cutoff: 1.6058 (grad: -1.737238e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.780172 eV²/Å²
Max force error: 1.963233 eV²/Å²
Mean predicted force magnitude: 0.377557 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3844.966797
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.2236
  Optimized mm_cutoff: 1.6058

[Iteration 24] Cutoff optimization complete
  Final loss: 3844.966797
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.223584175109863, mm_cutoff=1.6057506799697876)

[Iteration 24] Loss improvement: 0.008498

================================================================================
ITERATION 25/100
================================================================================

[Iteration 25] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.223584175109863, mm_cutoff=1.6057506799697876)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1       0.1       0.1       0.3142593]
  Initial sig_scale: [0.6587519 0.1       0.1       1.9580773]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6369.650391
    ep_scale: [0.1        0.1        0.1        0.30915934]
    sig_scale: [0.65365195 0.1        0.1        1.9529773 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 8.728528 eV²/Å²
Max force error: 300.577047 eV²/Å²
Mean predicted force magnitude: 0.594464 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6368.265625
    ep_scale: [0.1       0.1       0.1       0.2670219]
    sig_scale: [0.65691197 0.1        0.1        1.9785944 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.260599 eV²/Å²
Max force error: 312.849975 eV²/Å²
Mean predicted force magnitude: 0.612433 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6368.265625
  Optimized ep_scale: [0.1       0.1       0.1       0.2670219]
  Optimized sig_scale: [0.65691197 0.1        0.1        1.9785944 ]

[Iteration 25] LJ optimization complete
  Final loss: 6368.265625
  ep_scale: [0.1       0.1       0.1       0.2670219]
  sig_scale: [0.65691197 0.1        0.1        1.9785944 ]

[Iteration 25] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.223584175109863
  Initial mm_cutoff: 1.6057506799697876
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3841.475098
    ml_cutoff: 0.1000 (grad: 8.246288e+01)
    mm_switch_on: 7.2287 (grad: -6.808073e+02)
    mm_cutoff: 1.6109 (grad: -1.661484e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.779965 eV²/Å²
Max force error: 1.963237 eV²/Å²
Mean predicted force magnitude: 0.377970 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3809.563232
    ml_cutoff: 0.1000 (grad: 8.643999e+01)
    mm_switch_on: 7.2746 (grad: -6.847147e+02)
    mm_cutoff: 1.6565 (grad: -1.467109e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.777362 eV²/Å²
Max force error: 1.963279 eV²/Å²
Mean predicted force magnitude: 0.381652 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3809.563232
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.2746
  Optimized mm_cutoff: 1.6565

[Iteration 25] Cutoff optimization complete
  Final loss: 3809.563232
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.274587154388428, mm_cutoff=1.656509518623352)

[Iteration 25] Loss improvement: 0.009208

================================================================================
ITERATION 26/100
================================================================================

[Iteration 26] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.274587154388428, mm_cutoff=1.656509518623352)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1       0.1       0.1       0.2670219]
  Initial sig_scale: [0.65691197 0.1        0.1        1.9785944 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6368.050781
    ep_scale: [0.1        0.1        0.1        0.26192194]
    sig_scale: [0.651812  0.1       0.1       1.9836944]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.356809 eV²/Å²
Max force error: 319.200533 eV²/Å²
Mean predicted force magnitude: 0.614487 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6366.203125
    ep_scale: [0.1        0.1        0.1        0.21554244]
    sig_scale: [0.6339918 0.1       0.1       2.0173876]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.464942 eV²/Å²
Max force error: 325.121742 eV²/Å²
Mean predicted force magnitude: 0.617486 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6366.203125
  Optimized ep_scale: [0.1        0.1        0.1        0.21554244]
  Optimized sig_scale: [0.6339918 0.1       0.1       2.0173876]

[Iteration 26] LJ optimization complete
  Final loss: 6366.203125
  ep_scale: [0.1        0.1        0.1        0.21554244]
  sig_scale: [0.6339918 0.1       0.1       2.0173876]

[Iteration 26] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.274587154388428
  Initial mm_cutoff: 1.656509518623352
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3806.761230
    ml_cutoff: 0.1000 (grad: 8.597505e+01)
    mm_switch_on: 7.2797 (grad: -6.815750e+02)
    mm_cutoff: 1.6616 (grad: -1.525667e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.779609 eV²/Å²
Max force error: 1.963285 eV²/Å²
Mean predicted force magnitude: 0.386337 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3775.991211
    ml_cutoff: 0.1000 (grad: 8.096097e+01)
    mm_switch_on: 7.3255 (grad: -6.512885e+02)
    mm_cutoff: 1.7073 (grad: -1.354720e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.777154 eV²/Å²
Max force error: 1.963335 eV²/Å²
Mean predicted force magnitude: 0.390483 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3775.991211
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.3255
  Optimized mm_cutoff: 1.7073

[Iteration 26] Cutoff optimization complete
  Final loss: 3775.991211
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.325483322143555, mm_cutoff=1.7072794437408447)

[Iteration 26] Loss improvement: 0.008813

================================================================================
ITERATION 27/100
================================================================================

[Iteration 27] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.325483322143555, mm_cutoff=1.7072794437408447)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.21554244]
  Initial sig_scale: [0.6339918 0.1       0.1       2.0173876]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6366.067383
    ep_scale: [0.1        0.1        0.1        0.21044247]
    sig_scale: [0.6288918 0.1       0.1       2.0224876]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.495183 eV²/Å²
Max force error: 328.475181 eV²/Å²
Mean predicted force magnitude: 0.617772 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6364.085449
    ep_scale: [0.1        0.1        0.1        0.16500193]
    sig_scale: [0.6157713 0.1       0.1       2.0619972]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.547028 eV²/Å²
Max force error: 325.822232 eV²/Å²
Mean predicted force magnitude: 0.621001 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6364.085449
  Optimized ep_scale: [0.1        0.1        0.1        0.16500193]
  Optimized sig_scale: [0.6157713 0.1       0.1       2.0619972]

[Iteration 27] LJ optimization complete
  Final loss: 6364.085449
  ep_scale: [0.1        0.1        0.1        0.16500193]
  sig_scale: [0.6157713 0.1       0.1       2.0619972]

[Iteration 27] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.325483322143555
  Initial mm_cutoff: 1.7072794437408447
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3772.850098
    ml_cutoff: 0.1000 (grad: 8.093375e+01)
    mm_switch_on: 7.3306 (grad: -6.467894e+02)
    mm_cutoff: 1.7124 (grad: -1.371517e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.774819 eV²/Å²
Max force error: 1.963341 eV²/Å²
Mean predicted force magnitude: 0.387017 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3743.419434
    ml_cutoff: 0.1000 (grad: 7.738817e+01)
    mm_switch_on: 7.3764 (grad: -6.684187e+02)
    mm_cutoff: 1.7580 (grad: -1.181334e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.772737 eV²/Å²
Max force error: 1.963399 eV²/Å²
Mean predicted force magnitude: 0.390931 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3743.419434
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.3764
  Optimized mm_cutoff: 1.7580

[Iteration 27] Cutoff optimization complete
  Final loss: 3743.419434
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.376441478729248, mm_cutoff=1.757995843887329)

[Iteration 27] Loss improvement: 0.008626

================================================================================
ITERATION 28/100
================================================================================

[Iteration 28] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.376441478729248, mm_cutoff=1.757995843887329)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.16500193]
  Initial sig_scale: [0.6157713 0.1       0.1       2.0619972]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6363.835938
    ep_scale: [0.1        0.1        0.1        0.15990196]
    sig_scale: [0.61067134 0.1        0.1        2.0670972 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.465871 eV²/Å²
Max force error: 324.155434 eV²/Å²
Mean predicted force magnitude: 0.618399 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6361.774902
    ep_scale: [0.1        0.1        0.1        0.11860584]
    sig_scale: [0.59623075 0.1        0.1        2.1137018 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.311905 eV²/Å²
Max force error: 310.474171 eV²/Å²
Mean predicted force magnitude: 0.616647 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6361.774902
  Optimized ep_scale: [0.1        0.1        0.1        0.11860584]
  Optimized sig_scale: [0.59623075 0.1        0.1        2.1137018 ]

[Iteration 28] LJ optimization complete
  Final loss: 6361.774902
  ep_scale: [0.1        0.1        0.1        0.11860584]
  sig_scale: [0.59623075 0.1        0.1        2.1137018 ]

[Iteration 28] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.376441478729248
  Initial mm_cutoff: 1.757995843887329
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3745.019287
    ml_cutoff: 0.1000 (grad: 7.854284e+01)
    mm_switch_on: 7.3815 (grad: -6.814133e+02)
    mm_cutoff: 1.7631 (grad: -1.138308e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.805544 eV²/Å²
Max force error: 2.716963 eV²/Å²
Mean predicted force magnitude: 0.426058 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3709.622803
    ml_cutoff: 0.1000 (grad: 1.019532e+02)
    mm_switch_on: 7.4278 (grad: -8.176870e+02)
    mm_cutoff: 1.8086 (grad: -9.556379e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.812166 eV²/Å²
Max force error: 3.531328 eV²/Å²
Mean predicted force magnitude: 0.435725 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3709.622803
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.4278
  Optimized mm_cutoff: 1.8086

[Iteration 28] Cutoff optimization complete
  Final loss: 3709.622803
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.42779541015625, mm_cutoff=1.8086447715759277)

[Iteration 28] Loss improvement: 0.009028

================================================================================
ITERATION 29/100
================================================================================

[Iteration 29] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.42779541015625, mm_cutoff=1.8086447715759277)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1        0.1        0.1        0.11860584]
  Initial sig_scale: [0.59623075 0.1        0.1        2.1137018 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6361.531738
    ep_scale: [0.1        0.1        0.1        0.11350587]
    sig_scale: [0.5911308 0.1       0.1       2.1188018]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.059720 eV²/Å²
Max force error: 301.237783 eV²/Å²
Mean predicted force magnitude: 0.609435 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.281738
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5753389 0.1       0.1       2.1520717]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.933983 eV²/Å²
Max force error: 339.112301 eV²/Å²
Mean predicted force magnitude: 0.632974 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.281738
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5753389 0.1       0.1       2.1520717]

[Iteration 29] LJ optimization complete
  Final loss: 6360.281738
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5753389 0.1       0.1       2.1520717]

[Iteration 29] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.42779541015625
  Initial mm_cutoff: 1.8086447715759277
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3705.328613
    ml_cutoff: 0.1000 (grad: 1.028049e+02)
    mm_switch_on: 7.4329 (grad: -8.234053e+02)
    mm_cutoff: 1.8137 (grad: -1.028654e+00)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.770095 eV²/Å²
Max force error: 1.963485 eV²/Å²
Mean predicted force magnitude: 0.399172 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3668.158691
    ml_cutoff: 0.1000 (grad: 9.948003e+01)
    mm_switch_on: 7.4787 (grad: -7.846685e+02)
    mm_cutoff: 1.8593 (grad: -8.657808e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 6
Mean force error (MSE): 0.767100 eV²/Å²
Max force error: 1.963571 eV²/Å²
Mean predicted force magnitude: 0.404552 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3668.158691
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.4787
  Optimized mm_cutoff: 1.8593

[Iteration 29] Cutoff optimization complete
  Final loss: 3668.158691
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.478724956512451, mm_cutoff=1.859304428100586)

[Iteration 29] Loss improvement: 0.011177

================================================================================
ITERATION 30/100
================================================================================

[Iteration 30] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.478724956512451, mm_cutoff=1.859304428100586)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5753389 0.1       0.1       2.1520717]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.244141
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.57023895 0.1        0.1        2.1469717 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.346184 eV²/Å²
Max force error: 318.771669 eV²/Å²
Mean predicted force magnitude: 0.616050 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.231445
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55543464 0.1        0.1        2.153915  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.626007 eV²/Å²
Max force error: 339.592735 eV²/Å²
Mean predicted force magnitude: 0.620983 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.211426
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56560284 0.1        0.1        2.1562855 ]

[Iteration 30] LJ optimization complete
  Final loss: 6360.231445
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56560284 0.1        0.1        2.1562855 ]

[Iteration 30] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.478724956512451
  Initial mm_cutoff: 1.859304428100586
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3664.250732
    ml_cutoff: 0.1000 (grad: 9.741537e+01)
    mm_switch_on: 7.4838 (grad: -7.662408e+02)
    mm_cutoff: 1.8644 (grad: -8.774287e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.766773 eV²/Å²
Max force error: 1.963582 eV²/Å²
Mean predicted force magnitude: 0.404945 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3631.447510
    ml_cutoff: 0.1000 (grad: 8.430956e+01)
    mm_switch_on: 7.5295 (grad: -7.029656e+02)
    mm_cutoff: 1.9099 (grad: -7.066936e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.764316 eV²/Å²
Max force error: 1.954259 eV²/Å²
Mean predicted force magnitude: 0.409334 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3631.447510
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.5295
  Optimized mm_cutoff: 1.9099

[Iteration 30] Cutoff optimization complete
  Final loss: 3631.447510
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.529492378234863, mm_cutoff=1.9098806381225586)

[Iteration 30] Loss improvement: 0.010008

================================================================================
ITERATION 31/100
================================================================================

[Iteration 31] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.529492378234863, mm_cutoff=1.9098806381225586)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56560284 0.1        0.1        2.1562855 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.294922
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5605029 0.1       0.1       2.1511855]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.494674 eV²/Å²
Max force error: 330.979377 eV²/Å²
Mean predicted force magnitude: 0.618375 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.275879
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5615461 0.1       0.1       2.152586 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.645612 eV²/Å²
Max force error: 336.516047 eV²/Å²
Mean predicted force magnitude: 0.622677 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.263672
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5617656 0.1       0.1       2.1528568]

[Iteration 31] LJ optimization complete
  Final loss: 6360.275879
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5617656 0.1       0.1       2.1528568]

[Iteration 31] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.529492378234863
  Initial mm_cutoff: 1.9098806381225586
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3627.826416
    ml_cutoff: 0.1000 (grad: 8.457452e+01)
    mm_switch_on: 7.5346 (grad: -7.146802e+02)
    mm_cutoff: 1.9150 (grad: -6.580041e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.764064 eV²/Å²
Max force error: 1.951413 eV²/Å²
Mean predicted force magnitude: 0.409800 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3592.848145
    ml_cutoff: 0.1000 (grad: 9.982730e+01)
    mm_switch_on: 7.5807 (grad: -7.663183e+02)
    mm_cutoff: 1.9603 (grad: -5.039293e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.761505 eV²/Å²
Max force error: 1.926279 eV²/Å²
Mean predicted force magnitude: 0.413833 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3592.848145
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.5807
  Optimized mm_cutoff: 1.9603

[Iteration 31] Cutoff optimization complete
  Final loss: 3592.848145
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.580681800842285, mm_cutoff=1.9603312015533447)

[Iteration 31] Loss improvement: 0.010629

================================================================================
ITERATION 32/100
================================================================================

[Iteration 32] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.580681800842285, mm_cutoff=1.9603312015533447)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5617656 0.1       0.1       2.1528568]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.249023
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56686556 0.1        0.1        2.1579568 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.282274 eV²/Å²
Max force error: 359.038372 eV²/Å²
Mean predicted force magnitude: 0.640653 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.266113
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56456095 0.1        0.1        2.1554341 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.982429 eV²/Å²
Max force error: 348.348639 eV²/Å²
Mean predicted force magnitude: 0.632292 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.245117
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56487817 0.1        0.1        2.1557636 ]

[Iteration 32] LJ optimization complete
  Final loss: 6360.266113
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56487817 0.1        0.1        2.1557636 ]

[Iteration 32] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.580681800842285
  Initial mm_cutoff: 1.9603312015533447
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3589.289307
    ml_cutoff: 0.1000 (grad: 9.945187e+01)
    mm_switch_on: 7.5858 (grad: -7.552301e+02)
    mm_cutoff: 1.9654 (grad: -5.092450e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.761199 eV²/Å²
Max force error: 1.924912 eV²/Å²
Mean predicted force magnitude: 0.414956 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3558.979004
    ml_cutoff: 0.1000 (grad: 7.561892e+01)
    mm_switch_on: 7.6311 (grad: -6.134943e+02)
    mm_cutoff: 2.0107 (grad: -3.748868e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.758954 eV²/Å²
Max force error: 1.923708 eV²/Å²
Mean predicted force magnitude: 0.418873 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3558.979004
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.6311
  Optimized mm_cutoff: 2.0107

[Iteration 32] Cutoff optimization complete
  Final loss: 3558.979004
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.631140232086182, mm_cutoff=2.0107030868530273)

[Iteration 32] Loss improvement: 0.009427

================================================================================
ITERATION 33/100
================================================================================

[Iteration 33] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.631140232086182, mm_cutoff=2.0107030868530273)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56487817 0.1        0.1        2.1557636 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.250488
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597782 0.1       0.1       2.1506636]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431425 eV²/Å²
Max force error: 328.833762 eV²/Å²
Mean predicted force magnitude: 0.616509 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.244629
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619708 0.1       0.1       2.1529133]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685530 eV²/Å²
Max force error: 337.881581 eV²/Å²
Mean predicted force magnitude: 0.623838 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.233887
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56503433 0.1        0.1        2.1559772 ]

[Iteration 33] LJ optimization complete
  Final loss: 6360.244629
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56503433 0.1        0.1        2.1559772 ]

[Iteration 33] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.631140232086182
  Initial mm_cutoff: 2.0107030868530273
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3556.199951
    ml_cutoff: 0.1000 (grad: 7.476768e+01)
    mm_switch_on: 7.6362 (grad: -6.137340e+02)
    mm_cutoff: 2.0158 (grad: -3.622921e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.760567 eV²/Å²
Max force error: 1.923716 eV²/Å²
Mean predicted force magnitude: 0.422232 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3526.954346
    ml_cutoff: 0.1000 (grad: 8.128875e+01)
    mm_switch_on: 7.6823 (grad: -6.337044e+02)
    mm_cutoff: 2.0609 (grad: -2.505383e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.758348 eV²/Å²
Max force error: 1.923848 eV²/Å²
Mean predicted force magnitude: 0.425870 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3526.954346
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.6823
  Optimized mm_cutoff: 2.0609

[Iteration 33] Cutoff optimization complete
  Final loss: 3526.954346
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.682261943817139, mm_cutoff=2.060927391052246)

[Iteration 33] Loss improvement: 0.008998

================================================================================
ITERATION 34/100
================================================================================

[Iteration 34] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.682261943817139, mm_cutoff=2.060927391052246)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56503433 0.1        0.1        2.1559772 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.274902
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599344 0.1       0.1       2.1508772]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.454057 eV²/Å²
Max force error: 329.666712 eV²/Å²
Mean predicted force magnitude: 0.617158 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.264648
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619082 0.1       0.1       2.1528268]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676118 eV²/Å²
Max force error: 337.535691 eV²/Å²
Mean predicted force magnitude: 0.623571 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.252930
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482154 0.1        0.1        2.1557763 ]

[Iteration 34] LJ optimization complete
  Final loss: 6360.264648
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482154 0.1        0.1        2.1557763 ]

[Iteration 34] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.682261943817139
  Initial mm_cutoff: 2.060927391052246
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3523.762451
    ml_cutoff: 0.1000 (grad: 8.183288e+01)
    mm_switch_on: 7.6874 (grad: -6.252608e+02)
    mm_cutoff: 2.0660 (grad: -2.378269e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.756642 eV²/Å²
Max force error: 1.923866 eV²/Å²
Mean predicted force magnitude: 0.423992 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3497.696777
    ml_cutoff: 0.1000 (grad: 6.626054e+01)
    mm_switch_on: 7.7329 (grad: -5.434440e+02)
    mm_cutoff: 2.1107 (grad: -1.322228e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.754557 eV²/Å²
Max force error: 1.907985 eV²/Å²
Mean predicted force magnitude: 0.427521 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3497.696777
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.7329
  Optimized mm_cutoff: 2.1107

[Iteration 34] Cutoff optimization complete
  Final loss: 3497.696777
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.732895851135254, mm_cutoff=2.1106808185577393)

[Iteration 34] Loss improvement: 0.008295

================================================================================
ITERATION 35/100
================================================================================

[Iteration 35] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.732895851135254, mm_cutoff=2.1106808185577393)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482154 0.1        0.1        2.1557763 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.232910
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597216 0.1       0.1       2.1506763]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431267 eV²/Å²
Max force error: 328.862456 eV²/Å²
Mean predicted force magnitude: 0.616494 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.226074
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56199014 0.1        0.1        2.1529105 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685714 eV²/Å²
Max force error: 337.876706 eV²/Å²
Mean predicted force magnitude: 0.623846 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.216309
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56503075 0.1        0.1        2.155983  ]

[Iteration 35] LJ optimization complete
  Final loss: 6360.226074
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56503075 0.1        0.1        2.155983  ]

[Iteration 35] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.732895851135254
  Initial mm_cutoff: 2.1106808185577393
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3494.942383
    ml_cutoff: 0.1000 (grad: 6.573098e+01)
    mm_switch_on: 7.7380 (grad: -5.523646e+02)
    mm_cutoff: 2.1158 (grad: -1.215087e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.754258 eV²/Å²
Max force error: 1.904875 eV²/Å²
Mean predicted force magnitude: 0.428001 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3467.801025
    ml_cutoff: 0.1000 (grad: 7.690071e+01)
    mm_switch_on: 7.7841 (grad: -6.292189e+02)
    mm_cutoff: 2.1579 (grad: -1.916169e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.752355 eV²/Å²
Max force error: 1.885224 eV²/Å²
Mean predicted force magnitude: 0.432577 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3467.801025
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.7841
  Optimized mm_cutoff: 2.1579

[Iteration 35] Cutoff optimization complete
  Final loss: 3467.801025
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.784118175506592, mm_cutoff=2.1578567028045654)

[Iteration 35] Loss improvement: 0.008547

================================================================================
ITERATION 36/100
================================================================================

[Iteration 36] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.784118175506592, mm_cutoff=2.1578567028045654)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56503075 0.1        0.1        2.155983  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.270020
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599308 0.1       0.1       2.150883 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.454482 eV²/Å²
Max force error: 329.686494 eV²/Å²
Mean predicted force magnitude: 0.617169 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.258789
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619158 0.1       0.1       2.1528225]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.675906 eV²/Å²
Max force error: 337.522303 eV²/Å²
Mean predicted force magnitude: 0.623567 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.248535
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482226 0.1        0.1        2.1557717 ]

[Iteration 36] LJ optimization complete
  Final loss: 6360.258789
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482226 0.1        0.1        2.1557717 ]

[Iteration 36] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.784118175506592
  Initial mm_cutoff: 2.1578567028045654
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3464.527588
    ml_cutoff: 0.1000 (grad: 7.741367e+01)
    mm_switch_on: 7.7892 (grad: -6.408192e+02)
    mm_cutoff: 2.1630 (grad: -8.609767e-03)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 9
Mean force error (MSE): 0.752143 eV²/Å²
Max force error: 1.885028 eV²/Å²
Mean predicted force magnitude: 0.433038 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3433.840332
    ml_cutoff: 0.1000 (grad: 8.441404e+01)
    mm_switch_on: 7.8352 (grad: -6.544311e+02)
    mm_cutoff: 2.1351 (grad: 4.493131e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 11
Mean force error (MSE): 0.749896 eV²/Å²
Max force error: 1.885088 eV²/Å²
Mean predicted force magnitude: 0.438459 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3433.840332
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.8352
  Optimized mm_cutoff: 2.1351

[Iteration 36] Cutoff optimization complete
  Final loss: 3433.840332
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.835198402404785, mm_cutoff=2.135096788406372)

[Iteration 36] Loss improvement: 0.009793

================================================================================
ITERATION 37/100
================================================================================

[Iteration 37] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.835198402404785, mm_cutoff=2.135096788406372)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482226 0.1        0.1        2.1557717 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.247070
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597223 0.1       0.1       2.1506717]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.430884 eV²/Å²
Max force error: 328.846444 eV²/Å²
Mean predicted force magnitude: 0.616484 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.242188
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619977 0.1       0.1       2.1529057]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685452 eV²/Å²
Max force error: 337.861107 eV²/Å²
Mean predicted force magnitude: 0.623841 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.231934
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56138265 0.1        0.1        2.1523063 ]

[Iteration 37] LJ optimization complete
  Final loss: 6360.242188
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56138265 0.1        0.1        2.1523063 ]

[Iteration 37] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.835198402404785
  Initial mm_cutoff: 2.135096788406372
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3430.486816
    ml_cutoff: 0.1000 (grad: 8.507318e+01)
    mm_switch_on: 7.8403 (grad: -6.551849e+02)
    mm_cutoff: 2.1300 (grad: 5.884962e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 11
Mean force error (MSE): 0.749515 eV²/Å²
Max force error: 1.885092 eV²/Å²
Mean predicted force magnitude: 0.438955 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3399.614990
    ml_cutoff: 0.1000 (grad: 8.196576e+01)
    mm_switch_on: 7.8863 (grad: -7.027305e+02)
    mm_cutoff: 2.0835 (grad: 8.646460e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 11
Mean force error (MSE): 0.747232 eV²/Å²
Max force error: 1.885132 eV²/Å²
Mean predicted force magnitude: 0.443749 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3399.614990
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.8863
  Optimized mm_cutoff: 2.0835

[Iteration 37] Cutoff optimization complete
  Final loss: 3399.614990
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.886297225952148, mm_cutoff=2.0835165977478027)

[Iteration 37] Loss improvement: 0.009967

================================================================================
ITERATION 38/100
================================================================================

[Iteration 38] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.886297225952148, mm_cutoff=2.0835165977478027)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56138265 0.1        0.1        2.1523063 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.207031
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5664826 0.1       0.1       2.1574063]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.219041 eV²/Å²
Max force error: 356.720204 eV²/Å²
Mean predicted force magnitude: 0.638919 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.209473
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5639986 0.1       0.1       2.154937 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.921848 eV²/Å²
Max force error: 346.242942 eV²/Å²
Mean predicted force magnitude: 0.630570 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.197266
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5637275 0.1       0.1       2.1546853]

[Iteration 38] LJ optimization complete
  Final loss: 6360.209473
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5637275 0.1       0.1       2.1546853]

[Iteration 38] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.886297225952148
  Initial mm_cutoff: 2.0835165977478027
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3395.940674
    ml_cutoff: 0.1000 (grad: 8.507514e+01)
    mm_switch_on: 7.8914 (grad: -7.329543e+02)
    mm_cutoff: 2.0784 (grad: 8.249459e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 11
Mean force error (MSE): 0.746998 eV²/Å²
Max force error: 1.885137 eV²/Å²
Mean predicted force magnitude: 0.444193 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3356.829102
    ml_cutoff: 0.1000 (grad: 1.093947e+02)
    mm_switch_on: 7.9377 (grad: -9.064662e+02)
    mm_cutoff: 2.0321 (grad: 1.032170e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 17
Mean force error (MSE): 0.743914 eV²/Å²
Max force error: 1.885180 eV²/Å²
Mean predicted force magnitude: 0.449746 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3356.829102
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.9377
  Optimized mm_cutoff: 2.0321

[Iteration 38] Cutoff optimization complete
  Final loss: 3356.829102
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.937681674957275, mm_cutoff=2.032148838043213)

[Iteration 38] Loss improvement: 0.012586

================================================================================
ITERATION 39/100
================================================================================

[Iteration 39] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.937681674957275, mm_cutoff=2.032148838043213)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5637275 0.1       0.1       2.1546853]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.241211
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55862755 0.1        0.1        2.1495852 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.310010 eV²/Å²
Max force error: 324.550210 eV²/Å²
Mean predicted force magnitude: 0.612955 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.262695
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5613026 0.1       0.1       2.152251 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609423 eV²/Å²
Max force error: 335.186218 eV²/Å²
Mean predicted force magnitude: 0.621650 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.241211
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.55862755 0.1        0.1        2.1495852 ]

[Iteration 39] LJ optimization complete
  Final loss: 6360.262695
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.55862755 0.1        0.1        2.1495852 ]

[Iteration 39] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.937681674957275
  Initial mm_cutoff: 2.032148838043213
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3352.111084
    ml_cutoff: 0.1000 (grad: 1.108682e+02)
    mm_switch_on: 7.9428 (grad: -9.084137e+02)
    mm_cutoff: 2.0270 (grad: 1.181049e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 17
Mean force error (MSE): 0.743514 eV²/Å²
Max force error: 1.885185 eV²/Å²
Mean predicted force magnitude: 0.450467 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3314.292236
    ml_cutoff: 0.1000 (grad: 9.328211e+01)
    mm_switch_on: 7.9882 (grad: -7.034153e+02)
    mm_cutoff: 1.9808 (grad: 1.450821e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 23
Mean force error (MSE): 0.740441 eV²/Å²
Max force error: 1.885228 eV²/Å²
Mean predicted force magnitude: 0.455601 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3314.292236
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 7.9882
  Optimized mm_cutoff: 1.9808

[Iteration 39] Cutoff optimization complete
  Final loss: 3314.292236
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.988231182098389, mm_cutoff=1.980817198753357)

[Iteration 39] Loss improvement: 0.012672

================================================================================
ITERATION 40/100
================================================================================

[Iteration 40] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=7.988231182098389, mm_cutoff=1.980817198753357)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.55862755 0.1        0.1        2.1495852 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.326172
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5637275 0.1       0.1       2.1546853]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.891645 eV²/Å²
Max force error: 345.185454 eV²/Å²
Mean predicted force magnitude: 0.629712 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.241699
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5635048 0.1       0.1       2.1544735]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.866464 eV²/Å²
Max force error: 344.300733 eV²/Å²
Mean predicted force magnitude: 0.628996 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.241699
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5635048 0.1       0.1       2.1544735]

[Iteration 40] LJ optimization complete
  Final loss: 6360.241699
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5635048 0.1       0.1       2.1544735]

[Iteration 40] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 7.988231182098389
  Initial mm_cutoff: 1.980817198753357
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3310.865234
    ml_cutoff: 0.1000 (grad: 9.018314e+01)
    mm_switch_on: 7.9933 (grad: -6.844954e+02)
    mm_cutoff: 1.9757 (grad: 1.375952e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 31
Mean force error (MSE): 0.740241 eV²/Å²
Max force error: 1.885233 eV²/Å²
Mean predicted force magnitude: 0.456232 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3281.627930
    ml_cutoff: 0.1000 (grad: 7.898425e+01)
    mm_switch_on: 8.0390 (grad: -6.360867e+02)
    mm_cutoff: 1.9295 (grad: 1.679552e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 31
Mean force error (MSE): 0.738292 eV²/Å²
Max force error: 1.885278 eV²/Å²
Mean predicted force magnitude: 0.460457 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3281.627930
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.0390
  Optimized mm_cutoff: 1.9295

[Iteration 40] Cutoff optimization complete
  Final loss: 3281.627930
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.039015769958496, mm_cutoff=1.9294832944869995)

[Iteration 40] Loss improvement: 0.009856

================================================================================
ITERATION 41/100
================================================================================

[Iteration 41] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.039015769958496, mm_cutoff=1.9294832944869995)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5635048 0.1       0.1       2.1544735]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.233398
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55840486 0.1        0.1        2.1493735 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.286458 eV²/Å²
Max force error: 323.716895 eV²/Å²
Mean predicted force magnitude: 0.612263 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.259766
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5610268 0.1       0.1       2.1520007]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.580288 eV²/Å²
Max force error: 334.165444 eV²/Å²
Mean predicted force magnitude: 0.620807 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.233398
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.55840486 0.1        0.1        2.1493735 ]

[Iteration 41] LJ optimization complete
  Final loss: 6360.259766
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.55840486 0.1        0.1        2.1493735 ]

[Iteration 41] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.039015769958496
  Initial mm_cutoff: 1.9294832944869995
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3278.407471
    ml_cutoff: 0.1000 (grad: 8.024263e+01)
    mm_switch_on: 8.0441 (grad: -6.297501e+02)
    mm_cutoff: 1.9244 (grad: 1.811322e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 31
Mean force error (MSE): 0.738069 eV²/Å²
Max force error: 1.885274 eV²/Å²
Mean predicted force magnitude: 0.461093 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3252.979492
    ml_cutoff: 0.1000 (grad: 6.462560e+01)
    mm_switch_on: 8.0895 (grad: -4.849771e+02)
    mm_cutoff: 1.8783 (grad: 2.051311e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.736861 eV²/Å²
Max force error: 1.885330 eV²/Å²
Mean predicted force magnitude: 0.464832 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3252.979492
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.0895
  Optimized mm_cutoff: 1.8783

[Iteration 41] Cutoff optimization complete
  Final loss: 3252.979492
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.089456558227539, mm_cutoff=1.878264307975769)

[Iteration 41] Loss improvement: 0.008730

================================================================================
ITERATION 42/100
================================================================================

[Iteration 42] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.089456558227539, mm_cutoff=1.878264307975769)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.55840486 0.1        0.1        2.1493735 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.302734
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5635048 0.1       0.1       2.1544735]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.866463 eV²/Å²
Max force error: 344.300712 eV²/Å²
Mean predicted force magnitude: 0.628996 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.211914
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5631596 0.1       0.1       2.1541271]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.825851 eV²/Å²
Max force error: 342.863670 eV²/Å²
Mean predicted force magnitude: 0.627842 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.208496
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56637466 0.1        0.1        2.1573343 ]

[Iteration 42] LJ optimization complete
  Final loss: 6360.211914
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56637466 0.1        0.1        2.1573343 ]

[Iteration 42] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.089456558227539
  Initial mm_cutoff: 1.878264307975769
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3251.753906
    ml_cutoff: 0.1000 (grad: 6.156588e+01)
    mm_switch_on: 8.0946 (grad: -4.723932e+02)
    mm_cutoff: 1.8732 (grad: 1.921746e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.746671 eV²/Å²
Max force error: 1.885336 eV²/Å²
Mean predicted force magnitude: 0.478499 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3225.691406
    ml_cutoff: 0.1000 (grad: 7.929428e+01)
    mm_switch_on: 8.1410 (grad: -7.301387e+02)
    mm_cutoff: 1.8271 (grad: 2.093006e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.745040 eV²/Å²
Max force error: 1.885388 eV²/Å²
Mean predicted force magnitude: 0.482717 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3225.691406
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.1410
  Optimized mm_cutoff: 1.8271

[Iteration 42] Cutoff optimization complete
  Final loss: 3225.691406
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.14102554321289, mm_cutoff=1.8271132707595825)

[Iteration 42] Loss improvement: 0.008389

================================================================================
ITERATION 43/100
================================================================================

[Iteration 43] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.14102554321289, mm_cutoff=1.8271132707595825)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56637466 0.1        0.1        2.1573343 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.298828
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5612747 0.1       0.1       2.1522343]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.607254 eV²/Å²
Max force error: 335.114707 eV²/Å²
Mean predicted force magnitude: 0.621586 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.239258
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5614967 0.1       0.1       2.152431 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.630318 eV²/Å²
Max force error: 335.920075 eV²/Å²
Mean predicted force magnitude: 0.622254 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.237793
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5644682 0.1       0.1       2.1554537]

[Iteration 43] LJ optimization complete
  Final loss: 6360.239258
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5644682 0.1       0.1       2.1554537]

[Iteration 43] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.14102554321289
  Initial mm_cutoff: 1.8271132707595825
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3221.830322
    ml_cutoff: 0.1000 (grad: 8.506388e+01)
    mm_switch_on: 8.1461 (grad: -7.699672e+02)
    mm_cutoff: 1.8220 (grad: 2.145031e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.737749 eV²/Å²
Max force error: 1.885393 eV²/Å²
Mean predicted force magnitude: 0.473493 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3179.032715
    ml_cutoff: 0.1000 (grad: 1.240278e+02)
    mm_switch_on: 8.1925 (grad: -1.018078e+03)
    mm_cutoff: 1.7760 (grad: 2.329457e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.733900 eV²/Å²
Max force error: 1.885447 eV²/Å²
Mean predicted force magnitude: 0.479042 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3179.032715
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.1925
  Optimized mm_cutoff: 1.7760

[Iteration 43] Cutoff optimization complete
  Final loss: 3179.032715
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.192508697509766, mm_cutoff=1.775976300239563)

[Iteration 43] Loss improvement: 0.014465

================================================================================
ITERATION 44/100
================================================================================

[Iteration 44] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.192508697509766, mm_cutoff=1.775976300239563)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5644682 0.1       0.1       2.1554537]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.230957
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55936825 0.1        0.1        2.1503537 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.394561 eV²/Å²
Max force error: 327.572754 eV²/Å²
Mean predicted force magnitude: 0.615421 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.233398
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619905 0.1       0.1       2.1528876]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.683620 eV²/Å²
Max force error: 337.790558 eV²/Å²
Mean predicted force magnitude: 0.623790 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.220215
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56205595 0.1        0.1        2.1529725 ]

[Iteration 44] LJ optimization complete
  Final loss: 6360.233398
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56205595 0.1        0.1        2.1529725 ]

[Iteration 44] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.192508697509766
  Initial mm_cutoff: 1.775976300239563
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3174.546875
    ml_cutoff: 0.1000 (grad: 1.245486e+02)
    mm_switch_on: 8.1976 (grad: -1.014746e+03)
    mm_cutoff: 1.7709 (grad: 2.392522e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.733865 eV²/Å²
Max force error: 1.885453 eV²/Å²
Mean predicted force magnitude: 0.481253 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3132.022217
    ml_cutoff: 0.1000 (grad: 1.082192e+02)
    mm_switch_on: 8.2431 (grad: -7.707491e+02)
    mm_cutoff: 1.7248 (grad: 2.679446e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.730925 eV²/Å²
Max force error: 1.885506 eV²/Å²
Mean predicted force magnitude: 0.487425 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3132.022217
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.2431
  Optimized mm_cutoff: 1.7248

[Iteration 44] Cutoff optimization complete
  Final loss: 3132.022217
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.243067741394043, mm_cutoff=1.724780559539795)

[Iteration 44] Loss improvement: 0.014788

================================================================================
ITERATION 45/100
================================================================================

[Iteration 45] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.243067741394043, mm_cutoff=1.724780559539795)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56205595 0.1        0.1        2.1529725 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.251953
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5671559 0.1       0.1       2.1580725]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.300955 eV²/Å²
Max force error: 359.599918 eV²/Å²
Mean predicted force magnitude: 0.641198 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.275391
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5646524 0.1       0.1       2.1556456]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.004715 eV²/Å²
Max force error: 349.199341 eV²/Å²
Mean predicted force magnitude: 0.632903 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.250977
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5647942 0.1       0.1       2.1557949]

[Iteration 45] LJ optimization complete
  Final loss: 6360.275391
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5647942 0.1       0.1       2.1557949]

[Iteration 45] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.243067741394043
  Initial mm_cutoff: 1.724780559539795
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3129.038086
    ml_cutoff: 0.1000 (grad: 1.020357e+02)
    mm_switch_on: 8.2482 (grad: -7.436827e+02)
    mm_cutoff: 1.7197 (grad: 2.679153e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.736456 eV²/Å²
Max force error: 1.885512 eV²/Å²
Mean predicted force magnitude: 0.498092 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3097.186279
    ml_cutoff: 0.1000 (grad: 8.362167e+01)
    mm_switch_on: 8.2939 (grad: -7.053923e+02)
    mm_cutoff: 1.6736 (grad: 2.905583e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.735161 eV²/Å²
Max force error: 1.885568 eV²/Å²
Mean predicted force magnitude: 0.503197 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3097.186279
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.2939
  Optimized mm_cutoff: 1.6736

[Iteration 45] Cutoff optimization complete
  Final loss: 3097.186279
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.293856620788574, mm_cutoff=1.6736313104629517)

[Iteration 45] Loss improvement: 0.011123

================================================================================
ITERATION 46/100
================================================================================

[Iteration 46] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.293856620788574, mm_cutoff=1.6736313104629517)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5647942 0.1       0.1       2.1557949]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.223633
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55969423 0.1        0.1        2.1506948 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432311 eV²/Å²
Max force error: 328.922551 eV²/Å²
Mean predicted force magnitude: 0.616518 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.218750
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56201375 0.1        0.1        2.1529    ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685300 eV²/Å²
Max force error: 337.844612 eV²/Å²
Mean predicted force magnitude: 0.623839 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.207520
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5614124 0.1       0.1       2.1523092]

[Iteration 46] LJ optimization complete
  Final loss: 6360.218750
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5614124 0.1       0.1       2.1523092]

[Iteration 46] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.293856620788574
  Initial mm_cutoff: 1.6736313104629517
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3094.162842
    ml_cutoff: 0.1000 (grad: 8.560544e+01)
    mm_switch_on: 8.2990 (grad: -7.196196e+02)
    mm_cutoff: 1.6685 (grad: 2.963701e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.729033 eV²/Å²
Max force error: 1.885563 eV²/Å²
Mean predicted force magnitude: 0.495019 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3058.036865
    ml_cutoff: 0.1000 (grad: 9.705835e+01)
    mm_switch_on: 8.3451 (grad: -8.163541e+02)
    mm_cutoff: 1.6225 (grad: 3.157732e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.726657 eV²/Å²
Max force error: 1.885634 eV²/Å²
Mean predicted force magnitude: 0.500455 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3058.036865
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.3451
  Optimized mm_cutoff: 1.6225

[Iteration 46] Cutoff optimization complete
  Final loss: 3058.036865
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.34510326385498, mm_cutoff=1.6225214004516602)

[Iteration 46] Loss improvement: 0.012640

================================================================================
ITERATION 47/100
================================================================================

[Iteration 47] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.34510326385498, mm_cutoff=1.6225214004516602)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5614124 0.1       0.1       2.1523092]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.239746
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56651235 0.1        0.1        2.1574092 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.220061 eV²/Å²
Max force error: 356.741527 eV²/Å²
Mean predicted force magnitude: 0.638951 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.244141
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5639889 0.1       0.1       2.1549463]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.922484 eV²/Å²
Max force error: 346.275320 eV²/Å²
Mean predicted force magnitude: 0.630586 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.230469
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5646542 0.1       0.1       2.1556294]

[Iteration 47] LJ optimization complete
  Final loss: 6360.244141
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5646542 0.1       0.1       2.1556294]

[Iteration 47] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.34510326385498
  Initial mm_cutoff: 1.6225214004516602
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3054.560791
    ml_cutoff: 0.1000 (grad: 9.981143e+01)
    mm_switch_on: 8.3502 (grad: -8.290546e+02)
    mm_cutoff: 1.6174 (grad: 3.164276e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.727629 eV²/Å²
Max force error: 1.885640 eV²/Å²
Mean predicted force magnitude: 0.501646 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 3017.815186
    ml_cutoff: 0.1000 (grad: 9.621312e+01)
    mm_switch_on: 8.3959 (grad: -7.504492e+02)
    mm_cutoff: 1.5714 (grad: 3.387359e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.725292 eV²/Å²
Max force error: 1.885708 eV²/Å²
Mean predicted force magnitude: 0.507690 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 3017.815186
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.3959
  Optimized mm_cutoff: 1.5714

[Iteration 47] Cutoff optimization complete
  Final loss: 3017.815186
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.395920753479004, mm_cutoff=1.5713986158370972)

[Iteration 47] Loss improvement: 0.013153

================================================================================
ITERATION 48/100
================================================================================

[Iteration 48] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.395920753479004, mm_cutoff=1.5713986158370972)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5646542 0.1       0.1       2.1556294]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.237793
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5595542 0.1       0.1       2.1505294]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.414385 eV²/Å²
Max force error: 328.272643 eV²/Å²
Mean predicted force magnitude: 0.616000 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235352
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5620129 0.1       0.1       2.1529214]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.687251 eV²/Å²
Max force error: 337.925010 eV²/Å²
Mean predicted force magnitude: 0.623892 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.224121
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56215996 0.1        0.1        2.1530895 ]

[Iteration 48] LJ optimization complete
  Final loss: 6360.235352
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56215996 0.1        0.1        2.1530895 ]

[Iteration 48] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.395920753479004
  Initial mm_cutoff: 1.5713986158370972
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 3014.059082
    ml_cutoff: 0.1000 (grad: 9.466245e+01)
    mm_switch_on: 8.4010 (grad: -7.446888e+02)
    mm_cutoff: 1.5663 (grad: 3.428492e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.724852 eV²/Å²
Max force error: 1.885706 eV²/Å²
Mean predicted force magnitude: 0.508092 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2978.639893
    ml_cutoff: 0.1000 (grad: 1.002206e+02)
    mm_switch_on: 8.4471 (grad: -8.354065e+02)
    mm_cutoff: 1.5203 (grad: 3.540899e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.722238 eV²/Å²
Max force error: 1.885768 eV²/Å²
Mean predicted force magnitude: 0.513966 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2978.639893
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.4471
  Optimized mm_cutoff: 1.5203

[Iteration 48] Cutoff optimization complete
  Final loss: 2978.639893
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.447093963623047, mm_cutoff=1.5203375816345215)

[Iteration 48] Loss improvement: 0.012981

================================================================================
ITERATION 49/100
================================================================================

[Iteration 49] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.447093963623047, mm_cutoff=1.5203375816345215)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56215996 0.1        0.1        2.1530895 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.237793
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5672599 0.1       0.1       2.1581895]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.315064 eV²/Å²
Max force error: 360.103389 eV²/Å²
Mean predicted force magnitude: 0.641587 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.264160
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56481135 0.1        0.1        2.1557813 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.021483 eV²/Å²
Max force error: 349.778836 eV²/Å²
Mean predicted force magnitude: 0.633379 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.237305
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56480354 0.1        0.1        2.1557803 ]

[Iteration 49] LJ optimization complete
  Final loss: 6360.264160
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56480354 0.1        0.1        2.1557803 ]

[Iteration 49] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.447093963623047
  Initial mm_cutoff: 1.5203375816345215
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2974.688965
    ml_cutoff: 0.1000 (grad: 1.032166e+02)
    mm_switch_on: 8.4522 (grad: -8.368752e+02)
    mm_cutoff: 1.5152 (grad: 3.540625e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.727924 eV²/Å²
Max force error: 1.885775 eV²/Å²
Mean predicted force magnitude: 0.522878 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2939.202881
    ml_cutoff: 0.1000 (grad: 9.234995e+01)
    mm_switch_on: 8.4978 (grad: -7.115535e+02)
    mm_cutoff: 1.4693 (grad: 3.646845e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 38
Mean force error (MSE): 0.725913 eV²/Å²
Max force error: 1.885937 eV²/Å²
Mean predicted force magnitude: 0.528282 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2939.202881
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.4978
  Optimized mm_cutoff: 1.4693

[Iteration 49] Cutoff optimization complete
  Final loss: 2939.202881
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.497767448425293, mm_cutoff=1.4692860841751099)

[Iteration 49] Loss improvement: 0.013240

================================================================================
ITERATION 50/100
================================================================================

[Iteration 50] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.497767448425293, mm_cutoff=1.4692860841751099)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56480354 0.1        0.1        2.1557803 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.241211
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597036 0.1       0.1       2.1506803]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431221 eV²/Å²
Max force error: 328.872057 eV²/Å²
Mean predicted force magnitude: 0.616490 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235840
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56200325 0.1        0.1        2.1529052 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685545 eV²/Å²
Max force error: 337.861263 eV²/Å²
Mean predicted force magnitude: 0.623844 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.224121
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.565033 0.1      0.1      2.15598 ]

[Iteration 50] LJ optimization complete
  Final loss: 6360.235840
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.565033 0.1      0.1      2.15598 ]

[Iteration 50] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.497767448425293
  Initial mm_cutoff: 1.4692860841751099
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2935.743652
    ml_cutoff: 0.1000 (grad: 8.851955e+01)
    mm_switch_on: 8.5029 (grad: -6.886948e+02)
    mm_cutoff: 1.4642 (grad: 3.662969e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.719495 eV²/Å²
Max force error: 1.885842 eV²/Å²
Mean predicted force magnitude: 0.520987 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2905.181396
    ml_cutoff: 0.1000 (grad: 8.583257e+01)
    mm_switch_on: 8.5487 (grad: -6.846793e+02)
    mm_cutoff: 1.4183 (grad: 3.720584e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.717296 eV²/Å²
Max force error: 1.885904 eV²/Å²
Mean predicted force magnitude: 0.525692 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2905.181396
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.5487
  Optimized mm_cutoff: 1.4183

[Iteration 50] Cutoff optimization complete
  Final loss: 2905.181396
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.54869556427002, mm_cutoff=1.418254017829895)

[Iteration 50] Loss improvement: 0.011575

================================================================================
ITERATION 51/100
================================================================================

[Iteration 51] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.54869556427002, mm_cutoff=1.418254017829895)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.565033 0.1      0.1      2.15598 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.231445
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55993307 0.1        0.1        2.15088   ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.454276 eV²/Å²
Max force error: 329.676674 eV²/Å²
Mean predicted force magnitude: 0.617164 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.219727
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56191105 0.1        0.1        2.152825  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676036 eV²/Å²
Max force error: 337.530536 eV²/Å²
Mean predicted force magnitude: 0.623570 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.207031
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648215 0.1       0.1       2.1557746]

[Iteration 51] LJ optimization complete
  Final loss: 6360.219727
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648215 0.1       0.1       2.1557746]

[Iteration 51] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.54869556427002
  Initial mm_cutoff: 1.418254017829895
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2901.676025
    ml_cutoff: 0.1000 (grad: 8.564540e+01)
    mm_switch_on: 8.5538 (grad: -6.912767e+02)
    mm_cutoff: 1.4132 (grad: 3.724740e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.716993 eV²/Å²
Max force error: 1.885911 eV²/Å²
Mean predicted force magnitude: 0.526283 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2865.497314
    ml_cutoff: 0.1000 (grad: 1.056005e+02)
    mm_switch_on: 8.6001 (grad: -8.959229e+02)
    mm_cutoff: 1.3672 (grad: 3.776526e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.714568 eV²/Å²
Max force error: 1.872887 eV²/Å²
Mean predicted force magnitude: 0.531997 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2865.497314
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.6001
  Optimized mm_cutoff: 1.3672

[Iteration 51] Cutoff optimization complete
  Final loss: 2865.497314
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.600116729736328, mm_cutoff=1.3672330379486084)

[Iteration 51] Loss improvement: 0.013660

================================================================================
ITERATION 52/100
================================================================================

[Iteration 52] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.600116729736328, mm_cutoff=1.3672330379486084)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648215 0.1       0.1       2.1557746]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.220703
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597215 0.1       0.1       2.1506746]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431126 eV²/Å²
Max force error: 328.856968 eV²/Å²
Mean predicted force magnitude: 0.616490 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.217773
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619899 0.1       0.1       2.1529095]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685610 eV²/Å²
Max force error: 337.872718 eV²/Å²
Mean predicted force magnitude: 0.623843 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.205566
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650312 0.1       0.1       2.1559823]

[Iteration 52] LJ optimization complete
  Final loss: 6360.217773
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650312 0.1       0.1       2.1559823]

[Iteration 52] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.600116729736328
  Initial mm_cutoff: 1.3672330379486084
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2860.779053
    ml_cutoff: 0.1000 (grad: 1.095474e+02)
    mm_switch_on: 8.6052 (grad: -9.149974e+02)
    mm_cutoff: 1.3621 (grad: 3.785737e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.714144 eV²/Å²
Max force error: 1.870042 eV²/Å²
Mean predicted force magnitude: 0.532548 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2817.777588
    ml_cutoff: 0.1000 (grad: 1.152796e+02)
    mm_switch_on: 8.6511 (grad: -9.031096e+02)
    mm_cutoff: 1.3162 (grad: 3.893250e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.710552 eV²/Å²
Max force error: 1.840202 eV²/Å²
Mean predicted force magnitude: 0.539473 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2817.777588
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.6511
  Optimized mm_cutoff: 1.3162

[Iteration 52] Cutoff optimization complete
  Final loss: 2817.777588
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.651137351989746, mm_cutoff=1.3161828517913818)

[Iteration 52] Loss improvement: 0.016653

================================================================================
ITERATION 53/100
================================================================================

[Iteration 53] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.651137351989746, mm_cutoff=1.3161828517913818)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650312 0.1       0.1       2.1559823]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.249512
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599312 0.1       0.1       2.1508822]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.454430 eV²/Å²
Max force error: 329.684081 eV²/Å²
Mean predicted force magnitude: 0.617168 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.239258
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56192017 0.1        0.1        2.1528192 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.675691 eV²/Å²
Max force error: 337.510442 eV²/Å²
Mean predicted force magnitude: 0.623562 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.227051
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482434 0.1        0.1        2.1557686 ]

[Iteration 53] LJ optimization complete
  Final loss: 6360.239258
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482434 0.1        0.1        2.1557686 ]

[Iteration 53] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.651137351989746
  Initial mm_cutoff: 1.3161828517913818
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2813.469727
    ml_cutoff: 0.1000 (grad: 1.130945e+02)
    mm_switch_on: 8.6562 (grad: -8.945408e+02)
    mm_cutoff: 1.3111 (grad: 3.910246e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.727343 eV²/Å²
Max force error: 2.047530 eV²/Å²
Mean predicted force magnitude: 0.556569 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2774.193359
    ml_cutoff: 0.1000 (grad: 1.038329e+02)
    mm_switch_on: 8.7020 (grad: -8.076077e+02)
    mm_cutoff: 1.2651 (grad: 3.981013e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.724940 eV²/Å²
Max force error: 2.138707 eV²/Å²
Mean predicted force magnitude: 0.562799 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2774.193359
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.7020
  Optimized mm_cutoff: 1.2651

[Iteration 53] Cutoff optimization complete
  Final loss: 2774.193359
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.701969146728516, mm_cutoff=1.2651467323303223)

[Iteration 53] Loss improvement: 0.015468

================================================================================
ITERATION 54/100
================================================================================

[Iteration 54] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.701969146728516, mm_cutoff=1.2651467323303223)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482434 0.1        0.1        2.1557686 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.262695
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597244 0.1       0.1       2.1506686]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.430656 eV²/Å²
Max force error: 328.835829 eV²/Å²
Mean predicted force magnitude: 0.616478 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.257324
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619878 0.1       0.1       2.152913 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685907 eV²/Å²
Max force error: 337.886161 eV²/Å²
Mean predicted force magnitude: 0.623851 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.246582
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5613673 0.1       0.1       2.15231  ]

[Iteration 54] LJ optimization complete
  Final loss: 6360.257324
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5613673 0.1       0.1       2.15231  ]

[Iteration 54] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.701969146728516
  Initial mm_cutoff: 1.2651467323303223
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2770.344482
    ml_cutoff: 0.1000 (grad: 1.021261e+02)
    mm_switch_on: 8.7071 (grad: -7.896559e+02)
    mm_cutoff: 1.2600 (grad: 3.997211e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 45
Mean force error (MSE): 0.707028 eV²/Å²
Max force error: 1.763290 eV²/Å²
Mean predicted force magnitude: 0.547521 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2736.729736
    ml_cutoff: 0.1000 (grad: 8.575969e+01)
    mm_switch_on: 8.7527 (grad: -6.826844e+02)
    mm_cutoff: 1.2141 (grad: 4.047071e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 49
Mean force error (MSE): 0.704773 eV²/Å²
Max force error: 1.743883 eV²/Å²
Mean predicted force magnitude: 0.552935 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2736.729736
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.7527
  Optimized mm_cutoff: 1.2141

[Iteration 54] Cutoff optimization complete
  Final loss: 2736.729736
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.752666473388672, mm_cutoff=1.214127540588379)

[Iteration 54] Loss improvement: 0.013504

================================================================================
ITERATION 55/100
================================================================================

[Iteration 55] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.752666473388672, mm_cutoff=1.214127540588379)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5613673 0.1       0.1       2.15231  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.284668
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5664672 0.1       0.1       2.15741  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.219011 eV²/Å²
Max force error: 356.729452 eV²/Å²
Mean predicted force magnitude: 0.638915 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.288086
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56401306 0.1        0.1        2.1549323 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.921742 eV²/Å²
Max force error: 346.229096 eV²/Å²
Mean predicted force magnitude: 0.630570 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.276367
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56374127 0.1        0.1        2.1546798 ]

[Iteration 55] LJ optimization complete
  Final loss: 6360.288086
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56374127 0.1        0.1        2.1546798 ]

[Iteration 55] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.752666473388672
  Initial mm_cutoff: 1.214127540588379
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2733.294678
    ml_cutoff: 0.1000 (grad: 8.578328e+01)
    mm_switch_on: 8.7578 (grad: -6.873306e+02)
    mm_cutoff: 1.2090 (grad: 4.049744e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 49
Mean force error (MSE): 0.704556 eV²/Å²
Max force error: 1.743889 eV²/Å²
Mean predicted force magnitude: 0.553527 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2700.705078
    ml_cutoff: 0.1000 (grad: 8.969365e+01)
    mm_switch_on: 8.8038 (grad: -7.629293e+02)
    mm_cutoff: 1.1631 (grad: 4.104013e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.702104 eV²/Å²
Max force error: 1.732143 eV²/Å²
Mean predicted force magnitude: 0.558886 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2700.705078
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.8038
  Optimized mm_cutoff: 1.1631

[Iteration 55] Cutoff optimization complete
  Final loss: 2700.705078
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.803776741027832, mm_cutoff=1.163102149963379)

[Iteration 55] Loss improvement: 0.013163

================================================================================
ITERATION 56/100
================================================================================

[Iteration 56] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.803776741027832, mm_cutoff=1.163102149963379)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56374127 0.1        0.1        2.1546798 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.212402
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5586413 0.1       0.1       2.1495798]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.309833 eV²/Å²
Max force error: 324.534360 eV²/Å²
Mean predicted force magnitude: 0.612953 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.233398
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56128997 0.1        0.1        2.1522522 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609226 eV²/Å²
Max force error: 335.186151 eV²/Å²
Mean predicted force magnitude: 0.621642 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.211914
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5619504 0.1       0.1       2.1529195]

[Iteration 56] LJ optimization complete
  Final loss: 6360.233398
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5619504 0.1       0.1       2.1529195]

[Iteration 56] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.803776741027832
  Initial mm_cutoff: 1.163102149963379
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2696.720947
    ml_cutoff: 0.1000 (grad: 9.104775e+01)
    mm_switch_on: 8.8089 (grad: -8.015560e+02)
    mm_cutoff: 1.1580 (grad: 4.112594e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.702326 eV²/Å²
Max force error: 1.727913 eV²/Å²
Mean predicted force magnitude: 0.561022 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2654.983154
    ml_cutoff: 0.1000 (grad: 1.180452e+02)
    mm_switch_on: 8.8550 (grad: -8.758117e+02)
    mm_cutoff: 1.1121 (grad: 4.049235e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.698761 eV²/Å²
Max force error: 1.684527 eV²/Å²
Mean predicted force magnitude: 0.566729 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2654.983154
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.8550
  Optimized mm_cutoff: 1.1121

[Iteration 56] Cutoff optimization complete
  Final loss: 2654.983154
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.8550443649292, mm_cutoff=1.1121246814727783)

[Iteration 56] Loss improvement: 0.016930

================================================================================
ITERATION 57/100
================================================================================

[Iteration 57] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.8550443649292, mm_cutoff=1.1121246814727783)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5619504 0.1       0.1       2.1529195]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.256836
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56705034 0.1        0.1        2.1580195 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.293087 eV²/Å²
Max force error: 359.352042 eV²/Å²
Mean predicted force magnitude: 0.640971 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.276367
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5646024 0.1       0.1       2.155559 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.995269 eV²/Å²
Max force error: 348.846406 eV²/Å²
Mean predicted force magnitude: 0.632642 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.255371
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648199 0.1       0.1       2.1557868]

[Iteration 57] LJ optimization complete
  Final loss: 6360.276367
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648199 0.1       0.1       2.1557868]

[Iteration 57] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.8550443649292
  Initial mm_cutoff: 1.1121246814727783
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2652.854248
    ml_cutoff: 0.1000 (grad: 1.173931e+02)
    mm_switch_on: 8.8601 (grad: -8.470480e+02)
    mm_cutoff: 1.1070 (grad: 4.019762e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.722216 eV²/Å²
Max force error: 3.360203 eV²/Å²
Mean predicted force magnitude: 0.584217 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2620.966797
    ml_cutoff: 0.1000 (grad: 7.039576e+01)
    mm_switch_on: 8.9052 (grad: -6.189080e+02)
    mm_cutoff: 1.0612 (grad: 3.931847e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.721867 eV²/Å²
Max force error: 3.519566 eV²/Å²
Mean predicted force magnitude: 0.589587 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2620.966797
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.9052
  Optimized mm_cutoff: 1.0612

[Iteration 57] Cutoff optimization complete
  Final loss: 2620.966797
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.905183792114258, mm_cutoff=1.0611741542816162)

[Iteration 57] Loss improvement: 0.012812

================================================================================
ITERATION 58/100
================================================================================

[Iteration 58] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.905183792114258, mm_cutoff=1.0611741542816162)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648199 0.1       0.1       2.1557868]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.204590
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597199 0.1       0.1       2.1506867]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432170 eV²/Å²
Max force error: 328.900792 eV²/Å²
Mean predicted force magnitude: 0.616519 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.197754
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619993 0.1       0.1       2.1529028]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685227 eV²/Å²
Max force error: 337.850869 eV²/Å²
Mean predicted force magnitude: 0.623835 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.187500
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5613948 0.1       0.1       2.1523128]

[Iteration 58] LJ optimization complete
  Final loss: 6360.197754
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5613948 0.1       0.1       2.1523128]

[Iteration 58] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.905183792114258
  Initial mm_cutoff: 1.0611741542816162
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2617.977539
    ml_cutoff: 0.1000 (grad: 7.256765e+01)
    mm_switch_on: 8.9103 (grad: -6.389873e+02)
    mm_cutoff: 1.0561 (grad: 3.937387e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 53
Mean force error (MSE): 0.700244 eV²/Å²
Max force error: 1.676305 eV²/Å²
Mean predicted force magnitude: 0.576589 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2583.885986
    ml_cutoff: 0.1000 (grad: 9.833598e+01)
    mm_switch_on: 8.9566 (grad: -7.958668e+02)
    mm_cutoff: 1.0102 (grad: 3.929067e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 59
Mean force error (MSE): 0.698319 eV²/Å²
Max force error: 1.676326 eV²/Å²
Mean predicted force magnitude: 0.581791 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2583.885986
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 8.9566
  Optimized mm_cutoff: 1.0102

[Iteration 58] Cutoff optimization complete
  Final loss: 2583.885986
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.956594467163086, mm_cutoff=1.0101780891418457)

[Iteration 58] Loss improvement: 0.014148

================================================================================
ITERATION 59/100
================================================================================

[Iteration 59] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=8.956594467163086, mm_cutoff=1.0101780891418457)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5613948 0.1       0.1       2.1523128]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.242188
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56649476 0.1        0.1        2.1574128 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.219973 eV²/Å²
Max force error: 356.749971 eV²/Å²
Mean predicted force magnitude: 0.638946 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.247559
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56398404 0.1        0.1        2.154947  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.922443 eV²/Å²
Max force error: 346.276833 eV²/Å²
Mean predicted force magnitude: 0.630584 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.233887
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5637074 0.1       0.1       2.1546893]

[Iteration 59] LJ optimization complete
  Final loss: 6360.247559
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5637074 0.1       0.1       2.1546893]

[Iteration 59] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 8.956594467163086
  Initial mm_cutoff: 1.0101780891418457
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2579.760742
    ml_cutoff: 0.1000 (grad: 9.912452e+01)
    mm_switch_on: 8.9617 (grad: -7.946082e+02)
    mm_cutoff: 1.0051 (grad: 3.925849e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 59
Mean force error (MSE): 0.697978 eV²/Å²
Max force error: 1.676374 eV²/Å²
Mean predicted force magnitude: 0.582437 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2544.291016
    ml_cutoff: 0.1000 (grad: 9.432595e+01)
    mm_switch_on: 9.0075 (grad: -7.491339e+02)
    mm_cutoff: 0.9592 (grad: 3.912449e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.695835 eV²/Å²
Max force error: 1.676089 eV²/Å²
Mean predicted force magnitude: 0.587689 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2544.291016
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.0075
  Optimized mm_cutoff: 0.9592

[Iteration 59] Cutoff optimization complete
  Final loss: 2544.291016
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.007473945617676, mm_cutoff=0.9591848850250244)

[Iteration 59] Loss improvement: 0.015324

================================================================================
ITERATION 60/100
================================================================================

[Iteration 60] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.007473945617676, mm_cutoff=0.9591848850250244)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5637074 0.1       0.1       2.1546893]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.276367
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55860746 0.1        0.1        2.1495893 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.309918 eV²/Å²
Max force error: 324.558850 eV²/Å²
Mean predicted force magnitude: 0.612949 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.296387
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5613189 0.1       0.1       2.1522455]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609302 eV²/Å²
Max force error: 335.170723 eV²/Å²
Mean predicted force magnitude: 0.621650 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.275391
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56197023 0.1        0.1        2.1529114 ]

[Iteration 60] LJ optimization complete
  Final loss: 6360.296387
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56197023 0.1        0.1        2.1529114 ]

[Iteration 60] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.007473945617676
  Initial mm_cutoff: 0.9591848850250244
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2540.502930
    ml_cutoff: 0.1000 (grad: 9.289426e+01)
    mm_switch_on: 9.0126 (grad: -7.435607e+02)
    mm_cutoff: 0.9541 (grad: 3.911677e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.695573 eV²/Å²
Max force error: 1.675427 eV²/Å²
Mean predicted force magnitude: 0.588306 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2505.174561
    ml_cutoff: 0.1000 (grad: 9.835982e+01)
    mm_switch_on: 9.0586 (grad: -8.333155e+02)
    mm_cutoff: 0.9082 (grad: 3.906623e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.693542 eV²/Å²
Max force error: 1.652707 eV²/Å²
Mean predicted force magnitude: 0.594103 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2505.174561
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.0586
  Optimized mm_cutoff: 0.9082

[Iteration 60] Cutoff optimization complete
  Final loss: 2505.174561
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.058633804321289, mm_cutoff=0.908189058303833)

[Iteration 60] Loss improvement: 0.015374

================================================================================
ITERATION 61/100
================================================================================

[Iteration 61] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.058633804321289, mm_cutoff=0.908189058303833)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56197023 0.1        0.1        2.1529114 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.252441
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5670702 0.1       0.1       2.1580114]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.292806 eV²/Å²
Max force error: 359.326768 eV²/Å²
Mean predicted force magnitude: 0.640968 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.272949
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5645866 0.1       0.1       2.15556  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.994974 eV²/Å²
Max force error: 348.844643 eV²/Å²
Mean predicted force magnitude: 0.632631 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.250977
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.564809  0.1       0.1       2.1557915]

[Iteration 61] LJ optimization complete
  Final loss: 6360.272949
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.564809  0.1       0.1       2.1557915]

[Iteration 61] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.058633804321289
  Initial mm_cutoff: 0.908189058303833
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2501.050537
    ml_cutoff: 0.1000 (grad: 1.006957e+02)
    mm_switch_on: 9.0637 (grad: -8.507082e+02)
    mm_cutoff: 0.9031 (grad: 3.903143e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.694300 eV²/Å²
Max force error: 1.648390 eV²/Å²
Mean predicted force magnitude: 0.595743 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2460.731445
    ml_cutoff: 0.1000 (grad: 1.119246e+02)
    mm_switch_on: 9.1097 (grad: -8.523783e+02)
    mm_cutoff: 0.8572 (grad: 3.897354e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.691457 eV²/Å²
Max force error: 1.624928 eV²/Å²
Mean predicted force magnitude: 0.602534 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2460.731445
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.1097
  Optimized mm_cutoff: 0.8572

[Iteration 61] Cutoff optimization complete
  Final loss: 2460.731445
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.109695434570312, mm_cutoff=0.8571881055831909)

[Iteration 61] Loss improvement: 0.017741

================================================================================
ITERATION 62/100
================================================================================

[Iteration 62] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.109695434570312, mm_cutoff=0.8571881055831909)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.564809  0.1       0.1       2.1557915]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.238770
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597091 0.1       0.1       2.1506915]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432344 eV²/Å²
Max force error: 328.915001 eV²/Å²
Mean predicted force magnitude: 0.616521 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.234375
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56200385 0.1        0.1        2.1529    ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685074 eV²/Å²
Max force error: 337.841560 eV²/Å²
Mean predicted force magnitude: 0.623832 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.222168
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650217 0.1       0.1       2.155968 ]

[Iteration 62] LJ optimization complete
  Final loss: 6360.234375
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650217 0.1       0.1       2.155968 ]

[Iteration 62] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.109695434570312
  Initial mm_cutoff: 0.8571881055831909
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2456.469971
    ml_cutoff: 0.1000 (grad: 1.092743e+02)
    mm_switch_on: 9.1148 (grad: -8.317202e+02)
    mm_cutoff: 0.8521 (grad: 3.891795e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 65
Mean force error (MSE): 0.691005 eV²/Å²
Max force error: 1.622862 eV²/Å²
Mean predicted force magnitude: 0.603267 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2420.473389
    ml_cutoff: 0.1000 (grad: 9.570957e+01)
    mm_switch_on: 9.1606 (grad: -8.291724e+02)
    mm_cutoff: 0.8062 (grad: 3.792682e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 68
Mean force error (MSE): 0.688856 eV²/Å²
Max force error: 1.606237 eV²/Å²
Mean predicted force magnitude: 0.610015 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2420.473389
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.1606
  Optimized mm_cutoff: 0.8062

[Iteration 62] Cutoff optimization complete
  Final loss: 2420.473389
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.16055965423584, mm_cutoff=0.806230366230011)

[Iteration 62] Loss improvement: 0.016360

================================================================================
ITERATION 63/100
================================================================================

[Iteration 63] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.16055965423584, mm_cutoff=0.806230366230011)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650217 0.1       0.1       2.155968 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.249512
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55992174 0.1        0.1        2.150868  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.452933 eV²/Å²
Max force error: 329.628497 eV²/Å²
Mean predicted force magnitude: 0.617125 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.239746
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.561916  0.1       0.1       2.1528323]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676813 eV²/Å²
Max force error: 337.559251 eV²/Å²
Mean predicted force magnitude: 0.623592 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.227539
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56483346 0.1        0.1        2.155787  ]

[Iteration 63] LJ optimization complete
  Final loss: 6360.239746
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56483346 0.1        0.1        2.155787  ]

[Iteration 63] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.16055965423584
  Initial mm_cutoff: 0.806230366230011
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2416.204590
    ml_cutoff: 0.1000 (grad: 9.792976e+01)
    mm_switch_on: 9.1657 (grad: -8.419669e+02)
    mm_cutoff: 0.8011 (grad: 3.776555e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 68
Mean force error (MSE): 0.688598 eV²/Å²
Max force error: 1.604554 eV²/Å²
Mean predicted force magnitude: 0.610617 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2376.253662
    ml_cutoff: 0.1000 (grad: 1.119981e+02)
    mm_switch_on: 9.2116 (grad: -8.476940e+02)
    mm_cutoff: 0.7553 (grad: 3.613824e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.685924 eV²/Å²
Max force error: 1.588411 eV²/Å²
Mean predicted force magnitude: 0.617114 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2376.253662
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.2116
  Optimized mm_cutoff: 0.7553

[Iteration 63] Cutoff optimization complete
  Final loss: 2376.253662
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.211624145507812, mm_cutoff=0.755312979221344)

[Iteration 63] Loss improvement: 0.018269

================================================================================
ITERATION 64/100
================================================================================

[Iteration 64] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.211624145507812, mm_cutoff=0.755312979221344)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56483346 0.1        0.1        2.155787  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.198242
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597335 0.1       0.1       2.150687 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432497 eV²/Å²
Max force error: 328.905759 eV²/Å²
Mean predicted force magnitude: 0.616530 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.190430
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619924 0.1       0.1       2.1529055]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685301 eV²/Å²
Max force error: 337.858166 eV²/Å²
Mean predicted force magnitude: 0.623836 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.180176
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5613887 0.1       0.1       2.1523175]

[Iteration 64] LJ optimization complete
  Final loss: 6360.190430
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5613887 0.1       0.1       2.1523175]

[Iteration 64] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.211624145507812
  Initial mm_cutoff: 0.755312979221344
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2371.952393
    ml_cutoff: 0.1000 (grad: 1.097081e+02)
    mm_switch_on: 9.2167 (grad: -8.380163e+02)
    mm_cutoff: 0.7502 (grad: 3.597038e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.685593 eV²/Å²
Max force error: 1.587223 eV²/Å²
Mean predicted force magnitude: 0.617612 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2333.902832
    ml_cutoff: 0.1000 (grad: 1.046713e+02)
    mm_switch_on: 9.2626 (grad: -8.427419e+02)
    mm_cutoff: 0.7044 (grad: 3.499055e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.682935 eV²/Å²
Max force error: 1.586056 eV²/Å²
Mean predicted force magnitude: 0.623662 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2333.902832
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.2626
  Optimized mm_cutoff: 0.7044

[Iteration 64] Cutoff optimization complete
  Final loss: 2333.902832
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.262625694274902, mm_cutoff=0.7043647170066833)

[Iteration 64] Loss improvement: 0.017823

================================================================================
ITERATION 65/100
================================================================================

[Iteration 65] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.262625694274902, mm_cutoff=0.7043647170066833)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5613887 0.1       0.1       2.1523175]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.250977
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5664886 0.1       0.1       2.1574175]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.220280 eV²/Å²
Max force error: 356.766439 eV²/Å²
Mean predicted force magnitude: 0.638953 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.256836
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5639882 0.1       0.1       2.1549473]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.922557 eV²/Å²
Max force error: 346.278654 eV²/Å²
Mean predicted force magnitude: 0.630587 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.242188
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56370914 0.1        0.1        2.1546872 ]

[Iteration 65] LJ optimization complete
  Final loss: 6360.256836
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56370914 0.1        0.1        2.1546872 ]

[Iteration 65] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.262625694274902
  Initial mm_cutoff: 0.7043647170066833
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2329.977783
    ml_cutoff: 0.1000 (grad: 1.055056e+02)
    mm_switch_on: 9.2677 (grad: -8.477745e+02)
    mm_cutoff: 0.6993 (grad: 3.490512e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.683744 eV²/Å²
Max force error: 1.586059 eV²/Å²
Mean predicted force magnitude: 0.626545 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2291.755859
    ml_cutoff: 0.1000 (grad: 9.926678e+01)
    mm_switch_on: 9.3135 (grad: -8.068687e+02)
    mm_cutoff: 0.6534 (grad: 3.420882e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.680890 eV²/Å²
Max force error: 1.616739 eV²/Å²
Mean predicted force magnitude: 0.632236 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2291.755859
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.3135
  Optimized mm_cutoff: 0.6534

[Iteration 65] Cutoff optimization complete
  Final loss: 2291.755859
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.313545227050781, mm_cutoff=0.6534053087234497)

[Iteration 65] Loss improvement: 0.018059

================================================================================
ITERATION 66/100
================================================================================

[Iteration 66] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.313545227050781, mm_cutoff=0.6534053087234497)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56370914 0.1        0.1        2.1546872 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.256836
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5586092 0.1       0.1       2.1495872]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.309776 eV²/Å²
Max force error: 324.551829 eV²/Å²
Mean predicted force magnitude: 0.612945 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.279297
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5613039 0.1       0.1       2.1522467]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609056 eV²/Å²
Max force error: 335.170139 eV²/Å²
Mean predicted force magnitude: 0.621640 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.256836
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5586092 0.1       0.1       2.1495872]

[Iteration 66] LJ optimization complete
  Final loss: 6360.279297
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5586092 0.1       0.1       2.1495872]

[Iteration 66] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.313545227050781
  Initial mm_cutoff: 0.6534053087234497
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2287.681152
    ml_cutoff: 0.1000 (grad: 9.893382e+01)
    mm_switch_on: 9.3186 (grad: -8.054366e+02)
    mm_cutoff: 0.6483 (grad: 3.413903e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.680160 eV²/Å²
Max force error: 1.619593 eV²/Å²
Mean predicted force magnitude: 0.632067 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2249.264893
    ml_cutoff: 0.1000 (grad: 1.045753e+02)
    mm_switch_on: 9.3646 (grad: -8.168026e+02)
    mm_cutoff: 0.6024 (grad: 3.386712e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.677252 eV²/Å²
Max force error: 1.644035 eV²/Å²
Mean predicted force magnitude: 0.638021 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2249.264893
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.3646
  Optimized mm_cutoff: 0.6024

[Iteration 66] Cutoff optimization complete
  Final loss: 2249.264893
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.364640235900879, mm_cutoff=0.6024208068847656)

[Iteration 66] Loss improvement: 0.018541

================================================================================
ITERATION 67/100
================================================================================

[Iteration 67] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.364640235900879, mm_cutoff=0.6024208068847656)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5586092 0.1       0.1       2.1495872]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.319824
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56370914 0.1        0.1        2.1546872 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.891393 eV²/Å²
Max force error: 345.187168 eV²/Å²
Mean predicted force magnitude: 0.629702 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235352
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5635247 0.1       0.1       2.154465 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.866138 eV²/Å²
Max force error: 344.274408 eV²/Å²
Mean predicted force magnitude: 0.628991 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.235352
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5635247 0.1       0.1       2.154465 ]

[Iteration 67] LJ optimization complete
  Final loss: 6360.235352
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5635247 0.1       0.1       2.154465 ]

[Iteration 67] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.364640235900879
  Initial mm_cutoff: 0.6024208068847656
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2245.110840
    ml_cutoff: 0.1000 (grad: 1.047014e+02)
    mm_switch_on: 9.3697 (grad: -8.077766e+02)
    mm_cutoff: 0.5973 (grad: 3.386198e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 93
Mean force error (MSE): 0.677075 eV²/Å²
Max force error: 1.645667 eV²/Å²
Mean predicted force magnitude: 0.638737 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2210.774170
    ml_cutoff: 0.1000 (grad: 8.760205e+01)
    mm_switch_on: 9.4154 (grad: -7.256721e+02)
    mm_cutoff: 0.5515 (grad: 3.303489e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 102
Mean force error (MSE): 0.674853 eV²/Å²
Max force error: 1.667128 eV²/Å²
Mean predicted force magnitude: 0.644673 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2210.774170
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.4154
  Optimized mm_cutoff: 0.5515

[Iteration 67] Cutoff optimization complete
  Final loss: 2210.774170
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.415376663208008, mm_cutoff=0.5514613389968872)

[Iteration 67] Loss improvement: 0.017113

================================================================================
ITERATION 68/100
================================================================================

[Iteration 68] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.415376663208008, mm_cutoff=0.5514613389968872)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5635247 0.1       0.1       2.154465 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.263672
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5584248 0.1       0.1       2.149365 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.286140 eV²/Å²
Max force error: 323.691662 eV²/Å²
Mean predicted force magnitude: 0.612258 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.289062
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5610183 0.1       0.1       2.1519995]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.579975 eV²/Å²
Max force error: 334.157684 eV²/Å²
Mean predicted force magnitude: 0.620797 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.263672
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5584248 0.1       0.1       2.149365 ]

[Iteration 68] LJ optimization complete
  Final loss: 6360.289062
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5584248 0.1       0.1       2.149365 ]

[Iteration 68] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.415376663208008
  Initial mm_cutoff: 0.5514613389968872
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2207.141846
    ml_cutoff: 0.1000 (grad: 8.620742e+01)
    mm_switch_on: 9.4205 (grad: -7.205799e+02)
    mm_cutoff: 0.5464 (grad: 3.285673e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 102
Mean force error (MSE): 0.674767 eV²/Å²
Max force error: 1.667010 eV²/Å²
Mean predicted force magnitude: 0.646119 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2173.290039
    ml_cutoff: 0.1000 (grad: 9.352343e+01)
    mm_switch_on: 9.4665 (grad: -7.285834e+02)
    mm_cutoff: 0.5005 (grad: 3.153446e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 102
Mean force error (MSE): 0.672595 eV²/Å²
Max force error: 1.713027 eV²/Å²
Mean predicted force magnitude: 0.651577 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2173.290039
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.4665
  Optimized mm_cutoff: 0.5005

[Iteration 68] Cutoff optimization complete
  Final loss: 2173.290039
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.466456413269043, mm_cutoff=0.5005418062210083)

[Iteration 68] Loss improvement: 0.016955

================================================================================
ITERATION 69/100
================================================================================

[Iteration 69] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.466456413269043, mm_cutoff=0.5005418062210083)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5584248 0.1       0.1       2.149365 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.302734
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5635247 0.1       0.1       2.154465 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.866138 eV²/Å²
Max force error: 344.274408 eV²/Å²
Mean predicted force magnitude: 0.628991 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.211914
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5631433 0.1       0.1       2.1541255]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.825311 eV²/Å²
Max force error: 342.851856 eV²/Å²
Mean predicted force magnitude: 0.627824 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.208496
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.566393  0.1       0.1       2.1573305]

[Iteration 69] LJ optimization complete
  Final loss: 6360.211914
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.566393  0.1       0.1       2.1573305]

[Iteration 69] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.466456413269043
  Initial mm_cutoff: 0.5005418062210083
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2171.519531
    ml_cutoff: 0.1000 (grad: 9.282171e+01)
    mm_switch_on: 9.4716 (grad: -7.253489e+02)
    mm_cutoff: 0.4954 (grad: 3.148015e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 102
Mean force error (MSE): 0.690886 eV²/Å²
Max force error: 1.717151 eV²/Å²
Mean predicted force magnitude: 0.672820 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2135.568848
    ml_cutoff: 0.1000 (grad: 1.010906e+02)
    mm_switch_on: 9.5177 (grad: -8.134041e+02)
    mm_cutoff: 0.4496 (grad: 2.973343e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.689632 eV²/Å²
Max force error: 1.791101 eV²/Å²
Mean predicted force magnitude: 0.679487 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2135.568848
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.5177
  Optimized mm_cutoff: 0.4496

[Iteration 69] Cutoff optimization complete
  Final loss: 2135.568848
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.517704963684082, mm_cutoff=0.44963860511779785)

[Iteration 69] Loss improvement: 0.017357

================================================================================
ITERATION 70/100
================================================================================

[Iteration 70] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.517704963684082, mm_cutoff=0.44963860511779785)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.566393  0.1       0.1       2.1573305]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.310059
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56129307 0.1        0.1        2.1522305 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.607336 eV²/Å²
Max force error: 335.106363 eV²/Å²
Mean predicted force magnitude: 0.621592 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.251953
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56150913 0.1        0.1        2.1524286 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.630391 eV²/Å²
Max force error: 335.914794 eV²/Å²
Mean predicted force magnitude: 0.622258 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.250488
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5644818 0.1       0.1       2.155451 ]

[Iteration 70] LJ optimization complete
  Final loss: 6360.251953
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5644818 0.1       0.1       2.155451 ]

[Iteration 70] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.517704963684082
  Initial mm_cutoff: 0.44963860511779785
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2131.584473
    ml_cutoff: 0.1000 (grad: 1.019333e+02)
    mm_switch_on: 9.5228 (grad: -8.048649e+02)
    mm_cutoff: 0.4445 (grad: 2.949317e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.672829 eV²/Å²
Max force error: 1.740813 eV²/Å²
Mean predicted force magnitude: 0.663194 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2097.123535
    ml_cutoff: 0.1000 (grad: 8.680370e+01)
    mm_switch_on: 9.5685 (grad: -7.321662e+02)
    mm_cutoff: 0.3988 (grad: 2.792476e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.670916 eV²/Å²
Max force error: 1.779598 eV²/Å²
Mean predicted force magnitude: 0.669105 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2097.123535
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.5685
  Optimized mm_cutoff: 0.3988

[Iteration 70] Cutoff optimization complete
  Final loss: 2097.123535
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.568482398986816, mm_cutoff=0.39875391125679016)

[Iteration 70] Loss improvement: 0.018002

================================================================================
ITERATION 71/100
================================================================================

[Iteration 71] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.568482398986816, mm_cutoff=0.39875391125679016)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5644818 0.1       0.1       2.155451 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.224609
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55938184 0.1        0.1        2.150351  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.394641 eV²/Å²
Max force error: 327.567728 eV²/Å²
Mean predicted force magnitude: 0.615426 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.228027
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56197554 0.1        0.1        2.1528893 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.683424 eV²/Å²
Max force error: 337.792000 eV²/Å²
Mean predicted force magnitude: 0.623782 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.213867
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5620417 0.1       0.1       2.1529753]

[Iteration 71] LJ optimization complete
  Final loss: 6360.228027
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5620417 0.1       0.1       2.1529753]

[Iteration 71] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.568482398986816
  Initial mm_cutoff: 0.39875391125679016
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2094.049561
    ml_cutoff: 0.1000 (grad: 8.525220e+01)
    mm_switch_on: 9.5736 (grad: -7.357102e+02)
    mm_cutoff: 0.3937 (grad: 2.803303e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.676198 eV²/Å²
Max force error: 1.784143 eV²/Å²
Mean predicted force magnitude: 0.678758 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2058.975830
    ml_cutoff: 0.1000 (grad: 9.835018e+01)
    mm_switch_on: 9.6196 (grad: -7.339095e+02)
    mm_cutoff: 0.3478 (grad: 2.777000e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.674416 eV²/Å²
Max force error: 1.824144 eV²/Å²
Mean predicted force magnitude: 0.685107 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2058.975830
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.6196
  Optimized mm_cutoff: 0.3478

[Iteration 71] Cutoff optimization complete
  Final loss: 2058.975830
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.619569778442383, mm_cutoff=0.34776660799980164)

[Iteration 71] Loss improvement: 0.018190

================================================================================
ITERATION 72/100
================================================================================

[Iteration 72] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.619569778442383, mm_cutoff=0.34776660799980164)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5620417 0.1       0.1       2.1529753]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.234375
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56714165 0.1        0.1        2.1580753 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.300867 eV²/Å²
Max force error: 359.606199 eV²/Å²
Mean predicted force magnitude: 0.641193 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.255859
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5646569 0.1       0.1       2.155643 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.004572 eV²/Å²
Max force error: 349.190607 eV²/Å²
Mean predicted force magnitude: 0.632900 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.231934
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56479985 0.1        0.1        2.155794  ]

[Iteration 72] LJ optimization complete
  Final loss: 6360.255859
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56479985 0.1        0.1        2.155794  ]

[Iteration 72] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.619569778442383
  Initial mm_cutoff: 0.34776660799980164
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2056.248779
    ml_cutoff: 0.1000 (grad: 9.603967e+01)
    mm_switch_on: 9.6247 (grad: -7.140276e+02)
    mm_cutoff: 0.3427 (grad: 2.797424e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.726895 eV²/Å²
Max force error: 6.279678 eV²/Å²
Mean predicted force magnitude: 0.712710 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 2025.482544
    ml_cutoff: 0.1000 (grad: 8.143530e+01)
    mm_switch_on: 9.6704 (grad: -6.887905e+02)
    mm_cutoff: 0.2968 (grad: 2.715971e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.736090 eV²/Å²
Max force error: 7.371461 eV²/Å²
Mean predicted force magnitude: 0.721804 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 2025.482544
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.6704
  Optimized mm_cutoff: 0.2968

[Iteration 72] Cutoff optimization complete
  Final loss: 2025.482544
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.670385360717773, mm_cutoff=0.29682353138923645)

[Iteration 72] Loss improvement: 0.016267

================================================================================
ITERATION 73/100
================================================================================

[Iteration 73] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.670385360717773, mm_cutoff=0.29682353138923645)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56479985 0.1        0.1        2.155794  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.224121
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5596999 0.1       0.1       2.150694 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432346 eV²/Å²
Max force error: 328.920446 eV²/Å²
Mean predicted force magnitude: 0.616520 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.218262
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56200933 0.1        0.1        2.152901  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685281 eV²/Å²
Max force error: 337.846600 eV²/Å²
Mean predicted force magnitude: 0.623838 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.207520
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56140774 0.1        0.1        2.1523108 ]

[Iteration 73] LJ optimization complete
  Final loss: 6360.218262
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56140774 0.1        0.1        2.1523108 ]

[Iteration 73] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.670385360717773
  Initial mm_cutoff: 0.29682353138923645
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 2021.348999
    ml_cutoff: 0.1000 (grad: 8.377697e+01)
    mm_switch_on: 9.6755 (grad: -7.066608e+02)
    mm_cutoff: 0.2917 (grad: 2.714692e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.667906 eV²/Å²
Max force error: 1.865159 eV²/Å²
Mean predicted force magnitude: 0.687912 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1987.426880
    ml_cutoff: 0.1000 (grad: 9.250102e+01)
    mm_switch_on: 9.7215 (grad: -7.395730e+02)
    mm_cutoff: 0.2458 (grad: 2.824388e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.665992 eV²/Å²
Max force error: 1.911449 eV²/Å²
Mean predicted force magnitude: 0.694240 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1987.426880
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.7215
  Optimized mm_cutoff: 0.2458

[Iteration 73] Cutoff optimization complete
  Final loss: 1987.426880
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.72148609161377, mm_cutoff=0.24576614797115326)

[Iteration 73] Loss improvement: 0.018788

================================================================================
ITERATION 74/100
================================================================================

[Iteration 74] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.72148609161377, mm_cutoff=0.24576614797115326)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56140774 0.1        0.1        2.1523108 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.251953
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5665077 0.1       0.1       2.1574109]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.220104 eV²/Å²
Max force error: 356.746465 eV²/Å²
Mean predicted force magnitude: 0.638952 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.257812
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5639983 0.1       0.1       2.1549444]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.922535 eV²/Å²
Max force error: 346.271296 eV²/Å²
Mean predicted force magnitude: 0.630589 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.243652
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5637213 0.1       0.1       2.154686 ]

[Iteration 74] LJ optimization complete
  Final loss: 6360.257812
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5637213 0.1       0.1       2.154686 ]

[Iteration 74] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.72148609161377
  Initial mm_cutoff: 0.24576614797115326
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1983.633057
    ml_cutoff: 0.1000 (grad: 9.192395e+01)
    mm_switch_on: 9.7266 (grad: -7.451083e+02)
    mm_cutoff: 0.2407 (grad: 2.849562e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.665701 eV²/Å²
Max force error: 1.914209 eV²/Å²
Mean predicted force magnitude: 0.694906 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1950.426270
    ml_cutoff: 0.1000 (grad: 8.838232e+01)
    mm_switch_on: 9.7723 (grad: -6.752449e+02)
    mm_cutoff: 0.1946 (grad: 3.180153e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.663543 eV²/Å²
Max force error: 1.937366 eV²/Å²
Mean predicted force magnitude: 0.700547 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1950.426270
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.7723
  Optimized mm_cutoff: 0.1946

[Iteration 74] Cutoff optimization complete
  Final loss: 1950.426270
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.772327423095703, mm_cutoff=0.19458414614200592)

[Iteration 74] Loss improvement: 0.018617

================================================================================
ITERATION 75/100
================================================================================

[Iteration 75] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.772327423095703, mm_cutoff=0.19458414614200592)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5637213 0.1       0.1       2.154686 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.233887
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55862135 0.1        0.1        2.149586  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.309929 eV²/Å²
Max force error: 324.550681 eV²/Å²
Mean predicted force magnitude: 0.612952 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.254883
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5612949 0.1       0.1       2.1522527]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609390 eV²/Å²
Max force error: 335.189588 eV²/Å²
Mean predicted force magnitude: 0.621648 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.232910
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5619477 0.1       0.1       2.1529152]

[Iteration 75] LJ optimization complete
  Final loss: 6360.254883
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5619477 0.1       0.1       2.1529152]

[Iteration 75] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.772327423095703
  Initial mm_cutoff: 0.19458414614200592
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1947.049927
    ml_cutoff: 0.1000 (grad: 8.751263e+01)
    mm_switch_on: 9.7774 (grad: -6.652043e+02)
    mm_cutoff: 0.1895 (grad: 3.222367e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.663130 eV²/Å²
Max force error: 1.937140 eV²/Å²
Mean predicted force magnitude: 0.701244 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1917.349365
    ml_cutoff: 0.1000 (grad: 7.728755e+01)
    mm_switch_on: 9.8232 (grad: -6.498315e+02)
    mm_cutoff: 0.1434 (grad: 3.477044e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.661564 eV²/Å²
Max force error: 1.968364 eV²/Å²
Mean predicted force magnitude: 0.706620 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1917.349365
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.8232
  Optimized mm_cutoff: 0.1434

[Iteration 75] Cutoff optimization complete
  Final loss: 1917.349365
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.823219299316406, mm_cutoff=0.14342984557151794)

[Iteration 75] Loss improvement: 0.016959

================================================================================
ITERATION 76/100
================================================================================

[Iteration 76] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.823219299316406, mm_cutoff=0.14342984557151794)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5619477 0.1       0.1       2.1529152]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.214844
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56704766 0.1        0.1        2.1580153 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.292612 eV²/Å²
Max force error: 359.334232 eV²/Å²
Mean predicted force magnitude: 0.640959 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235352
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5646003 0.1       0.1       2.1555538]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.994729 eV²/Å²
Max force error: 348.825546 eV²/Å²
Mean predicted force magnitude: 0.632627 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.212402
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482303 0.1        0.1        2.1557868 ]

[Iteration 76] LJ optimization complete
  Final loss: 6360.235352
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482303 0.1        0.1        2.1557868 ]

[Iteration 76] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.823219299316406
  Initial mm_cutoff: 0.14342984557151794
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1914.004639
    ml_cutoff: 0.1000 (grad: 7.996220e+01)
    mm_switch_on: 9.8283 (grad: -6.650252e+02)
    mm_cutoff: 0.1383 (grad: 3.473497e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.661276 eV²/Å²
Max force error: 1.970108 eV²/Å²
Mean predicted force magnitude: 0.707460 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1883.973145
    ml_cutoff: 0.1000 (grad: 7.784159e+01)
    mm_switch_on: 9.8741 (grad: -5.889147e+02)
    mm_cutoff: 0.1000 (grad: 8.308879e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.659483 eV²/Å²
Max force error: 1.978811 eV²/Å²
Mean predicted force magnitude: 0.713408 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1883.973145
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.8741
  Optimized mm_cutoff: 0.1000

[Iteration 76] Cutoff optimization complete
  Final loss: 1883.973145
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.874088287353516, mm_cutoff=0.10000000149011612)

[Iteration 76] Loss improvement: 0.017407

================================================================================
ITERATION 77/100
================================================================================

[Iteration 77] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.874088287353516, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482303 0.1        0.1        2.1557868 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.262695
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597231 0.1       0.1       2.1506867]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432241 eV²/Å²
Max force error: 328.901796 eV²/Å²
Mean predicted force magnitude: 0.616521 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.257812
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619968 0.1       0.1       2.152905 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685370 eV²/Å²
Max force error: 337.858334 eV²/Å²
Mean predicted force magnitude: 0.623838 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.246582
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650252 0.1       0.1       2.155973 ]

[Iteration 77] LJ optimization complete
  Final loss: 6360.257812
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650252 0.1       0.1       2.155973 ]

[Iteration 77] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.874088287353516
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1881.463013
    ml_cutoff: 0.1000 (grad: 7.492238e+01)
    mm_switch_on: 9.8792 (grad: -5.723693e+02)
    mm_cutoff: 0.1000 (grad: 8.445060e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 114
Mean force error (MSE): 0.662237 eV²/Å²
Max force error: 1.978643 eV²/Å²
Mean predicted force magnitude: 0.719929 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1854.489380
    ml_cutoff: 0.1000 (grad: 7.284535e+01)
    mm_switch_on: 9.9252 (grad: -6.015601e+02)
    mm_cutoff: 0.1000 (grad: 9.883736e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 120
Mean force error (MSE): 0.661291 eV²/Å²
Max force error: 2.025093 eV²/Å²
Mean predicted force magnitude: 0.725585 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1854.489380
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.9252
  Optimized mm_cutoff: 0.1000

[Iteration 77] Cutoff optimization complete
  Final loss: 1854.489380
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.925189971923828, mm_cutoff=0.10000000149011612)

[Iteration 77] Loss improvement: 0.015650

================================================================================
ITERATION 78/100
================================================================================

[Iteration 78] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.925189971923828, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650252 0.1       0.1       2.155973 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.231934
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55992526 0.1        0.1        2.150873  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453466 eV²/Å²
Max force error: 329.648252 eV²/Å²
Mean predicted force magnitude: 0.617140 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.221680
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56191295 0.1        0.1        2.15283   ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676522 eV²/Å²
Max force error: 337.549173 eV²/Å²
Mean predicted force magnitude: 0.623583 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.208496
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648279 0.1       0.1       2.1557827]

[Iteration 78] LJ optimization complete
  Final loss: 6360.221680
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648279 0.1       0.1       2.1557827]

[Iteration 78] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.925189971923828
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1852.249756
    ml_cutoff: 0.1000 (grad: 7.432304e+01)
    mm_switch_on: 9.9303 (grad: -6.000074e+02)
    mm_cutoff: 0.1000 (grad: 9.578736e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 120
Mean force error (MSE): 0.674011 eV²/Å²
Max force error: 2.033254 eV²/Å²
Mean predicted force magnitude: 0.738434 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1825.750488
    ml_cutoff: 0.1000 (grad: 6.721229e+01)
    mm_switch_on: 9.9761 (grad: -5.730135e+02)
    mm_cutoff: 0.1000 (grad: 8.260660e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 127
Mean force error (MSE): 0.673572 eV²/Å²
Max force error: 2.069048 eV²/Å²
Mean predicted force magnitude: 0.744172 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1825.750488
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 9.9761
  Optimized mm_cutoff: 0.1000

[Iteration 78] Cutoff optimization complete
  Final loss: 1825.750488
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.976078033447266, mm_cutoff=0.10000000149011612)

[Iteration 78] Loss improvement: 0.015497

================================================================================
ITERATION 79/100
================================================================================

[Iteration 79] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=9.976078033447266, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648279 0.1       0.1       2.1557827]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.268555
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55972797 0.1        0.1        2.1506827 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431986 eV²/Å²
Max force error: 328.888383 eV²/Å²
Mean predicted force magnitude: 0.616515 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.261719
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619885 0.1       0.1       2.1529078]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685425 eV²/Å²
Max force error: 337.866077 eV²/Å²
Mean predicted force magnitude: 0.623838 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.251465
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56502354 0.1        0.1        2.1559753 ]

[Iteration 79] LJ optimization complete
  Final loss: 6360.261719
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56502354 0.1        0.1        2.1559753 ]

[Iteration 79] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 9.976078033447266
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1822.946167
    ml_cutoff: 0.1000 (grad: 6.644538e+01)
    mm_switch_on: 9.9812 (grad: -5.863889e+02)
    mm_cutoff: 0.1000 (grad: 9.441894e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 127
Mean force error (MSE): 0.659433 eV²/Å²
Max force error: 2.073968 eV²/Å²
Mean predicted force magnitude: 0.728640 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1791.493896
    ml_cutoff: 0.1000 (grad: 9.375561e+01)
    mm_switch_on: 10.0275 (grad: -7.274979e+02)
    mm_cutoff: 0.1000 (grad: 1.530637e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 127
Mean force error (MSE): 0.657550 eV²/Å²
Max force error: 2.089568 eV²/Å²
Mean predicted force magnitude: 0.734622 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1791.493896
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.0275
  Optimized mm_cutoff: 0.1000

[Iteration 79] Cutoff optimization complete
  Final loss: 1791.493896
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.02749252319336, mm_cutoff=0.10000000149011612)

[Iteration 79] Loss improvement: 0.018763

================================================================================
ITERATION 80/100
================================================================================

[Iteration 80] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.02749252319336, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56502354 0.1        0.1        2.1559753 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.270020
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599236 0.1       0.1       2.1508753]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453643 eV²/Å²
Max force error: 329.656558 eV²/Å²
Mean predicted force magnitude: 0.617145 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.259766
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56191826 0.1        0.1        2.1528287 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676530 eV²/Å²
Max force error: 337.546197 eV²/Å²
Mean predicted force magnitude: 0.623584 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.248047
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482995 0.1        0.1        2.1557815 ]

[Iteration 80] LJ optimization complete
  Final loss: 6360.259766
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482995 0.1        0.1        2.1557815 ]

[Iteration 80] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.02749252319336
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1789.015137
    ml_cutoff: 0.1000 (grad: 9.425104e+01)
    mm_switch_on: 10.0326 (grad: -7.205137e+02)
    mm_cutoff: 0.1000 (grad: 1.456017e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 127
Mean force error (MSE): 0.685570 eV²/Å²
Max force error: 3.651302 eV²/Å²
Mean predicted force magnitude: 0.755857 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1759.331299
    ml_cutoff: 0.1000 (grad: 7.446808e+01)
    mm_switch_on: 10.0781 (grad: -6.234739e+02)
    mm_cutoff: 0.1000 (grad: 5.657833e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.684750 eV²/Å²
Max force error: 3.757053 eV²/Å²
Mean predicted force magnitude: 0.761441 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1759.331299
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.0781
  Optimized mm_cutoff: 0.1000

[Iteration 80] Cutoff optimization complete
  Final loss: 1759.331299
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.078089714050293, mm_cutoff=0.10000000149011612)

[Iteration 80] Loss improvement: 0.017953

================================================================================
ITERATION 81/100
================================================================================

[Iteration 81] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.078089714050293, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482995 0.1        0.1        2.1557815 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.298828
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55973   0.1       0.1       2.1506815]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431935 eV²/Å²
Max force error: 328.884737 eV²/Å²
Mean predicted force magnitude: 0.616514 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.293945
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.561985  0.1       0.1       2.1529095]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685501 eV²/Å²
Max force error: 337.871174 eV²/Å²
Mean predicted force magnitude: 0.623840 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.281738
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56502336 0.1        0.1        2.1559772 ]

[Iteration 81] LJ optimization complete
  Final loss: 6360.293945
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56502336 0.1        0.1        2.1559772 ]

[Iteration 81] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.078089714050293
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1756.791016
    ml_cutoff: 0.1000 (grad: 7.519318e+01)
    mm_switch_on: 10.0832 (grad: -6.337097e+02)
    mm_cutoff: 0.1000 (grad: 5.699989e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.655647 eV²/Å²
Max force error: 2.099369 eV²/Å²
Mean predicted force magnitude: 0.742273 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1726.285645
    ml_cutoff: 0.1000 (grad: 8.631591e+01)
    mm_switch_on: 10.1292 (grad: -6.804592e+02)
    mm_cutoff: 0.1000 (grad: 1.317553e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.653358 eV²/Å²
Max force error: 2.102439 eV²/Å²
Mean predicted force magnitude: 0.747688 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1726.285645
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.1292
  Optimized mm_cutoff: 0.1000

[Iteration 81] Cutoff optimization complete
  Final loss: 1726.285645
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.129243850708008, mm_cutoff=0.10000000149011612)

[Iteration 81] Loss improvement: 0.018783

================================================================================
ITERATION 82/100
================================================================================

[Iteration 82] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.129243850708008, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56502336 0.1        0.1        2.1559772 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.301758
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599234 0.1       0.1       2.1508772]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453806 eV²/Å²
Max force error: 329.663354 eV²/Å²
Mean predicted force magnitude: 0.617149 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.291016
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619118 0.1       0.1       2.1528301]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676504 eV²/Å²
Max force error: 337.549264 eV²/Å²
Mean predicted force magnitude: 0.623582 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.278809
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648243 0.1       0.1       2.1557822]

[Iteration 82] LJ optimization complete
  Final loss: 6360.291016
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648243 0.1       0.1       2.1557822]

[Iteration 82] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.129243850708008
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1724.460449
    ml_cutoff: 0.1000 (grad: 8.649619e+01)
    mm_switch_on: 10.1343 (grad: -6.723686e+02)
    mm_cutoff: 0.1000 (grad: 1.428281e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.744713 eV²/Å²
Max force error: 9.455613 eV²/Å²
Mean predicted force magnitude: 0.792857 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1696.594971
    ml_cutoff: 0.1000 (grad: 7.304832e+01)
    mm_switch_on: 10.1799 (grad: -5.995818e+02)
    mm_cutoff: 0.1000 (grad: 1.293209e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.746502 eV²/Å²
Max force error: 9.762304 eV²/Å²
Mean predicted force magnitude: 0.799528 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1696.594971
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.1799
  Optimized mm_cutoff: 0.1000

[Iteration 82] Cutoff optimization complete
  Final loss: 1696.594971
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.17986011505127, mm_cutoff=0.10000000149011612)

[Iteration 82] Loss improvement: 0.017199

================================================================================
ITERATION 83/100
================================================================================

[Iteration 83] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.17986011505127, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648243 0.1       0.1       2.1557822]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.288574
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55972433 0.1        0.1        2.1506822 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431860 eV²/Å²
Max force error: 328.885245 eV²/Å²
Mean predicted force magnitude: 0.616511 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.283691
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619932 0.1       0.1       2.1529062]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685395 eV²/Å²
Max force error: 337.861739 eV²/Å²
Mean predicted force magnitude: 0.623838 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.272949
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5613851 0.1       0.1       2.1523137]

[Iteration 83] LJ optimization complete
  Final loss: 6360.283691
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5613851 0.1       0.1       2.1523137]

[Iteration 83] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.17986011505127
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1693.210449
    ml_cutoff: 0.1000 (grad: 7.280313e+01)
    mm_switch_on: 10.1850 (grad: -5.992695e+02)
    mm_cutoff: 0.1000 (grad: 1.282580e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.654904 eV²/Å²
Max force error: 2.138417 eV²/Å²
Mean predicted force magnitude: 0.756927 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1663.133789
    ml_cutoff: 0.1000 (grad: 8.855819e+01)
    mm_switch_on: 10.2312 (grad: -7.622891e+02)
    mm_cutoff: 0.1000 (grad: 1.112741e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.653451 eV²/Å²
Max force error: 2.166995 eV²/Å²
Mean predicted force magnitude: 0.763023 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1663.133789
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.2312
  Optimized mm_cutoff: 0.1000

[Iteration 83] Cutoff optimization complete
  Final loss: 1663.133789
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.231181144714355, mm_cutoff=0.10000000149011612)

[Iteration 83] Loss improvement: 0.019723

================================================================================
ITERATION 84/100
================================================================================

[Iteration 84] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.231181144714355, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5613851 0.1       0.1       2.1523137]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.231445
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56648505 0.1        0.1        2.1574137 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.219822 eV²/Å²
Max force error: 356.750226 eV²/Å²
Mean predicted force magnitude: 0.638940 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235840
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56399876 0.1        0.1        2.1549413 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.922256 eV²/Å²
Max force error: 346.259524 eV²/Å²
Mean predicted force magnitude: 0.630581 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.222168
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56466603 0.1        0.1        2.1556246 ]

[Iteration 84] LJ optimization complete
  Final loss: 6360.235840
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56466603 0.1        0.1        2.1556246 ]

[Iteration 84] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.231181144714355
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1659.995483
    ml_cutoff: 0.1000 (grad: 9.165714e+01)
    mm_switch_on: 10.2363 (grad: -7.780389e+02)
    mm_cutoff: 0.1000 (grad: 1.006892e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 135
Mean force error (MSE): 0.653785 eV²/Å²
Max force error: 2.171456 eV²/Å²
Mean predicted force magnitude: 0.764173 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1624.171509
    ml_cutoff: 0.1000 (grad: 1.002380e+02)
    mm_switch_on: 10.2822 (grad: -7.695774e+02)
    mm_cutoff: 0.1000 (grad: 3.986582e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 148
Mean force error (MSE): 0.652125 eV²/Å²
Max force error: 2.200148 eV²/Å²
Mean predicted force magnitude: 0.771032 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1624.171509
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.2822
  Optimized mm_cutoff: 0.1000

[Iteration 84] Cutoff optimization complete
  Final loss: 1624.171509
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.282171249389648, mm_cutoff=0.10000000149011612)

[Iteration 84] Loss improvement: 0.023427

================================================================================
ITERATION 85/100
================================================================================

[Iteration 85] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.282171249389648, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56466603 0.1        0.1        2.1556246 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.280762
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5595661 0.1       0.1       2.1505246]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.414224 eV²/Å²
Max force error: 328.258627 eV²/Å²
Mean predicted force magnitude: 0.615998 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.277344
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5620033 0.1       0.1       2.1529262]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.687465 eV²/Å²
Max force error: 337.940050 eV²/Å²
Mean predicted force magnitude: 0.623896 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.266113
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5621477 0.1       0.1       2.1530924]

[Iteration 85] LJ optimization complete
  Final loss: 6360.277344
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5621477 0.1       0.1       2.1530924]

[Iteration 85] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.282171249389648
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1620.287231
    ml_cutoff: 0.1000 (grad: 9.821916e+01)
    mm_switch_on: 10.2873 (grad: -7.605621e+02)
    mm_cutoff: 0.1000 (grad: 4.276766e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 148
Mean force error (MSE): 0.651816 eV²/Å²
Max force error: 2.205651 eV²/Å²
Mean predicted force magnitude: 0.771497 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1585.932251
    ml_cutoff: 0.1000 (grad: 9.665356e+01)
    mm_switch_on: 10.3332 (grad: -7.778538e+02)
    mm_cutoff: 0.1000 (grad: 6.585938e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 148
Mean force error (MSE): 0.650012 eV²/Å²
Max force error: 2.254018 eV²/Å²
Mean predicted force magnitude: 0.777690 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1585.932251
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.3332
  Optimized mm_cutoff: 0.1000

[Iteration 85] Cutoff optimization complete
  Final loss: 1585.932251
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.333165168762207, mm_cutoff=0.10000000149011612)

[Iteration 85] Loss improvement: 0.023544

================================================================================
ITERATION 86/100
================================================================================

[Iteration 86] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.333165168762207, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5621477 0.1       0.1       2.1530924]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.251465
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5672476 0.1       0.1       2.1581924]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.315022 eV²/Å²
Max force error: 360.110242 eV²/Å²
Mean predicted force magnitude: 0.641584 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.275391
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5647974 0.1       0.1       2.1557844]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.021438 eV²/Å²
Max force error: 349.786197 eV²/Å²
Mean predicted force magnitude: 0.633375 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.250977
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56478906 0.1        0.1        2.155783  ]

[Iteration 86] LJ optimization complete
  Final loss: 6360.275391
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56478906 0.1        0.1        2.155783  ]

[Iteration 86] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.333165168762207
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1581.965454
    ml_cutoff: 0.1000 (grad: 9.723910e+01)
    mm_switch_on: 10.3383 (grad: -7.701204e+02)
    mm_cutoff: 0.1000 (grad: 6.988235e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 148
Mean force error (MSE): 0.649824 eV²/Å²
Max force error: 2.254868 eV²/Å²
Mean predicted force magnitude: 0.778389 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1549.451050
    ml_cutoff: 0.1000 (grad: 8.378912e+01)
    mm_switch_on: 10.3838 (grad: -6.485906e+02)
    mm_cutoff: 0.1000 (grad: 1.049038e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 151
Mean force error (MSE): 0.648170 eV²/Å²
Max force error: 2.275003 eV²/Å²
Mean predicted force magnitude: 0.784370 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1549.451050
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.3838
  Optimized mm_cutoff: 0.1000

[Iteration 86] Cutoff optimization complete
  Final loss: 1549.451050
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.383827209472656, mm_cutoff=0.10000000149011612)

[Iteration 86] Loss improvement: 0.023003

================================================================================
ITERATION 87/100
================================================================================

[Iteration 87] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.383827209472656, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56478906 0.1        0.1        2.155783  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.289551
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5596891 0.1       0.1       2.150683 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431132 eV²/Å²
Max force error: 328.877347 eV²/Å²
Mean predicted force magnitude: 0.616484 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.284180
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56200963 0.1        0.1        2.1529047 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685646 eV²/Å²
Max force error: 337.861339 eV²/Å²
Mean predicted force magnitude: 0.623848 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.271484
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650338 0.1       0.1       2.1559827]

[Iteration 87] LJ optimization complete
  Final loss: 6360.284180
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650338 0.1       0.1       2.1559827]

[Iteration 87] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.383827209472656
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1546.227783
    ml_cutoff: 0.1000 (grad: 8.166069e+01)
    mm_switch_on: 10.3889 (grad: -6.340991e+02)
    mm_cutoff: 0.1000 (grad: 1.050532e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 151
Mean force error (MSE): 0.648170 eV²/Å²
Max force error: 2.282292 eV²/Å²
Mean predicted force magnitude: 0.784997 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1517.747681
    ml_cutoff: 0.1000 (grad: 7.775975e+01)
    mm_switch_on: 10.4348 (grad: -6.060338e+02)
    mm_cutoff: 0.1000 (grad: 8.129509e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 151
Mean force error (MSE): 0.646904 eV²/Å²
Max force error: 2.336629 eV²/Å²
Mean predicted force magnitude: 0.790431 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1517.747681
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.4348
  Optimized mm_cutoff: 0.1000

[Iteration 87] Cutoff optimization complete
  Final loss: 1517.747681
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.43478775024414, mm_cutoff=0.10000000149011612)

[Iteration 87] Loss improvement: 0.020461

================================================================================
ITERATION 88/100
================================================================================

[Iteration 88] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.43478775024414, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650338 0.1       0.1       2.1559827]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.221191
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55993384 0.1        0.1        2.1508827 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.454537 eV²/Å²
Max force error: 329.686998 eV²/Å²
Mean predicted force magnitude: 0.617171 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.210938
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619162 0.1       0.1       2.1528213]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.675801 eV²/Å²
Max force error: 337.517425 eV²/Å²
Mean predicted force magnitude: 0.623564 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.199219
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56482214 0.1        0.1        2.1557698 ]

[Iteration 88] LJ optimization complete
  Final loss: 6360.210938
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56482214 0.1        0.1        2.1557698 ]

[Iteration 88] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.43478775024414
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1515.527344
    ml_cutoff: 0.1000 (grad: 7.674275e+01)
    mm_switch_on: 10.4399 (grad: -5.887256e+02)
    mm_cutoff: 0.1000 (grad: 7.369150e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 151
Mean force error (MSE): 0.690542 eV²/Å²
Max force error: 5.246886 eV²/Å²
Mean predicted force magnitude: 0.815048 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1490.057007
    ml_cutoff: 0.1000 (grad: 6.616688e+01)
    mm_switch_on: 10.4856 (grad: -5.350823e+02)
    mm_cutoff: 0.1000 (grad: 7.422429e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 157
Mean force error (MSE): 0.694952 eV²/Å²
Max force error: 5.750004 eV²/Å²
Mean predicted force magnitude: 0.821534 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1490.057007
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.4856
  Optimized mm_cutoff: 0.1000

[Iteration 88] Cutoff optimization complete
  Final loss: 1490.057007
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.485618591308594, mm_cutoff=0.10000000149011612)

[Iteration 88] Loss improvement: 0.018245

================================================================================
ITERATION 89/100
================================================================================

[Iteration 89] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.485618591308594, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56482214 0.1        0.1        2.1557698 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.219238
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597222 0.1       0.1       2.1506698]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.430713 eV²/Å²
Max force error: 328.839388 eV²/Å²
Mean predicted force magnitude: 0.616479 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.214355
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619876 0.1       0.1       2.1529121]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685800 eV²/Å²
Max force error: 337.881983 eV²/Å²
Mean predicted force magnitude: 0.623848 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.204102
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5613683 0.1       0.1       2.15231  ]

[Iteration 89] LJ optimization complete
  Final loss: 6360.214355
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5613683 0.1       0.1       2.15231  ]

[Iteration 89] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.485618591308594
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1487.372437
    ml_cutoff: 0.1000 (grad: 6.474845e+01)
    mm_switch_on: 10.4907 (grad: -5.302752e+02)
    mm_cutoff: 0.1000 (grad: 7.075246e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 157
Mean force error (MSE): 0.645698 eV²/Å²
Max force error: 2.403348 eV²/Å²
Mean predicted force magnitude: 0.796773 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1462.754883
    ml_cutoff: 0.1000 (grad: 6.701077e+01)
    mm_switch_on: 10.5367 (grad: -5.253514e+02)
    mm_cutoff: 0.1000 (grad: 9.763581e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 157
Mean force error (MSE): 0.645001 eV²/Å²
Max force error: 2.432538 eV²/Å²
Mean predicted force magnitude: 0.802263 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1462.754883
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.5367
  Optimized mm_cutoff: 0.1000

[Iteration 89] Cutoff optimization complete
  Final loss: 1462.754883
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.53666877746582, mm_cutoff=0.10000000149011612)

[Iteration 89] Loss improvement: 0.018323

================================================================================
ITERATION 90/100
================================================================================

[Iteration 90] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.53666877746582, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5613683 0.1       0.1       2.15231  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.232422
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56646824 0.1        0.1        2.15741   ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.219031 eV²/Å²
Max force error: 356.729657 eV²/Å²
Mean predicted force magnitude: 0.638916 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.236816
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5640041 0.1       0.1       2.154934 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.921688 eV²/Å²
Max force error: 346.232863 eV²/Å²
Mean predicted force magnitude: 0.630567 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.223145
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5637313 0.1       0.1       2.1546805]

[Iteration 90] LJ optimization complete
  Final loss: 6360.236816
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5637313 0.1       0.1       2.1546805]

[Iteration 90] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.53666877746582
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1461.370605
    ml_cutoff: 0.1000 (grad: 6.467980e+01)
    mm_switch_on: 10.5418 (grad: -5.122919e+02)
    mm_cutoff: 0.1000 (grad: 1.051355e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 157
Mean force error (MSE): 0.652171 eV²/Å²
Max force error: 2.426263 eV²/Å²
Mean predicted force magnitude: 0.810889 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1436.695190
    ml_cutoff: 0.1000 (grad: 6.880147e+01)
    mm_switch_on: 10.5879 (grad: -5.559736e+02)
    mm_cutoff: 0.1000 (grad: 9.153389e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 170
Mean force error (MSE): 0.651244 eV²/Å²
Max force error: 2.430896 eV²/Å²
Mean predicted force magnitude: 0.816546 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1436.695190
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.5879
  Optimized mm_cutoff: 0.1000

[Iteration 90] Cutoff optimization complete
  Final loss: 1436.695190
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.587862014770508, mm_cutoff=0.10000000149011612)

[Iteration 90] Loss improvement: 0.017815

================================================================================
ITERATION 91/100
================================================================================

[Iteration 91] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.587862014770508, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5637313 0.1       0.1       2.1546805]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.213379
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55863136 0.1        0.1        2.1495805 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.309680 eV²/Å²
Max force error: 324.534363 eV²/Å²
Mean predicted force magnitude: 0.612947 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235840
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56128067 0.1        0.1        2.152253  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.609092 eV²/Å²
Max force error: 335.186317 eV²/Å²
Mean predicted force magnitude: 0.621637 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.212402
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56193966 0.1        0.1        2.1529186 ]

[Iteration 91] LJ optimization complete
  Final loss: 6360.235840
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56193966 0.1        0.1        2.1529186 ]

[Iteration 91] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.587862014770508
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1433.897705
    ml_cutoff: 0.1000 (grad: 6.908271e+01)
    mm_switch_on: 10.5930 (grad: -5.518119e+02)
    mm_cutoff: 0.1000 (grad: 8.732010e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 177
Mean force error (MSE): 0.643774 eV²/Å²
Max force error: 2.432506 eV²/Å²
Mean predicted force magnitude: 0.809681 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1410.014526
    ml_cutoff: 0.1000 (grad: 6.158046e+01)
    mm_switch_on: 10.6387 (grad: -4.947578e+02)
    mm_cutoff: 0.1000 (grad: 8.062234e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 177
Mean force error (MSE): 0.642535 eV²/Å²
Max force error: 2.433457 eV²/Å²
Mean predicted force magnitude: 0.814717 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1410.014526
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.6387
  Optimized mm_cutoff: 0.1000

[Iteration 91] Cutoff optimization complete
  Final loss: 1410.014526
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.638668060302734, mm_cutoff=0.10000000149011612)

[Iteration 91] Loss improvement: 0.018571

================================================================================
ITERATION 92/100
================================================================================

[Iteration 92] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.638668060302734, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56193966 0.1        0.1        2.1529186 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.208008
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5670396 0.1       0.1       2.1580186]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 10.292737 eV²/Å²
Max force error: 359.345311 eV²/Å²
Mean predicted force magnitude: 0.640960 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.229004
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56460553 0.1        0.1        2.155554  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.994874 eV²/Å²
Max force error: 348.828105 eV²/Å²
Mean predicted force magnitude: 0.632632 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.205566
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648261 0.1       0.1       2.1557848]

[Iteration 92] LJ optimization complete
  Final loss: 6360.229004
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648261 0.1       0.1       2.1557848]

[Iteration 92] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.638668060302734
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1409.647461
    ml_cutoff: 0.1000 (grad: 5.961890e+01)
    mm_switch_on: 10.6438 (grad: -4.952294e+02)
    mm_cutoff: 0.1000 (grad: 8.095679e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 177
Mean force error (MSE): 0.657768 eV²/Å²
Max force error: 2.430418 eV²/Å²
Mean predicted force magnitude: 0.832381 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1383.254517
    ml_cutoff: 0.1000 (grad: 7.852522e+01)
    mm_switch_on: 10.6901 (grad: -6.497606e+02)
    mm_cutoff: 0.1000 (grad: 1.126270e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.657229 eV²/Å²
Max force error: 2.430799 eV²/Å²
Mean predicted force magnitude: 0.838194 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1383.254517
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.6901
  Optimized mm_cutoff: 0.1000

[Iteration 92] Cutoff optimization complete
  Final loss: 1383.254517
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.690119743347168, mm_cutoff=0.10000000149011612)

[Iteration 92] Loss improvement: 0.018979

================================================================================
ITERATION 93/100
================================================================================

[Iteration 93] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.690119743347168, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648261 0.1       0.1       2.1557848]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.271484
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597261 0.1       0.1       2.1506848]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432145 eV²/Å²
Max force error: 328.895845 eV²/Å²
Mean predicted force magnitude: 0.616519 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.267578
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56199795 0.1        0.1        2.152904  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685306 eV²/Å²
Max force error: 337.854689 eV²/Å²
Mean predicted force magnitude: 0.623837 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.255859
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56502664 0.1        0.1        2.1559715 ]

[Iteration 93] LJ optimization complete
  Final loss: 6360.267578
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56502664 0.1        0.1        2.1559715 ]

[Iteration 93] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.690119743347168
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1379.866333
    ml_cutoff: 0.1000 (grad: 8.033570e+01)
    mm_switch_on: 10.6952 (grad: -6.596209e+02)
    mm_cutoff: 0.1000 (grad: 1.114091e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.640673 eV²/Å²
Max force error: 2.431922 eV²/Å²
Mean predicted force magnitude: 0.821907 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1350.057861
    ml_cutoff: 0.1000 (grad: 7.828678e+01)
    mm_switch_on: 10.7410 (grad: -6.177048e+02)
    mm_cutoff: 0.1000 (grad: 4.926532e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.638735 eV²/Å²
Max force error: 2.440039 eV²/Å²
Mean predicted force magnitude: 0.826860 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1350.057861
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.7410
  Optimized mm_cutoff: 0.1000

[Iteration 93] Cutoff optimization complete
  Final loss: 1350.057861
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.74104118347168, mm_cutoff=0.10000000149011612)

[Iteration 93] Loss improvement: 0.023999

================================================================================
ITERATION 94/100
================================================================================

[Iteration 94] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.74104118347168, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56502664 0.1        0.1        2.1559715 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.245117
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599267 0.1       0.1       2.1508715]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453371 eV²/Å²
Max force error: 329.643317 eV²/Å²
Mean predicted force magnitude: 0.617138 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.235352
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619205 0.1       0.1       2.1528273]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676447 eV²/Å²
Max force error: 337.541400 eV²/Å²
Mean predicted force magnitude: 0.623583 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.222168
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56483364 0.1        0.1        2.1557806 ]

[Iteration 94] LJ optimization complete
  Final loss: 6360.235352
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56483364 0.1        0.1        2.1557806 ]

[Iteration 94] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.74104118347168
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1347.367554
    ml_cutoff: 0.1000 (grad: 7.719814e+01)
    mm_switch_on: 10.7461 (grad: -6.091387e+02)
    mm_cutoff: 0.1000 (grad: 5.246776e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.638675 eV²/Å²
Max force error: 2.440805 eV²/Å²
Mean predicted force magnitude: 0.827790 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1321.512085
    ml_cutoff: 0.1000 (grad: 6.795627e+01)
    mm_switch_on: 10.7918 (grad: -5.405286e+02)
    mm_cutoff: 0.1000 (grad: 1.033504e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.637309 eV²/Å²
Max force error: 2.459209 eV²/Å²
Mean predicted force magnitude: 0.832356 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1321.512085
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.7918
  Optimized mm_cutoff: 0.1000

[Iteration 94] Cutoff optimization complete
  Final loss: 1321.512085
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.791775703430176, mm_cutoff=0.10000000149011612)

[Iteration 94] Loss improvement: 0.021144

================================================================================
ITERATION 95/100
================================================================================

[Iteration 95] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.791775703430176, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56483364 0.1        0.1        2.1557806 ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.231445
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597337 0.1       0.1       2.1506805]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.431935 eV²/Å²
Max force error: 328.882344 eV²/Å²
Mean predicted force magnitude: 0.616515 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.225098
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.561988  0.1       0.1       2.1529071]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685348 eV²/Å²
Max force error: 337.863291 eV²/Å²
Mean predicted force magnitude: 0.623836 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.214844
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650252 0.1       0.1       2.1559741]

[Iteration 95] LJ optimization complete
  Final loss: 6360.225098
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650252 0.1       0.1       2.1559741]

[Iteration 95] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.791775703430176
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1318.776001
    ml_cutoff: 0.1000 (grad: 6.796931e+01)
    mm_switch_on: 10.7969 (grad: -5.413340e+02)
    mm_cutoff: 0.1000 (grad: 1.077883e-01)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 185
Mean force error (MSE): 0.637168 eV²/Å²
Max force error: 2.458378 eV²/Å²
Mean predicted force magnitude: 0.832762 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1293.764038
    ml_cutoff: 0.1000 (grad: 7.009972e+01)
    mm_switch_on: 10.8428 (grad: -5.774316e+02)
    mm_cutoff: 0.1000 (grad: 4.963085e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 201
Mean force error (MSE): 0.635933 eV²/Å²
Max force error: 2.461812 eV²/Å²
Mean predicted force magnitude: 0.837961 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1293.764038
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.8428
  Optimized mm_cutoff: 0.1000

[Iteration 95] Cutoff optimization complete
  Final loss: 1293.764038
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.84280014038086, mm_cutoff=0.10000000149011612)

[Iteration 95] Loss improvement: 0.020997

================================================================================
ITERATION 96/100
================================================================================

[Iteration 96] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.84280014038086, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650252 0.1       0.1       2.1559741]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.218262
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55992526 0.1        0.1        2.1508741 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453566 eV²/Å²
Max force error: 329.652309 eV²/Å²
Mean predicted force magnitude: 0.617143 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.208008
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619327 0.1       0.1       2.152827 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676714 eV²/Å²
Max force error: 337.544320 eV²/Å²
Mean predicted force magnitude: 0.623592 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.195312
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648417 0.1       0.1       2.1557815]

[Iteration 96] LJ optimization complete
  Final loss: 6360.208008
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648417 0.1       0.1       2.1557815]

[Iteration 96] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.84280014038086
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1290.782471
    ml_cutoff: 0.1000 (grad: 7.100565e+01)
    mm_switch_on: 10.8479 (grad: -5.836934e+02)
    mm_cutoff: 0.1000 (grad: 4.811784e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 201
Mean force error (MSE): 0.635778 eV²/Å²
Max force error: 2.461329 eV²/Å²
Mean predicted force magnitude: 0.838718 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1264.144409
    ml_cutoff: 0.1000 (grad: 7.239347e+01)
    mm_switch_on: 10.8937 (grad: -5.746761e+02)
    mm_cutoff: 0.1000 (grad: 8.917553e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 210
Mean force error (MSE): 0.635072 eV²/Å²
Max force error: 2.487384 eV²/Å²
Mean predicted force magnitude: 0.844731 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1264.144409
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.8937
  Optimized mm_cutoff: 0.1000

[Iteration 96] Cutoff optimization complete
  Final loss: 1264.144409
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.893745422363281, mm_cutoff=0.10000000149011612)

[Iteration 96] Loss improvement: 0.022894

================================================================================
ITERATION 97/100
================================================================================

[Iteration 97] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.893745422363281, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5648417 0.1       0.1       2.1557815]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.275391
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55974174 0.1        0.1        2.1506815 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432201 eV²/Å²
Max force error: 328.888347 eV²/Å²
Mean predicted force magnitude: 0.616524 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.269531
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56198704 0.1        0.1        2.152907  ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685311 eV²/Å²
Max force error: 337.862242 eV²/Å²
Mean predicted force magnitude: 0.623835 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.257812
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650244 0.1       0.1       2.1559713]

[Iteration 97] LJ optimization complete
  Final loss: 6360.269531
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650244 0.1       0.1       2.1559713]

[Iteration 97] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.893745422363281
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1261.388428
    ml_cutoff: 0.1000 (grad: 7.229713e+01)
    mm_switch_on: 10.8988 (grad: -5.738525e+02)
    mm_cutoff: 0.1000 (grad: 8.936540e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 210
Mean force error (MSE): 0.635402 eV²/Å²
Max force error: 2.493364 eV²/Å²
Mean predicted force magnitude: 0.846337 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1235.388672
    ml_cutoff: 0.1000 (grad: 7.100845e+01)
    mm_switch_on: 10.9447 (grad: -6.096600e+02)
    mm_cutoff: 0.1000 (grad: 7.392403e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.634700 eV²/Å²
Max force error: 2.548443 eV²/Å²
Mean predicted force magnitude: 0.852010 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1235.388672
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.9447
  Optimized mm_cutoff: 0.1000

[Iteration 97] Cutoff optimization complete
  Final loss: 1235.388672
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.944713592529297, mm_cutoff=0.10000000149011612)

[Iteration 97] Loss improvement: 0.022747

================================================================================
ITERATION 98/100
================================================================================

[Iteration 98] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.944713592529297, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650244 0.1       0.1       2.1559713]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.239258
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5599244 0.1       0.1       2.1508713]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453297 eV²/Å²
Max force error: 329.641743 eV²/Å²
Mean predicted force magnitude: 0.617136 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.228027
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619259 0.1       0.1       2.152829 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676740 eV²/Å²
Max force error: 337.549694 eV²/Å²
Mean predicted force magnitude: 0.623592 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.217773
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.56483877 0.1        0.1        2.155784  ]

[Iteration 98] LJ optimization complete
  Final loss: 6360.228027
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.56483877 0.1        0.1        2.155784  ]

[Iteration 98] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.944713592529297
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1232.242310
    ml_cutoff: 0.1000 (grad: 7.326340e+01)
    mm_switch_on: 10.9498 (grad: -6.263705e+02)
    mm_cutoff: 0.1000 (grad: 7.329545e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.634050 eV²/Å²
Max force error: 2.551050 eV²/Å²
Mean predicted force magnitude: 0.851606 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1202.701904
    ml_cutoff: 0.1000 (grad: 8.245766e+01)
    mm_switch_on: 10.9957 (grad: -6.171960e+02)
    mm_cutoff: 0.1000 (grad: 9.687205e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.632441 eV²/Å²
Max force error: 2.552111 eV²/Å²
Mean predicted force magnitude: 0.857574 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1202.701904
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 10.9957
  Optimized mm_cutoff: 0.1000

[Iteration 98] Cutoff optimization complete
  Final loss: 1202.701904
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.995748519897461, mm_cutoff=0.10000000149011612)

[Iteration 98] Loss improvement: 0.026459

================================================================================
ITERATION 99/100
================================================================================

[Iteration 99] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=10.995748519897461, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.56483877 0.1        0.1        2.155784  ]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.271973
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5597388 0.1       0.1       2.1506839]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.432347 eV²/Å²
Max force error: 328.896162 eV²/Å²
Mean predicted force magnitude: 0.616527 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.265625
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.56198883 0.1        0.1        2.1529055 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.685217 eV²/Å²
Max force error: 337.857079 eV²/Å²
Mean predicted force magnitude: 0.623833 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.255859
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5650227 0.1       0.1       2.1559694]

[Iteration 99] LJ optimization complete
  Final loss: 6360.265625
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5650227 0.1       0.1       2.1559694]

[Iteration 99] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 10.995748519897461
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1199.596313
    ml_cutoff: 0.1000 (grad: 8.139799e+01)
    mm_switch_on: 11.0008 (grad: -6.023157e+02)
    mm_cutoff: 0.1000 (grad: 9.794127e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.632412 eV²/Å²
Max force error: 2.554799 eV²/Å²
Mean predicted force magnitude: 0.858180 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1174.736938
    ml_cutoff: 0.1000 (grad: 6.451910e+01)
    mm_switch_on: 11.0464 (grad: -5.582600e+02)
    mm_cutoff: 0.1000 (grad: 6.495396e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.631374 eV²/Å²
Max force error: 2.556425 eV²/Å²
Mean predicted force magnitude: 0.863236 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1174.736938
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 11.0464
  Optimized mm_cutoff: 0.1000

[Iteration 99] Cutoff optimization complete
  Final loss: 1174.736938
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=11.04638957977295, mm_cutoff=0.10000000149011612)

[Iteration 99] Loss improvement: 0.023252

================================================================================
ITERATION 100/100
================================================================================

[Iteration 100] Step 1: Optimizing LJ parameters...
  Using cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=11.04638957977295, mm_cutoff=0.10000000149011612)
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: lj_only
  Number of atom types: 4
  Initial ep_scale: [0.1 0.1 0.1 0.1]
  Initial sig_scale: [0.5650227 0.1       0.1       2.1559694]
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10
  Precomputing ML contributions (constant for LJ-only optimization)...
  ✓ ML contributions precomputed for 100 configurations

Starting JAX optimization (mode: lj_only)...
  Iteration    0: Loss = 6360.223145
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.55992275 0.1        0.1        2.1508694 ]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.453083 eV²/Å²
Max force error: 329.634129 eV²/Å²
Mean predicted force magnitude: 0.617129 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 6360.211914
    ep_scale: [0.1 0.1 0.1 0.1]
    sig_scale: [0.5619132 0.1       0.1       2.1528318]

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 0
Mean force error (MSE): 9.676695 eV²/Å²
Max force error: 337.556423 eV²/Å²
Mean predicted force magnitude: 0.623588 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 6360.200684
  Optimized ep_scale: [0.1 0.1 0.1 0.1]
  Optimized sig_scale: [0.5648309 0.1       0.1       2.155786 ]

[Iteration 100] LJ optimization complete
  Final loss: 6360.211914
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648309 0.1       0.1       2.155786 ]

[Iteration 100] Step 2: Optimizing cutoff parameters...
  Using optimized LJ parameters from Step 1
Filtered out 86 batches with COM distance < 4.00 Å
Remaining batches: 10414
Selected 100 samples with COM distances:
  Min: 4.04 Å, Max: 17.58 Å
  Mean: 9.07 Å, Std: 3.04 Å
Fitting hybrid potential using 100 training samples
  Optimization mode: cutoff_only
  Number of atom types: 4
  Initial ml_cutoff: 0.10000000149011612
  Initial mm_switch_on: 11.04638957977295
  Initial mm_cutoff: 0.10000000149011612
  Energy weight: 1.0, Force weight: 10.0
  Learning rate: 0.0051, Iterations: 10

Starting JAX optimization (mode: cutoff_only)...
  Iteration    0: Loss = 1171.885498
    ml_cutoff: 0.1000 (grad: 6.575321e+01)
    mm_switch_on: 11.0515 (grad: -5.715976e+02)
    mm_cutoff: 0.1000 (grad: 6.169151e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.631341 eV²/Å²
Max force error: 2.557673 eV²/Å²
Mean predicted force magnitude: 0.863841 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter0.png
  Iteration    9: Loss = 1143.201050
    ml_cutoff: 0.1000 (grad: 8.191662e+01)
    mm_switch_on: 11.0976 (grad: -6.405578e+02)
    mm_cutoff: 0.1000 (grad: 4.194183e-02)

============================================================
FORCE VALIDATION SUMMARY
============================================================
Total configurations analyzed: 100
Configurations with NaN/Inf forces: 0
Atoms with zero forces: 214
Mean force error (MSE): 0.630413 eV²/Å²
Max force error: 2.579399 eV²/Å²
Mean predicted force magnitude: 0.869162 eV/Å
Mean reference force magnitude: 1.426340 eV/Å
============================================================

  Saved force validation plot to: force_validation_iter9.png

✓ Optimization complete!
  Final loss: 1143.201050
  Optimized ml_cutoff: 0.1000
  Optimized mm_switch_on: 11.0976
  Optimized mm_cutoff: 0.1000

[Iteration 100] Cutoff optimization complete
  Final loss: 1143.201050
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=11.09764575958252, mm_cutoff=0.10000000149011612)

[Iteration 100] Loss improvement: 0.026845

================================================================================
ITERATIVE OPTIMIZATION COMPLETE
================================================================================
Final parameters:
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648309 0.1       0.1       2.155786 ]
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=11.09764575958252, mm_cutoff=0.10000000149011612)
  Final loss: 1143.201050
================================================================================

Final optimized parameters:
  ep_scale: [0.1 0.1 0.1 0.1]
  sig_scale: [0.5648309 0.1       0.1       2.155786 ]
  Cutoff parameters: CutoffParameters(ml_cutoff=0.10000000149011612, mm_switch_on=11.09764575958252, mm_cutoff=0.10000000149011612)
  Loss history: [4836.9111328125, 4789.8369140625, 4743.6083984375, 4697.86962890625, 4652.0439453125, 4605.875, 4558.990234375, 4511.77978515625, 4464.42919921875, 4415.654296875, 4366.31591796875, 4314.896484375, 4263.0390625, 4212.70947265625, 4164.93115234375, 4119.5283203125, 4071.761474609375, 4028.333984375, 4001.452392578125, 3970.048583984375, 3936.90869140625, 3907.97607421875, 3877.923095703125, 3844.966796875, 3809.563232421875, 3775.9912109375, 3743.41943359375, 3709.622802734375, 3668.15869140625, 3631.447509765625, 3592.84814453125, 3558.97900390625, 3526.954345703125, 3497.69677734375, 3467.801025390625, 3433.84033203125, 3399.614990234375, 3356.8291015625, 3314.292236328125, 3281.6279296875, 3252.9794921875, 3225.69140625, 3179.03271484375, 3132.022216796875, 3097.186279296875, 3058.036865234375, 3017.815185546875, 2978.639892578125, 2939.202880859375, 2905.181396484375, 2865.497314453125, 2817.777587890625, 2774.193359375, 2736.729736328125, 2700.705078125, 2654.983154296875, 2620.966796875, 2583.885986328125, 2544.291015625, 2505.174560546875, 2460.7314453125, 2420.473388671875, 2376.253662109375, 2333.90283203125, 2291.755859375, 2249.264892578125, 2210.774169921875, 2173.2900390625, 2135.56884765625, 2097.12353515625, 2058.975830078125, 2025.4825439453125, 1987.4268798828125, 1950.42626953125, 1917.349365234375, 1883.97314453125, 1854.4893798828125, 1825.75048828125, 1791.493896484375, 1759.331298828125, 1726.28564453125, 1696.594970703125, 1663.1337890625, 1624.1715087890625, 1585.9322509765625, 1549.4510498046875, 1517.7476806640625, 1490.0570068359375, 1462.7548828125, 1436.6951904296875, 1410.0145263671875, 1383.2545166015625, 1350.057861328125, 1321.5120849609375, 1293.7640380859375, 1264.1444091796875, 1235.388671875, 1202.701904296875, 1174.7369384765625, 1143.2010498046875]

============================================================
Creating optimized calculator
============================================================
[setup_calculator] Cutoff inputs -> ml_cutoff_distance=0.1000, mm_switch_on=11.0976, mm_cutoff=0.1000
[setup_calculator] CutoffParameters stored -> ml_cutoff=0.1000, mm_switch_on=11.0976, mm_cutoff=0.1000
0 1
unique_res_ids [0, 1]
len(dimer_perms) 1
dict_keys(['opt_state', 'params', 'step'])
                                                         Model Attributes                                                          
┏━━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━┓
┃ charges ┃ cutoff ┃ debug ┃ efa   ┃ featur… ┃ max_at… ┃ max_de… ┃ n_res ┃ natoms ┃ num_ba… ┃ num_it… ┃ total_… ┃ use_en… ┃ zbl   ┃
┡━━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━┩
│ True    │ 8.0    │ False │ False │ 32      │ 40      │ 1       │ 4     │ 20     │ 32      │ 2       │ 0       │ True    │ False │
└─────────┴────────┴───────┴───────┴─────────┴─────────┴─────────┴───────┴────────┴─────────┴─────────┴─────────┴─────────┴───────┘
                                                          Last Checkpoint                                                          
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Checkpoint                                                       ┃ name        ┃ epoch ┃ best_loss ┃ Save Time                  ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ /pchem-data/meuwly/boittier/home/ckpts/test-84aa02d9-e329-46c4-… │ epoch-10074 │ 10074 │ 238.19751 │ 2025-12-03 17:11:40.755566 │
└──────────────────────────────────────────────────────────────────┴─────────────┴───────┴───────────┴────────────────────────────┘
Optimized calculator created

============================================================
Initializing simulations from batches
============================================================
Initializing simulation from batch
  Positions shape: (20, 3)
  Atomic numbers shape: (20,)
  Number of atoms: 20
  PyCHARMM is responsive
  Retrieved PyCHARMM atom types and residue IDs from PSF
  Attempting to reorder atoms to match PyCHARMM ordering...
    ATOMS_PER_MONOMER: 10, N_MONOMERS: 2
    PyCHARMM atom types shape: (20,)
  Reordering atoms to match PyCHARMM ordering...
  Original R shape: (20, 3), Z shape: (20,)
  Trying 6 different atom orderings...
  Set initial coordinates from batch data
  Using energy term 'IMPR' for reordering evaluation
  (Also available: BOND, DIHE)
    Ordering 1/6: IMPR=0.039709 BOND=6.717323 DIHE=0.927939 kcal/mol
    Ordering 2/6: IMPR=0.063852 BOND=3186.189432 DIHE=0.829066 kcal/mol
    Ordering 3/6: IMPR=0.040982 BOND=3161.011574 DIHE=1.324883 kcal/mol
    Ordering 4/6: IMPR=0.065124 BOND=6340.483684 DIHE=1.226010 kcal/mol
    Ordering 5/6: IMPR=14.582096 BOND=1104.804740 DIHE=0.889812 kcal/mol
    Ordering 6/6: IMPR=38.323893 BOND=959.215064 DIHE=0.816336 kcal/mol
  Best ordering found: Energy = 7.684971 kcal/mol (using IMPR)
  Reorder indices: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
  Final positions set in PyCHARMM
  ✓ Atoms reordered to match PyCHARMM ordering
  ✓ Atomic numbers match between batch and PyCHARMM
  Synced positions with PyCHARMM
Process Monomer Forces:
raw_forces: (40, 3)
processed_forces: (20, 3)
Monomer Contributions:
ml_monomer_energy: (2,)
monomer_forces: (20, 3)
Debug dimer forces: f.shape=(60, 3), monomer_atoms=40, max_atoms=20
ml_dimer_forces shape: (20, 3)
Dimer Contributions:
dimer_energies: (1,)
MM Contributions:
mm_E: ()
mm_grad: (20, 3)
Initial energy: -80.317886 eV
Initial forces shape: (20, 3)
Max force: 2.889668 eV/Å
Initialized simulation:
  Number of atoms: 20
  Calculator: <class 'mmml.pycharmmInterface.mmml_calculator.setup_calculator.<locals>.AseDimerCalculator'>
Initializing simulation from batch
  Positions shape: (20, 3)
  Atomic numbers shape: (20,)
  Number of atoms: 20
  PyCHARMM is responsive
  Retrieved PyCHARMM atom types and residue IDs from PSF
  Attempting to reorder atoms to match PyCHARMM ordering...
    ATOMS_PER_MONOMER: 10, N_MONOMERS: 2
    PyCHARMM atom types shape: (20,)
  Reordering atoms to match PyCHARMM ordering...
  Original R shape: (20, 3), Z shape: (20,)
  Trying 6 different atom orderings...
  Set initial coordinates from batch data
  Using energy term 'IMPR' for reordering evaluation
  (Also available: BOND, DIHE)
    Ordering 1/6: IMPR=0.039709 BOND=6.717323 DIHE=0.927939 kcal/mol
    Ordering 2/6: IMPR=0.063852 BOND=3186.189432 DIHE=0.829066 kcal/mol
    Ordering 3/6: IMPR=0.040982 BOND=3161.011574 DIHE=1.324883 kcal/mol
    Ordering 4/6: IMPR=0.065124 BOND=6340.483684 DIHE=1.226010 kcal/mol
    Ordering 5/6: IMPR=14.582096 BOND=1104.804740 DIHE=0.889812 kcal/mol
    Ordering 6/6: IMPR=38.323893 BOND=959.215064 DIHE=0.816336 kcal/mol
  Best ordering found: Energy = 7.684971 kcal/mol (using IMPR)
  Reorder indices: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
  Final positions set in PyCHARMM
  ✓ Atoms reordered to match PyCHARMM ordering
  ✓ Atomic numbers match between batch and PyCHARMM
  Synced positions with PyCHARMM
Initial energy: -80.317459 eV
Initial forces shape: (20, 3)
Max force: 2.889668 eV/Å
Successfully initialized simulation 1/5
Initializing simulation from batch
  Positions shape: (20, 3)
  Atomic numbers shape: (20,)
  Number of atoms: 20
  PyCHARMM is responsive
  Retrieved PyCHARMM atom types and residue IDs from PSF
  Attempting to reorder atoms to match PyCHARMM ordering...
    ATOMS_PER_MONOMER: 10, N_MONOMERS: 2
    PyCHARMM atom types shape: (20,)
  Reordering atoms to match PyCHARMM ordering...
  Original R shape: (20, 3), Z shape: (20,)
  Trying 6 different atom orderings...
  Set initial coordinates from batch data
  Using energy term 'IMPR' for reordering evaluation
  (Also available: BOND, DIHE)
    Ordering 1/6: IMPR=0.482718 BOND=4.755866 DIHE=1.790873 kcal/mol
    Ordering 2/6: IMPR=0.495008 BOND=3261.073735 DIHE=1.274103 kcal/mol
    Ordering 3/6: IMPR=0.486867 BOND=3144.071558 DIHE=1.370037 kcal/mol
    Ordering 4/6: IMPR=0.499158 BOND=6400.389428 DIHE=0.853268 kcal/mol
    Ordering 5/6: IMPR=171.896246 BOND=1119.198111 DIHE=1.632920 kcal/mol
    Ordering 6/6: IMPR=79.455033 BOND=1086.131032 DIHE=1.622502 kcal/mol
  Best ordering found: Energy = 7.029456 kcal/mol (using IMPR)
  Reorder indices: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
  Final positions set in PyCHARMM
  ✓ Atoms reordered to match PyCHARMM ordering
  ✓ Atomic numbers match between batch and PyCHARMM
  Synced positions with PyCHARMM
Initial energy: -79.780144 eV
Initial forces shape: (20, 3)
Max force: 4.786960 eV/Å
Successfully initialized simulation 2/5

Initialized 2 simulations from batches

============================================================
Running energy/force calculations
============================================================
Batch 0: Max force diff = 1.962607
Batch 1: Max force diff = 2.518545
Batch 2: Max force diff = 2.133368
Batch 3: Max force diff = 2.179959
Batch 4: Max force diff = 1.779384
Batch 6: Max force diff = 2.390145
Batch 7: Max force diff = 1.685233
Batch 8: Max force diff = 1.901603
Batch 9: Max force diff = 2.627836

Calculator results keys: ['model_output', 'energy', 'forces']

Example simulation:
  Energy: -80.317459 eV
  Forces shape: (20, 3)
  Max force magnitude: 2.889668 eV/Å

Running minimization...

============================================================
Simulation Setup Complete
============================================================
Number of simulations initialized: 2
Number of atoms per simulation: 20
Number of monomers: 2
Atoms per monomer: 10
ML cutoff: 0.10000000149011612 Å
MM switch on: 11.09764575958252 Å
MM cutoff: 0.10000000149011612 Å
Valid data batches available: 10500
============================================================

To run MD simulations, use the helper functions or refer to run_sim.py
Note: Residue numbers may need adjustment based on your system

  
 CHARMM>     
  
  
 CHARMM>     PRNLev 0

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
      $$$$$$  New timer profile Local node$$$$$
   List time                       0.00 Other:            0.00
      Nonbond force                   0.00 Other:            0.00
         Bond energy                     0.00 Other:            0.00
         Angle energy                    0.00 Other:            0.00
         Dihedral energy                 0.00 Other:            0.00
         Restraints energy               0.00 Other:            0.00
      INTRNL energy                   0.00 Other:            0.00
      Comm energy                     0.00 Other:            0.00
      Comm force                      0.00 Other:            0.00
   Energy time                     0.00 Other:            0.00
 Total time                  11062.24 Other:        11062.24
         $$$$$$  Average   profile $$$$$
   List time                       0.00 Other:            0.00
      Nonbond force                   0.00 Other:            0.00
         Bond energy                     0.00 Other:            0.00
         Angle energy                    0.00 Other:            0.00
         Dihedral energy                 0.00 Other:            0.00
         Restraints energy               0.00 Other:            0.00
      INTRNL energy                   0.00 Other:            0.00
      Comm energy                     0.00 Other:            0.00
      Comm force                      0.00 Other:            0.00
   Energy time                     0.00 Other:            0.00
 Total time                  11062.24 Other:        11062.24
